<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model APIs &mdash; coremltools API Reference 8.0b1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/norightmargin.css?v=eea1f72d" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d50bc636"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="coremltools.models.ml_program.html" />
    <link rel="prev" title="XGBoost" href="coremltools.converters.xgboost.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            coremltools API Reference
          </a>
              <div class="version">
                8.0b1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.html">Converters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.model">MLModel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.model.MLModel"><code class="docutils literal notranslate"><span class="pre">MLModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.__init__"><code class="docutils literal notranslate"><span class="pre">MLModel.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.get_compiled_model_path"><code class="docutils literal notranslate"><span class="pre">MLModel.get_compiled_model_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.get_spec"><code class="docutils literal notranslate"><span class="pre">MLModel.get_spec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.make_state"><code class="docutils literal notranslate"><span class="pre">MLModel.make_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.predict"><code class="docutils literal notranslate"><span class="pre">MLModel.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.save"><code class="docutils literal notranslate"><span class="pre">MLModel.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compiled-mlmodel">Compiled MLModel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.CompiledMLModel"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.__init__"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.make_state"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.make_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compression-utils">compression_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html"><code class="docutils literal notranslate"><span class="pre">affine_quantize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.palettize_weights"><code class="docutils literal notranslate"><span class="pre">palettize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.sparsify_weights"><code class="docutils literal notranslate"><span class="pre">sparsify_weights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.array_feature_extractor">array_feature_extractor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.array_feature_extractor.create_array_feature_extractor"><code class="docutils literal notranslate"><span class="pre">create_array_feature_extractor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.converters.mil.debugging_utils">extract_submodel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.converters.mil.debugging_utils.extract_submodel"><code class="docutils literal notranslate"><span class="pre">extract_submodel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.feature_vectorizer">feature_vectorizer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.feature_vectorizer.create_feature_vectorizer"><code class="docutils literal notranslate"><span class="pre">create_feature_vectorizer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.nearest_neighbors.builder">nearest_neighbors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.add_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.index_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.is_updatable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.leaf_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_dimensions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.set_index_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.weighting_scheme</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#neural-network">neural_network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html">neural_network.builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.pipeline">pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline"><code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.__init__"><code class="docutils literal notranslate"><span class="pre">Pipeline.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.add_model"><code class="docutils literal notranslate"><span class="pre">Pipeline.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.set_training_input"><code class="docutils literal notranslate"><span class="pre">Pipeline.set_training_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.add_model"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.set_training_input"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.set_training_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.__init__"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.add_model"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.set_training_input"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.set_training_input()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.tree_ensemble">tree_ensemble</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.add_branch_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.add_leaf_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.set_default_prediction_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.set_post_evaluation_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleClassifier.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleRegressor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleRegressor.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.__init__"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.add_function"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.add_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.add_model"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.remove_function"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.remove_function()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.bisect_model"><code class="docutils literal notranslate"><span class="pre">bisect_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.compile_model"><code class="docutils literal notranslate"><span class="pre">compile_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.convert_double_to_float_multiarray_type"><code class="docutils literal notranslate"><span class="pre">convert_double_to_float_multiarray_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier"><code class="docutils literal notranslate"><span class="pre">evaluate_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier_with_probabilities"><code class="docutils literal notranslate"><span class="pre">evaluate_classifier_with_probabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor"><code class="docutils literal notranslate"><span class="pre">evaluate_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_transformer"><code class="docutils literal notranslate"><span class="pre">evaluate_transformer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.load_spec"><code class="docutils literal notranslate"><span class="pre">load_spec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.make_pipeline"><code class="docutils literal notranslate"><span class="pre">make_pipeline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.materialize_dynamic_shape_mlmodel"><code class="docutils literal notranslate"><span class="pre">materialize_dynamic_shape_mlmodel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.randomize_weights"><code class="docutils literal notranslate"><span class="pre">randomize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.rename_feature"><code class="docutils literal notranslate"><span class="pre">rename_feature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.save_multifunction"><code class="docutils literal notranslate"><span class="pre">save_multifunction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.save_spec"><code class="docutils literal notranslate"><span class="pre">save_spec()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.html">MIL Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.input_types.html">MIL Input Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.ops.defs.html">MIL Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.passes.defs.html">MIL Graph Passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.optimize.html">Optimizers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/docs-guides/index.html">Guide and Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/mlmodel/index.html">Core ML Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-versions.html">Previous Versions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apple/coremltools">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coremltools API Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model APIs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/coremltools.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-apis">
<h1>Model APIs<a class="headerlink" href="#model-apis" title="Link to this heading"></a></h1>
<section id="module-coremltools.models.model">
<span id="mlmodel"></span><h2>MLModel<a class="headerlink" href="#module-coremltools.models.model" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.model.</span></span><span class="sig-name descname"><span class="pre">MLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_temp_package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mil_program</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_model_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel" title="Link to this definition"></a></dt>
<dd><p>This class defines the minimal interface to a Core ML object in Python.</p>
<p>At a high level, the protobuf specification consists of:</p>
<ul class="simple">
<li><p>Model description: Encodes names and type information of the inputs and outputs to the model.</p></li>
<li><p>Model parameters: The set of parameters required to represent a specific instance of the model.</p></li>
<li><p>Metadata: Information about the origin, license, and author of the model.</p></li>
</ul>
<p>With this class, you can inspect a Core ML model, modify metadata, and make
predictions for the purposes of testing (on select platforms).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.model.MLModel.predict" title="coremltools.models.model.MLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>

<span class="c1"># Set the model metadata</span>
<span class="n">model</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Author&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="s2">&quot;BSD&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s2">&quot;Predicts the price of a house in the Seattle area.&quot;</span>

<span class="c1"># Get the interface to the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span>
<span class="n">model</span><span class="o">.</span><span class="n">output_description</span>

<span class="c1"># Set feature descriptions manually</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;bedroom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Number of bedrooms&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;bathrooms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Number of bathrooms&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Size (in square feet)&quot;</span>

<span class="c1"># Set</span>
<span class="n">model</span><span class="o">.</span><span class="n">output_description</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Price of the house&quot;</span>

<span class="c1"># Make predictions</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">})</span>

<span class="c1"># Get the spec of the model</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>

<span class="c1"># Save the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>

<span class="c1"># Load the model from the spec object</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="c1"># modify spec (e.g. rename inputs/outputs etc)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="c1"># if model type is mlprogram, i.e. spec.WhichOneof(&#39;Type&#39;) == &quot;mlProgram&quot;, then:</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">weights_dir</span><span class="p">)</span>

<span class="c1"># Load a non-default function from a multifunction .mlpackage</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;MultifunctionModel.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;deep_features&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_temp_package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mil_program</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_model_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Construct an MLModel from an <code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>model: str or Model_pb2</strong></dt><dd><p>For an ML program (<code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>), the model can be a path string (<code class="docutils literal notranslate"><span class="pre">.mlpackage</span></code>) or <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>.
If it is a path string, it must point to a directory containing bundle
artifacts (such as <code class="docutils literal notranslate"><span class="pre">weights.bin</span></code>).
If it is of type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code> (spec), then you must also provide <code class="docutils literal notranslate"><span class="pre">weights_dir</span></code> if the model
has weights, because both the proto spec and the weights are
required to initialize and load the model.
The proto spec for an <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>, unlike a neural network (<code class="docutils literal notranslate"><span class="pre">neuralnetwork</span></code>),
does not contain the weights; they are stored separately.
If the model does not have weights, you can provide an empty <code class="docutils literal notranslate"><span class="pre">weights_dir</span></code>.</p>
<p>For non- <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code> model types, the model can be a path string (<code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>)
or type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>, such as a spec object.</p>
</dd>
<dt><strong>is_temp_package: bool</strong></dt><dd><p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the input model package dir is temporary and can be deleted upon interpreter termination.</p>
</dd>
<dt><strong>mil_program: coremltools.converters.mil.Program</strong></dt><dd><p>Set to the MIL program object, if available.
It is available whenever an MLModel object is constructed using
the unified converter API <a class="reference external" href="https://apple.github.io/coremltools/source/coremltools.converters.convert.html">coremltools.convert()</a>.</p>
</dd>
<dt><strong>skip_model_load: bool</strong></dt><dd><p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to prevent Core ML Tools from calling into the Core ML framework
to compile and load the model. In that case, the returned model object cannot
be used to make a prediction. This flag may be used to load a newer model
type on an older Mac, to inspect or load/save the spec.</p>
<p>Example: Loading an ML program model type on a macOS 11, since an ML program can be
compiled and loaded only from macOS12+.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>compute_units: coremltools.ComputeUnit</strong></dt><dd><p>The set of processing units the model can use to make predictions.</p>
<dl class="simple">
<dt>An enum with four possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU,
but not the neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>weights_dir: str</strong></dt><dd><p>Path to the weight directory, required when loading an MLModel of type <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>,
from a spec object, such as when the argument <code class="docutils literal notranslate"><span class="pre">model</span></code> is of type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">str</span></dt><dd><p>The name of the function from <code class="docutils literal notranslate"><span class="pre">model</span></code> to load.
If not provided, <code class="docutils literal notranslate"><span class="pre">function_name</span></code> will be set to the <code class="docutils literal notranslate"><span class="pre">defaultFunctionName</span></code> in the proto.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Internally this maintains the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_MLModelProxy</span></code>: A pybind wrapper around
CoreML::Python::Model (see
<a class="reference external" href="https://github.com/apple/coremltools/blob/main/coremlpython/CoreMLPython.mm">coremltools/coremlpython/CoreMLPython.mm</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">package_path</span></code> (mlprogram only): Directory containing all artifacts (<code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>,
weights, and so on).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights_dir</span></code> (mlprogram only): Directory containing weights inside the package_path.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlmodel&quot;</span><span class="p">)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.get_compiled_model_path">
<span class="sig-name descname"><span class="pre">get_compiled_model_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.get_compiled_model_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.get_compiled_model_path" title="Link to this definition"></a></dt>
<dd><p>Returns the path for the underlying compiled ML Model.</p>
<p><strong>Important</strong>: This path is available only for the lifetime of this Python object. If you want
the compiled model to persist, you need to make a copy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.get_spec">
<span class="sig-name descname"><span class="pre">get_spec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.get_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.get_spec" title="Link to this definition"></a></dt>
<dd><p>Get a deep copy of the protobuf specification of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>model: Model_pb2</dt><dd><p>Protobuf specification of the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.make_state">
<span class="sig-name descname"><span class="pre">make_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MLState</span></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.make_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.make_state" title="Link to this definition"></a></dt>
<dd><p>Returns a new state object, which can be passed to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>state</strong> (<em>MLState</em>) – Holds state for an MLModel.</p></li>
<li><p><em>State functionality is only supported on macOS 15+.</em></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.model.MLModel.predict" title="coremltools.models.model.MLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_state</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.predict" title="Link to this definition"></a></dt>
<dd><p>Return predictions for the model.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>data: dict[str, value] or list[dict[str, value]]</strong></dt><dd><p>Dictionary of data to use for predictions, where the keys are the names of the input features.
For batch predictons, use a list of such dictionaries.</p>
<p>The following dictionary values types are acceptable: list, array, numpy.ndarray, tensorflow.Tensor
and torch.Tensor.</p>
</dd>
<dt><strong>state</strong><span class="classifier">MLState</span></dt><dd><p>Optional state object as returned by <code class="docutils literal notranslate"><span class="pre">make_state()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict[str, value]</dt><dd><p>Predictions as a dictionary where each key is the output feature name.</p>
</dd>
<dt>list[dict[str, value]]</dt><dd><p>For batch prediction, returns a list of the above dictionaries.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">}</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2400</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.save" title="Link to this definition"></a></dt>
<dd><p>Save the model to an <code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code> format. For an MIL program, the <code class="docutils literal notranslate"><span class="pre">save_path</span></code> is
a package directory containing the <code class="docutils literal notranslate"><span class="pre">mlmodel</span></code> and weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>save_path: Target file path / bundle directory for the model.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_model_file.mlmodel&quot;</span><span class="p">)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model_file.mlmodel&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="compiled-mlmodel">
<h2>Compiled MLModel<a class="headerlink" href="#compiled-mlmodel" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.</span></span><span class="sig-name descname"><span class="pre">CompiledMLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Loads a compiled Core ML model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to a compiled model directory, ending in <code class="docutils literal notranslate"><span class="pre">.mlmodelc</span></code>.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit</span></dt><dd><dl class="simple">
<dt>An enum with the following possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU, but not the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict" title="coremltools.models.CompiledMLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_compiled_model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">CompiledMLModel</span><span class="p">(</span><span class="s2">&quot;my_model_path.mlmodelc&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">my_compiled_model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.make_state">
<span class="sig-name descname"><span class="pre">make_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MLState</span></span></span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.make_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.make_state" title="Link to this definition"></a></dt>
<dd><p>Returns a new state object, which can be passed to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict" title="coremltools.models.CompiledMLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_state</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.predict" title="Link to this definition"></a></dt>
<dd><p>Return predictions for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict[str, value] or list[dict[str, value]]</strong></dt><dd><p>Dictionary of data to use for predictions, where the keys are the names of the input features.
For batch predictons, use a list of such dictionaries.</p>
</dd>
<dt><strong>state</strong><span class="classifier">MLState</span></dt><dd><p>Optional state object as returned by <code class="docutils literal notranslate"><span class="pre">make_state()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict[str, value]</dt><dd><p>Predictions as a dictionary where each key is the output feature name.</p>
</dd>
<dt>list[dict[str, value]]</dt><dd><p>For batch prediction, returns a list of the above dictionaries.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">}</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2400</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="compression-utils">
<h2>compression_utils<a class="headerlink" href="#compression-utils" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html"><code class="docutils literal notranslate"><span class="pre">affine_quantize_weights()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.palettize_weights"><code class="docutils literal notranslate"><span class="pre">palettize_weights()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.sparsify_weights"><code class="docutils literal notranslate"><span class="pre">sparsify_weights()</span></code></a></li>
</ul>
</div>
</section>
<section id="module-coremltools.models.array_feature_extractor">
<span id="array-feature-extractor"></span><h2>array_feature_extractor<a class="headerlink" href="#module-coremltools.models.array_feature_extractor" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.array_feature_extractor.create_array_feature_extractor">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.array_feature_extractor.</span></span><span class="sig-name descname"><span class="pre">create_array_feature_extractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/array_feature_extractor.html#create_array_feature_extractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.array_feature_extractor.create_array_feature_extractor" title="Link to this definition"></a></dt>
<dd><p>Creates a feature extractor from an input array <code class="docutils literal notranslate"><span class="pre">(feature,</span> <span class="pre">return)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features:</strong></dt><dd><p>A list of one <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">array)</span></code> tuple.</p>
</dd>
<dt><strong>extract_indices:</strong></dt><dd><p>Either an integer or a list.
If it’s an integer, the output type is by default a double (but may also be an integer).
If a list, the output type is an array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.converters.mil.debugging_utils">
<span id="extract-submodel"></span><h2>extract_submodel<a class="headerlink" href="#module-coremltools.converters.mil.debugging_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.converters.mil.debugging_utils.extract_submodel">
<span class="sig-prename descclassname"><span class="pre">coremltools.converters.mil.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">extract_submodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/converters/mil/debugging_utils.html#extract_submodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.converters.mil.debugging_utils.extract_submodel" title="Link to this definition"></a></dt>
<dd><p>This utility function lets you extract a submodel from a Core ML model.</p>
<p>For a neural network model, the function extracts only in-memory Core ML models.
You should always call this function for a model directly from <a class="reference internal" href="coremltools.converters.convert.html#coremltools.converters._converters_entry.convert" title="coremltools.converters._converters_entry.convert"><code class="xref py py-class docutils literal notranslate"><span class="pre">convert</span></code></a>. It is not
allowed to load the model from disk and then call this API.</p>
<p>For an ML program model, both cases (in-memory and from disk) are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: MLModel</strong></dt><dd><p>The Core ML model from which the submodel is extracted.</p>
</dd>
<dt><strong>outputs: list[str]</strong></dt><dd><p>A list of names of Vars, which are the outputs of the extracted submodel.</p>
</dd>
<dt><strong>inputs: list[str] (Optional)</strong></dt><dd><p>A list of names of Vars, which are the inputs of the extracted submodel.
If not provided, the inputs from the original model are used.</p>
</dd>
<dt><strong>function_name: str (Optional)</strong></dt><dd><p>Name of the function where the subgraph is extracted. Default is <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Neural network:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.converters.mil.debugging_utils</span> <span class="kn">import</span> <span class="n">extract_submodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;neuralnetwork&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;output_0&quot;</span><span class="p">,</span> <span class="s2">&quot;output_1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p>ML program:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.converters.mil.debugging_utils</span> <span class="kn">import</span> <span class="n">extract_submodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;mlprogram&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;output_0&quot;</span><span class="p">,</span> <span class="s2">&quot;output_1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Directly extract model in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract model loaded from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coremltools.models.feature_vectorizer">
<span id="feature-vectorizer"></span><h2>feature_vectorizer<a class="headerlink" href="#module-coremltools.models.feature_vectorizer" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.feature_vectorizer.create_feature_vectorizer">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.feature_vectorizer.</span></span><span class="sig-name descname"><span class="pre">create_feature_vectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_size_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/feature_vectorizer.html#create_feature_vectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.feature_vectorizer.create_feature_vectorizer" title="Link to this definition"></a></dt>
<dd><p>Create a feature vectorizer from input features. This returns a 2-tuple
<code class="docutils literal notranslate"><span class="pre">(spec,</span> <span class="pre">num_dimension)</span></code> for a feature vectorizer that puts everything into a
single array with a length equal to the total size of all the input features.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The datatypes entry is one of the data types defined in the
<code class="docutils literal notranslate"><span class="pre">datatypes</span></code> module.  Allowed <code class="docutils literal notranslate"><span class="pre">datatypes</span></code> are <code class="docutils literal notranslate"><span class="pre">datatype.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatype.Double</span></code>, <code class="docutils literal notranslate"><span class="pre">datatypes.Dictionary</span></code>, and <code class="docutils literal notranslate"><span class="pre">datatype.Array</span></code>.</p>
<p>If the feature is a dictionary type, then the dictionary must have integer
keys, and the number of dimensions to expand it into must be provided by
<code class="docutils literal notranslate"><span class="pre">known_size_map</span></code>.</p>
<p>Feature indices in the final array are counted sequentially from the
from 0 through the total number of features.</p>
</dd>
<dt><strong>output_feature_name: str</strong></dt><dd><p>The name of the output feature.  The type is an Array
List of the output features of the network.</p>
</dd>
<dt><strong>known_size_map:</strong></dt><dd><p>A dictionary mapping the feature name to the expanded size in the final
array.  This is most useful for specifying the size of sparse vectors
given as dictionaries of index to value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.models.nearest_neighbors.builder">
<span id="nearest-neighbors"></span><h2>nearest_neighbors<a class="headerlink" href="#module-coremltools.models.nearest_neighbors.builder" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.nearest_neighbors.builder.</span></span><span class="sig-name descname"><span class="pre">KNearestNeighborsClassifierBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder" title="Link to this definition"></a></dt>
<dd><p>Construct a CoreML KNearestNeighborsClassifier specification.</p>
<p>Please see the Core ML Nearest Neighbors protobuf message for more information
on KNearestNeighborsClassifier parameters.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.nearest_neighbors</span> <span class="kn">import</span> <span class="n">KNearestNeighborsClassifierBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a KNearestNeighborsClassifier model that takes 4-dimensional input data and outputs a string label.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">KNearestNeighborsClassifierBuilder</span><span class="p">(</span><span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">number_of_dimensions</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">default_class_label</span><span class="o">=</span><span class="s1">&#39;default_label&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;knnclassifier.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a KNearestNeighborsClassifierBuilder object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_name</strong></dt><dd><p>Name of the model input.</p>
</dd>
<dt><strong>output_name</strong></dt><dd><p>Name of the output.</p>
</dd>
<dt><strong>number_of_dimensions</strong></dt><dd><p>Number of dimensions of the input data.</p>
</dd>
<dt><strong>default_class_label</strong></dt><dd><p>The default class label to use for predictions. Must be either an
int64 or a string.</p>
</dd>
<dt><strong>number_of_neighbors</strong></dt><dd><p>Number of neighbors to use for predictions. Default = 5 with allowed values
between 1-1000.</p>
</dd>
<dt><strong>weighting_scheme</strong></dt><dd><p>Weight function used in prediction. One of <code class="docutils literal notranslate"><span class="pre">'uniform'</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">'inverse_distance'</span></code>.</p>
</dd>
<dt><strong>index_type</strong></dt><dd><p>Algorithm to compute nearest neighbors. One of <code class="docutils literal notranslate"><span class="pre">'linear'</span></code> (default), or
<code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code>.</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>Leaf size for the kd-tree. Ignored if index type is <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>. Default = 30.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples">
<span class="sig-name descname"><span class="pre">add_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.add_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples" title="Link to this definition"></a></dt>
<dd><p>Add some samples to the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_points</strong></dt><dd><p>List of input data points.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>List of corresponding labels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">author</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author" title="Link to this definition"></a></dt>
<dd><p>Get the author for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The author</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description" title="Link to this definition"></a></dt>
<dd><p>Get the description for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The description.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_type</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type" title="Link to this definition"></a></dt>
<dd><p>Get the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The index type.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_updatable</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable" title="Link to this definition"></a></dt>
<dd><p>Check if the KNearestNeighborsClassifier is updatable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Is updatable.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">leaf_size</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size" title="Link to this definition"></a></dt>
<dd><p>Get the leaf size for the KNearestNeighborsClassifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The leaf size.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">license</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license" title="Link to this definition"></a></dt>
<dd><p>Get the author for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The author</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_dimensions</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions" title="Link to this definition"></a></dt>
<dd><p>Get the number of dimensions of the input data for the
KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Number of dimensions.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_neighbors</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors" title="Link to this definition"></a></dt>
<dd><p>Get the number of neighbors value for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The number of neighbors default value.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range">
<span class="sig-name descname"><span class="pre">number_of_neighbors_allowed_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range" title="Link to this definition"></a></dt>
<dd><p>Get the range of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the range hasn’t been set.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set">
<span class="sig-name descname"><span class="pre">number_of_neighbors_allowed_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set" title="Link to this definition"></a></dt>
<dd><p>Get the set of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Set of allowed values or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the set of allowed values hasn’t been</dt><dd></dd>
<dt>populated.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type">
<span class="sig-name descname"><span class="pre">set_index_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.set_index_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type" title="Link to this definition"></a></dt>
<dd><p>Set the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index_type</strong></dt><dd><p>One of [ <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>, <code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code> ].</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>For kd_tree indexes, the leaf size to use (default = 30).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds">
<span class="sig-name descname"><span class="pre">set_number_of_neighbors_with_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds" title="Link to this definition"></a></dt>
<dd><p>Set the numberOfNeighbors parameter for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>allowed_range</strong></dt><dd><p>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) defining the range of allowed values.</p>
</dd>
<dt><strong>allowed_values</strong></dt><dd><p>Set of allowed values for the number of neighbors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weighting_scheme</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme" title="Link to this definition"></a></dt>
<dd><p>Get the weighting scheme for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The weighting scheme.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="neural-network">
<h2>neural_network<a class="headerlink" href="#neural-network" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html">neural_network.builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a></li>
</ul>
</div>
</section>
<section id="module-coremltools.models.pipeline">
<span id="pipeline"></span><h2>pipeline<a class="headerlink" href="#module-coremltools.models.pipeline" title="Link to this heading"></a></h2>
<p>Pipeline utils for this package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.</p>
<p>This class is the base class for <a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier" title="coremltools.models.pipeline.PipelineClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineClassifier</span></code></a> and
<a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor" title="coremltools.models.pipeline.PipelineRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineRegressor</span></code></a>, which contain a sequence ending in a classifier
or regressor and themselves behave like a classifier or regressor.  This class
may be used directly for a sequence of feature transformer objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a pipeline of models to be executed sequentially.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">PipelineClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a classification model by designating
a discrete categorical output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The last
model in this list must be a classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
This list must match the class labels in the model outputting the categorical
predictedFeatureName</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <cite>output_features</cite>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <cite>“classProbability.”</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">PipelineRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a regression model by designating
a real valued output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The final
output model must be a regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.tree_ensemble">
<span id="tree-ensemble"></span><h2>tree_ensemble<a class="headerlink" href="#module-coremltools.models.tree_ensemble" title="Link to this heading"></a></h2>
<p>Tree ensemble builder class to construct CoreML models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleBase</span></span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase" title="Link to this definition"></a></dt>
<dd><p>Base class for the tree ensemble builder class.  This should be instantiated
either through the <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="coremltools.models.tree_ensemble.TreeEnsembleRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleRegressor</span></code></a> or
<a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="coremltools.models.tree_ensemble.TreeEnsembleClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleClassifier</span></code></a> classes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.__init__" title="Link to this definition"></a></dt>
<dd><p>High level Python API to build a tree ensemble model for Core ML.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node">
<span class="sig-name descname"><span class="pre">add_branch_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value_tracks_true_child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.add_branch_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node" title="Link to this definition"></a></dt>
<dd><p>Add a branch node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>feature_index: int</strong></dt><dd><p>Index of the feature in the input being split on.</p>
</dd>
<dt><strong>feature_value: double or int</strong></dt><dd><p>The value used in the feature comparison determining the traversal
direction from this node.</p>
</dd>
<dt><strong>branch_mode: str</strong></dt><dd><p>Branch mode of the node, specifying the condition under which the node
referenced by <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code> is called next.</p>
<p>Must be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">==</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueNotEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">!=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>true_child_id: int</strong></dt><dd><p>ID of the child under the true condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>false_child_id: int</strong></dt><dd><p>ID of the child under the false condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>relative_hit_rate: float [optional]</strong></dt><dd><p>When the model is converted compiled by CoreML, this gives hints to
Core ML about which node is more likely to be hit on evaluation,
allowing for additional optimizations. The values can be on any scale,
with the values between child nodes being compared relative to each
other.</p>
</dd>
<dt><strong>missing_value_tracks_true_child: bool [optional]</strong></dt><dd><p>If the training data contains NaN values or missing values, then this
flag determines which direction a NaN value traverses.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node">
<span class="sig-name descname"><span class="pre">add_leaf_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.add_leaf_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node" title="Link to this definition"></a></dt>
<dd><p>Add a leaf node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>values: [float | int | list | dict]</strong></dt><dd><p>Value(s) at the leaf node to add to the prediction when this node is
activated.  If the prediction dimension of the tree is 1, then the
value is specified as a float or integer value.</p>
<p>For multidimensional predictions, the values can be a list of numbers
with length matching the dimension of the predictions or a dictionary
mapping index to value added to that dimension.</p>
<p>Note that the dimension of any tree must match the dimension given
when <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_prediction_value()</span></code></a> is called.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value">
<span class="sig-name descname"><span class="pre">set_default_prediction_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.set_default_prediction_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="Link to this definition"></a></dt>
<dd><p>Set the default prediction value(s).</p>
<p>The values given here form the base prediction value that the values
at activated leaves are added to.  If values is a scalar, then
the output of the tree must also be 1 dimensional; otherwise, values
must be a list with length matching the dimension of values in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>values: [int | double | list[double]]</strong></dt><dd><p>Default values for predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform">
<span class="sig-name descname"><span class="pre">set_post_evaluation_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.set_post_evaluation_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform" title="Link to this definition"></a></dt>
<dd><p>Set the post processing transform applied after the prediction value
from the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>value: str</strong></dt><dd><p>A value denoting the transform applied.  Possible values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;NoTransform&quot;</span></code> (default).  Do not apply a transform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Classification_SoftMax&quot;</span></code>.</p>
<p>Apply a softmax function to the outcome to produce normalized,
non-negative scores that sum to 1.  The transformation applied to
dimension <cite>i</cite> is equivalent to:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{e^{x_i}}{\sum_j e^{x_j}}\]</div>
</div></blockquote>
<p>Note: This is the output transformation applied by the XGBoost package
with multiclass classification.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Regression_Logistic&quot;</span></code>.</p>
<p>Applies a logistic transform the predicted value, specifically:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[(1 + e^{-v})^{-1}\]</div>
</div></blockquote>
<p>This is the transformation used in binary classification.</p>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="Link to this definition"></a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble classification model.</p>
<p>The TreeEnsembleClassifier class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<p>In the following example, the code saves the model to disk, which is a
recommended practice but not required.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleClassifier</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">                                output_features = &quot;predicted_class&quot;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Put in a softmax transform to translate these into probabilities.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_post_evaluation_transform</span><span class="p">(</span><span class="s2">&quot;Classification_SoftMax&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleClassifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a tree ensemble classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
The length of this must match the dimension of the tree model.</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <code class="docutils literal notranslate"><span class="pre">output_features</span></code>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <code class="docutils literal notranslate"><span class="pre">&quot;classProbability&quot;</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="Link to this definition"></a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble regression model.</p>
<p>The TreeEnsembleRegressor class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<p>In the following example, the code saves the model to disk, which is a
recommended practice but not required.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Required inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">datatypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.tree_ensemble</span> <span class="kn">import</span> <span class="n">TreeEnsembleRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define input features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">()))]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define output_features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;predicted_values&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleRegressor</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">output_features</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0, which is index 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleRegressor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a Tree Ensemble regression model that takes one or more input
features and maps them to an output feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>target:  (default = None)</strong></dt><dd><p>Name of the target feature predicted.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-coremltools.models.utils" title="Link to this heading"></a></h2>
<p>Utilities for the entire package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">MultiFunctionDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor" title="Link to this definition"></a></dt>
<dd><p>This data class defines how to construct a multifunction model from different model sources.
Use the <code class="docutils literal notranslate"><span class="pre">add_function</span></code> method to specify the path to the source <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>,
along with the source and target function names.</p>
<p>After setting the <code class="docutils literal notranslate"><span class="pre">default_function_name</span></code> to the <code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code> instance,
you can export a multifunction model using the <code class="docutils literal notranslate"><span class="pre">save_multifunction</span></code> method.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.save_multifunction" title="coremltools.models.utils.save_multifunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_multifunction</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">MultiFunctionDescriptor</span><span class="p">,</span> <span class="n">save_multifunction</span>

<span class="c1"># Initialize a MultiFunctionDescriptor instance with functions in an existing mlpackage.</span>
<span class="c1"># desc will contain all functions in &quot;my_model.mlpackage&quot;</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>

<span class="c1"># Construct a MultiFunctionDescriptor instance from scratch.</span>
<span class="c1"># The below code inserts the &quot;main&quot; function from &quot;my_model.mlpackage&quot; as &quot;main_1&quot;,</span>
<span class="c1"># and inserts the &quot;main&quot; function from &quot;my_model_2.mlpackage&quot; as &quot;main_2&quot;.</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">()</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">,</span>
    <span class="n">source_function_name</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">target_function_name</span><span class="o">=</span><span class="s2">&quot;main_1&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;my_model_2.mlpackage&quot;</span><span class="p">,</span>
    <span class="n">source_function_name</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">target_function_name</span><span class="o">=</span><span class="s2">&quot;main_2&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Each MultiFunctionDescriptor instance must have a default function name</span>
<span class="c1"># so it can be saved as a multifunction mlpackage on disk.</span>
<span class="n">desc</span><span class="o">.</span><span class="n">default_function_name</span> <span class="o">=</span> <span class="s2">&quot;main_1&quot;</span>
<span class="n">save_multifunction</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="s2">&quot;my_multifunction_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.__init__" title="Link to this definition"></a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">model_path</span></code> is passed to the constructor, it must be a str pointing to an
existing <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code> on disk. The MultiFunctionDescriptor instance will be initiated
with the functions in <code class="docutils literal notranslate"><span class="pre">model_path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.add_function">
<span class="sig-name descname"><span class="pre">add_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.add_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.add_function" title="Link to this definition"></a></dt>
<dd><p>Insert a <code class="docutils literal notranslate"><span class="pre">src_function_name</span></code> function from <code class="docutils literal notranslate"><span class="pre">model_path</span></code> as the
<code class="docutils literal notranslate"><span class="pre">target_function_name</span></code> function in the multifunction descriptor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.add_model" title="Link to this definition"></a></dt>
<dd><p>Insert all functions from the model in <code class="docutils literal notranslate"><span class="pre">model_path</span></code> into the multifunction descriptor.
The function names will remain the same as in the original model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.remove_function">
<span class="sig-name descname"><span class="pre">remove_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.remove_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.remove_function" title="Link to this definition"></a></dt>
<dd><p>Remove a function <code class="docutils literal notranslate"><span class="pre">function_name</span></code> from the multifunction descriptor.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.bisect_model">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">bisect_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_chunks_to_pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_output_correctness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#bisect_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.bisect_model" title="Link to this definition"></a></dt>
<dd><p>Utility function to split a mlpackage model into two mlpackages of approximately same file size.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>model: str or MLModel</strong></dt><dd><p>Path to the mlpackage file, or a Core ML model, to be split into two mlpackages of approximately same file size.</p>
</dd>
<dt><strong>output_dir: str</strong></dt><dd><p>Path to output directory where the two model chunks / pipeline model would be saved.</p>
<p>If the <cite>model</cite> is <cite>{path}/{model_name}.mlpackage</cite>, the chunk models are going to be saved as:
1. first chunk model: <cite>{output_dir}/{model_name}_chunk1.mlpackage</cite>
2. second chunk model: <cite>{output_dir}/{model_name}_chunk2.mlpackage</cite>
3. chunked pipeline model: <cite>{output_dir}/{model_name}_chunked_pipeline.mlpackage</cite></p>
<p>If the <cite>model</cite> is type of <cite>MLModel</cite>, the chunk models are saved as:
1. first chunk model: <cite>{output_dir}/chunk1.mlpackage</cite>
2. second chunk model: <cite>{output_dir}/chunk2.mlpackage</cite>
3. chunked pipeline model: <cite>{output_dir}/chunked_pipeline.mlpackage</cite></p>
</dd>
<dt><strong>merge_chunks_to_pipeline: bool</strong></dt><dd><p>If True, model chunks are managed inside a single pipeline model for easier asset maintenance.</p>
</dd>
<dt><strong>check_output_correctness: bool</strong></dt><dd><ul class="simple">
<li><p>If True, compares the outputs of original Core ML model with that of pipelined CoreML model chunks and reports PSNR in dB.</p></li>
<li><p>Enabling this feature uses more memory. Disable it if your machine runs out of memory.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">coremltools</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="s2">&quot;my_model.mlpackage&quot;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;./output/&quot;</span>

<span class="c1"># The following code will produce two smaller models:</span>
<span class="c1"># `./output/my_model_chunk1.mlpackage` and `./output/my_model_chunk2.mlpackage`</span>
<span class="c1"># It also compares the output numerical of the original Core ML model with the chunked models.</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The following code will produce a single pipeline model `./output/my_model_chunked_pipeline.mlpackage`</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">merge_chunks_to_pipeline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># You can also pass the MLModel object directly</span>
<span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">mlmodel</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">merge_chunks_to_pipeline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.compile_model">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">compile_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#compile_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.compile_model" title="Link to this definition"></a></dt>
<dd><p>Compiles a Core ML model spec.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>model: Model_pb2</strong></dt><dd><p>Spec/protobuf to compile.</p>
<p>Note: an <code class="docutils literal notranslate"><span class="pre">mlprogam</span></code> which uses a blob file is not supported.</p>
</dd>
<dt><strong>destination_path: str</strong></dt><dd><p>Path where the compiled model will be saved.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>str</strong><span class="classifier">Path to compiled model directory</span></dt><dd><p>If the <code class="docutils literal notranslate"><span class="pre">destination_path</span></code> is specified, that is the value that will be returned.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel" title="coremltools.models.CompiledMLModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coremltools.models.CompiledMLModel</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">CompiledMLModel</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">compile_model</span>
<span class="kn">from</span> <span class="nn">coremltools.proto</span> <span class="kn">import</span> <span class="n">Model_pb2</span>

<span class="n">spec</span> <span class="o">=</span> <span class="n">Model_pb2</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
<span class="n">spec</span><span class="o">.</span><span class="n">specificationVersion</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">input_</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">input_</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="n">input_</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">doubleType</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">output_</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">output_</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="n">output_</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">doubleType</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">predictedFeatureName</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">glmRegressor</span>
<span class="n">lr</span><span class="o">.</span><span class="n">offset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">weights</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">compiled_model_path</span> <span class="o">=</span> <span class="n">compile_model</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">CompiledMLModel</span><span class="p">(</span><span class="n">compiled_model_path</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.convert_double_to_float_multiarray_type">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">convert_double_to_float_multiarray_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#convert_double_to_float_multiarray_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.convert_double_to_float_multiarray_type" title="Link to this definition"></a></dt>
<dd><p>Convert all double multiarrays feature descriptions (input, output, training input)
to float multiarrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the multiarrays types to convert.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place convert multiarray type of spec</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_double_to_float_multiarray_type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_classifier">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier" title="Link to this definition"></a></dt>
<dd><p>Evaluate a Core ML classifier model and compare against predictions
from the original framework (for testing correctness of conversion).
Use this evaluation for models that don’t deal with probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: list of str or list of MLModel</strong></dt><dd><p>File to load the model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: list of str or list of Dataframe</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a CSV file).</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Column to interpret as the target column.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="coremltools.models.utils.evaluate_classifier_with_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier_with_probabilities</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_classifier</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;data_and_predictions.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="p">{</span><span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num_errors</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_classifier_with_probabilities">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_classifier_with_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'probabilities'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_classifier_with_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="Link to this definition"></a></dt>
<dd><p>Evaluate a classifier specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: [str | Model]</strong></dt><dd><p>File to load the model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: [str | Dataframe]</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a CSV file).</p>
</dd>
<dt><strong>probabilities: str</strong></dt><dd><p>Column to interpret as the probabilities column.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_regressor">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_regressor" title="Link to this definition"></a></dt>
<dd><p>Evaluate a Core ML regression model and compare against predictions
from the original framework (for testing correctness of conversion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: MLModel or str</strong></dt><dd><p>A loaded MLModel or a path to a saved MLModel.</p>
</dd>
<dt><strong>data: Dataframe</strong></dt><dd><p>Test data on which to evaluate the models.</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Name of the column in the dataframe to be compared against the prediction.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for a more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_regressor</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;data_and_predictions.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="p">{</span><span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;rmse&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">max_error</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_transformer">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_transformer" title="Link to this definition"></a></dt>
<dd><p>Evaluate a transformer specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: list of str or list of MLModel</strong></dt><dd><p>File to load the Model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>input_data: list of dict</strong></dt><dd><p>Test data on which to evaluate the models.</p>
</dd>
<dt><strong>reference_output: list of dict</strong></dt><dd><p>Expected results for the model.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_data</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}]</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mf">2.3</span><span class="p">}]</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_transformer</span><span class="p">(</span>
    <span class="n">scaler_spec</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">expected_output</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.load_spec">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">load_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">&lt;module</span> <span class="pre">'coremltools.proto.Model_pb2'</span> <span class="pre">from</span> <span class="pre">'/Volumes/DevData/workspace/coremltools/coremltools/proto/Model_pb2.py'&gt;</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#load_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.load_spec" title="Link to this definition"></a></dt>
<dd><p>Load a protobuf model specification from file (<code class="docutils literal notranslate"><span class="pre">mlmodel</span></code>) or directory (<code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_path: Path to the model from which the protobuf spec is loaded.</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>model_spec: Model_pb</dt><dd><p>Protobuf representation of the model.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.save_spec" title="coremltools.models.utils.save_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.make_pipeline">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">make_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#make_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.make_pipeline" title="Link to this definition"></a></dt>
<dd><p>Makes a pipeline with the given models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*models</strong></dt><dd><p>Two or more instances of <code class="docutils literal notranslate"><span class="pre">ct.models.MLModel</span></code>.</p>
</dd>
<dt><strong>compute_units</strong></dt><dd><p>The set of processing units that all models in the pipeline can use to make predictions.
Can be <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit</span></code>.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> will be inferred from the <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> values of the models.
If all models do not have the same <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> values, this parameter must be specified.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit</span></code> is an enum with four possible values:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU,
but not the neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ct.models.MLModel</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/m1.mlpackage&quot;</span><span class="p">)</span>
<span class="n">my_model2</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/m2.mlmodel&quot;</span><span class="p">)</span>

<span class="n">my_pipeline_model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_pipeline</span><span class="p">(</span><span class="n">my_model1</span><span class="p">,</span> <span class="n">my_model2</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_pipeline_model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>

<span class="n">my_pipeline_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/tmp/my_pipeline.mlpackage&quot;</span><span class="p">)</span>
<span class="n">new_my_pipeline</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/my_pipeline.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.materialize_dynamic_shape_mlmodel">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">materialize_dynamic_shape_mlmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_shape_mlmodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name_to_materialization_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#materialize_dynamic_shape_mlmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.materialize_dynamic_shape_mlmodel" title="Link to this definition"></a></dt>
<dd><p>Given a dynamic-shape mlmodel, materialize symbols to create fixed-shape functions,
then save as an .mlpackage to destination path.
To save memory, the pymil program of input dynamic-shape mlmodel is re-used.
Constant deduplication across functions is performed to allow weight sharing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dynamic_shape_mlmodel</strong><span class="classifier">ct.models.MLModel</span></dt><dd><p>A dynamic-shape mlmodel to be materialized</p>
</dd>
<dt><strong>function_name_to_materialization_map: Dict[str, Dict[str, Tuple[int]]]</strong></dt><dd><p>A dictionary specifying the name of new functions to be created,
and for each new function what is the new fixed shapes for inputs.
If a new function has the same name as an old function,
then the old function will be overridden</p>
</dd>
<dt><strong>destination_path</strong><span class="classifier">str</span></dt><dd><p>The saved .mlpackage model path</p>
</dd>
<dt><strong>source_function_name: str</strong></dt><dd><p>The name of the source symbolic-shape function to be materialized, default = main</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">coremltools.converters.mil.mil.passes.defs.experiment.materialize_symbolic_shape_program</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">materialize_dynamic_shape_mlmodel</span>

<span class="c1"># A dynamic-shape mlmodel you have converted</span>
<span class="n">dynamic_shape_mlmodel</span><span class="p">:</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span>

<span class="c1"># As an example, let us assume the inputs are</span>
<span class="c1"># 1. ``input_ids (1, query_length)``</span>
<span class="c1"># 2. ``mask (query_length, context_length)``</span>
<span class="n">function_name_to_materialization_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;function_name_to_materialization_map&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;materialization_2_3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)},</span>
        <span class="s2">&quot;materialization_4_5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)},</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">materialize_dynamic_shape_mlmodel</span><span class="p">(</span>
    <span class="n">dynamic_shape_mlmodel</span><span class="p">,</span>
    <span class="n">function_name_to_materialization_map</span><span class="p">,</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To make prediction from the materialized mlmodel, load the desired materialized function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">materialization_2_3</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;materialization_2_3&quot;</span>
<span class="p">)</span>
<span class="n">materialization_4_5</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;materialization_4_5&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.randomize_weights">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">randomize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#randomize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.randomize_weights" title="Link to this definition"></a></dt>
<dd><p>Utility function to randomize weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mlmodel: MLModel</strong></dt><dd><p>Model which will be randomized.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>model: MLModel</dt><dd><p>The MLModel with randomized weights.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">coremltools</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>
<span class="n">randomized_mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">randomize_weights</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.rename_feature">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">rename_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#rename_feature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.rename_feature" title="Link to this definition"></a></dt>
<dd><p>Rename a feature in the specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the feature to rename.</p>
</dd>
<dt><strong>current_name: str</strong></dt><dd><p>Current name of the feature. If this feature doesn’t exist, the rename
is a no-op.</p>
</dd>
<dt><strong>new_name: str</strong></dt><dd><p>New name of the feature.</p>
</dd>
<dt><strong>rename_inputs: bool</strong></dt><dd><p>Search for <code class="docutils literal notranslate"><span class="pre">current_name</span></code> only in the input features (that is, ignore output
features).</p>
</dd>
<dt><strong>rename_outputs: bool</strong></dt><dd><p>Search for <code class="docutils literal notranslate"><span class="pre">current_name</span></code> only in the output features (that is, ignore input
features).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place rename of spec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;model.mlmodel&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_feature</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;old_feature&quot;</span><span class="p">,</span> <span class="s2">&quot;new_feature_name&quot;</span><span class="p">)</span>
<span class="c1"># re-initialize model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlmodel&quot;</span><span class="p">)</span>

<span class="c1"># Rename a spec when the model is an mlprogram, in that case, weights are stored outside of the spec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">torch_model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;mlprogram&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="c1"># print info about inputs and outputs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_feature</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;old_feature&quot;</span><span class="p">,</span> <span class="s2">&quot;new_feature_name&quot;</span><span class="p">)</span>
<span class="c1"># re-initialize model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">weights_dir</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.save_multifunction">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">save_multifunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><span class="pre">MultiFunctionDescriptor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#save_multifunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.save_multifunction" title="Link to this definition"></a></dt>
<dd><p>Save a MultiFunctionDescriptor instance into a multifunction <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>.
This function also performs constant deduplication across functions to allow for weight sharing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>desc</strong><span class="classifier">MultiFunctionDescriptor</span></dt><dd><p>Multifunction descriptor to save on the disk.</p>
</dd>
<dt><strong>destination_path</strong><span class="classifier">str</span></dt><dd><p>The path where the new <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code> will be saved.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">MultiFunctionDescriptor</span><span class="p">,</span> <span class="n">save_multifunction</span>

<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">(</span><span class="s2">&quot;my_model_1.mlpackage&quot;</span><span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="s2">&quot;my_model_2.mlpackage&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="s2">&quot;main_2&quot;</span><span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">default_function_name</span> <span class="o">=</span> <span class="s2">&quot;main_2&quot;</span>

<span class="n">save_multifunction</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="s2">&quot;multifunction_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.save_spec">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">save_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_set_specification_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#save_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.save_spec" title="Link to this definition"></a></dt>
<dd><p>Save a protobuf model specification to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>Protobuf representation of the model.</p>
</dd>
<dt><strong>filename: str</strong></dt><dd><p>File path where the spec is saved.</p>
</dd>
<dt><strong>auto_set_specification_version: bool</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will always try to set specification version automatically.</p>
</dd>
<dt><strong>weights_dir: str</strong></dt><dd><p>Path to the directory containing the weights.bin file. This is required
when the spec has model type <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>. If the <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code> does not contain
any weights, this path can be an empty directory.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.load_spec" title="coremltools.models.utils.load_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;mlprogram_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/weights/directory&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coremltools.converters.xgboost.html" class="btn btn-neutral float-left" title="XGBoost" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coremltools.models.ml_program.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Apple Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>