

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Models &mdash; Core ML Tools API Reference  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MIL Input Types" href="coremltools.converters.mil.input_types.html" />
    <link rel="prev" title="XGBoost" href="coremltools.converters.xgboost.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Core ML Tools API Reference
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.html">Converters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.model">MLModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.feature_vectorizer">feature_vectorizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.nearest_neighbors.builder">nearest_neighbors.builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.builder">neural_network.builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.printer">neural_network.printer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.spec_inspection_utils">neural_network.spec_inspection_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.neural_network.utils">neural_network.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.array_feature_extractor">array_feature_extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.datatypes">datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.pipeline">pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.tree_ensemble">tree_ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.utils">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.input_types.html">MIL Input Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.ops.defs.html">MIL Ops</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coremltools.readme.io/docs">Overview and Guides</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coremltools.readme.io/page/examples">Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mlmodel.readme.io/reference">Core ML Format</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apple/coremltools">GitHub</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Core ML Tools API Reference</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/coremltools.models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-coremltools.models.model">
<span id="mlmodel"></span><h2>MLModel<a class="headerlink" href="#module-coremltools.models.model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="coremltools.models.model.MLModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.model.</span></code><code class="sig-name descname"><span class="pre">MLModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useCPUOnly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.model.MLModel" title="Permalink to this definition">¶</a></dt>
<dd><p>This class defines the minimal interface to a CoreML object in Python.</p>
<p>At a high level, the protobuf specification consists of:</p>
<ul class="simple">
<li><p>Model description: Encodes names and type information of the inputs and outputs to the model.</p></li>
<li><p>Model parameters: The set of parameters required to represent a specific instance of the model.</p></li>
<li><p>Metadata: Information about the origin, license, and author of the model.</p></li>
</ul>
<p>With this class, you can inspect a CoreML model, modify metadata, and make
predictions for the purposes of testing (on select platforms).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.model.MLModel.predict" title="coremltools.models.model.MLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the model</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span>  <span class="n">MLModel</span><span class="p">(</span><span class="s1">&#39;HousePricer.mlmodel&#39;</span><span class="p">)</span>

<span class="c1"># Set the model metadata</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="s1">&#39;Author&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="s1">&#39;BSD&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s1">&#39;Predicts the price of a house in the Seattle area.&#39;</span>

<span class="c1"># Get the interface to the model</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">input_description</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">output_description</span>

<span class="c1"># Set feature descriptions manually</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s1">&#39;bedroom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Number of bedrooms&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s1">&#39;bathrooms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Number of bathrooms&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Size (in square feet)&#39;</span>

<span class="c1"># Set</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">output_description</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Price of the house&#39;</span>

<span class="c1"># Make predictions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;bedroom&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bath&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">})</span>

<span class="c1"># Get the spec of the model</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">spec</span>

<span class="c1"># Save the model</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;HousePricer.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.model.MLModel.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useCPUOnly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.model.MLModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an MLModel from a .mlmodel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: str or Model_pb2</strong></dt><dd><p>If a string is given it should be the location of the .mlmodel to load.</p>
</dd>
<dt><strong>useCPUOnly: bool</strong></dt><dd><p>Set to true to restrict loading of model on CPU Only. Defaults to False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s1">&#39;my_model_file.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.model.MLModel.get_spec">
<code class="sig-name descname"><span class="pre">get_spec</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.model.MLModel.get_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a deep copy of the protobuf specification of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>model: Model_pb2</dt><dd><p>Protobuf specification of the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.model.MLModel.predict">
<code class="sig-name descname"><span class="pre">predict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useCPUOnly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.model.MLModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions for the model. The kwargs gets passed into the
model as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict[str, value]</strong></dt><dd><p>Dictionary of data to make predictions from where the keys are
the names of the input features.</p>
</dd>
<dt><strong>useCPUOnly: bool</strong></dt><dd><p>Set to true to restrict computation to use only the CPU. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>out: dict[str, value]</dt><dd><p>Predictions as a dictionary where each key is the output feature
name.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bedroom&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bath&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.model.MLModel.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.model.MLModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to a .mlmodel format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: str</strong></dt><dd><p>Target filename for the model.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">coremltools.utils.load_model</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_model_file.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s1">&#39;my_model_file.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-coremltools.models.feature_vectorizer">
<span id="feature-vectorizer"></span><h2>feature_vectorizer<a class="headerlink" href="#module-coremltools.models.feature_vectorizer" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="coremltools.models.feature_vectorizer.create_feature_vectorizer">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.feature_vectorizer.</span></code><code class="sig-name descname"><span class="pre">create_feature_vectorizer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_size_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.feature_vectorizer.create_feature_vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a feature vectorizer from input features. This returns a 2-tuple
<code class="docutils literal notranslate"><span class="pre">(spec,</span> <span class="pre">num_dimension)</span></code> for a feature vectorizer that puts everything into a
single array with a length equal to the total size of all the input features.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The datatypes entry is one of the data types defined in the
<code class="docutils literal notranslate"><span class="pre">datatypes</span></code> module.  Allowed <code class="docutils literal notranslate"><span class="pre">datatypes</span></code> are <code class="docutils literal notranslate"><span class="pre">datatype.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatype.Double</span></code>, <code class="docutils literal notranslate"><span class="pre">datatypes.Dictionary</span></code>, and <code class="docutils literal notranslate"><span class="pre">datatype.Array</span></code>.</p>
<p>If the feature is a dictionary type, then the dictionary must have integer
keys, and the number of dimensions to expand it into must be provided by
<code class="docutils literal notranslate"><span class="pre">known_size_map</span></code>.</p>
<p>Feature indices in the final array are counted sequentially from the
from 0 through the total number of features.</p>
</dd>
<dt><strong>output_feature_name: str</strong></dt><dd><p>The name of the output feature.  The type is an Array
List of the output features of the network.</p>
</dd>
<dt><strong>known_size_map:</strong></dt><dd><p>A dictionary mapping the feature name to the expanded size in the final
array.  This is most useful for specifying the size of sparse vectors
given as dictionaries of index to value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.nearest_neighbors.builder">
<span id="nearest-neighbors-builder"></span><h2>nearest_neighbors.builder<a class="headerlink" href="#module-coremltools.models.nearest_neighbors.builder" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.nearest_neighbors.builder.</span></code><code class="sig-name descname"><span class="pre">KNearestNeighborsClassifierBuilder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a CoreML KNearestNeighborsClassifier specification.</p>
<p>Please see the Core ML Nearest Neighbors protobuf message for more information
on KNearestNeighborsClassifier parameters.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.nearest_neighbors</span> <span class="kn">import</span> <span class="n">KNearestNeighborsClassifierBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a KNearestNeighborsClassifier model that takes 4-dimensional input data and outputs a string label.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">KNearestNeighborsClassifierBuilder</span><span class="p">(</span><span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">number_of_dimensions</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">default_class_label</span><span class="o">=</span><span class="s1">&#39;default_label&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;knnclassifier.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a KNearestNeighborsClassifierBuilder object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_name</strong></dt><dd><p>Name of the model input.</p>
</dd>
<dt><strong>output_name</strong></dt><dd><p>Name of the output.</p>
</dd>
<dt><strong>number_of_dimensions</strong></dt><dd><p>Number of dimensions of the input data.</p>
</dd>
<dt><strong>default_class_label</strong></dt><dd><p>The default class label to use for predictions. Must be either an
int64 or a string.</p>
</dd>
<dt><strong>number_of_neighbors</strong></dt><dd><p>Number of neighbors to use for predictions. Default = 5 with allowed values
between 1-1000.</p>
</dd>
<dt><strong>weighting_scheme</strong></dt><dd><p>Weight function used in prediction. One of <code class="docutils literal notranslate"><span class="pre">'uniform'</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">'inverse_distance'</span></code>.</p>
</dd>
<dt><strong>index_type</strong></dt><dd><p>Algorithm to compute nearest neighbors. One of <code class="docutils literal notranslate"><span class="pre">'linear'</span></code> (default), or
<code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code>.</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>Leaf size for the kd-tree. Ignored if index type is <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>. Default = 30.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._is_valid_number_type">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_is_valid_number_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._is_valid_number_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the object is a valid number type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obj</strong></dt><dd><p>The object to check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>True if a valid number type, False otherwise.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._is_valid_text_type">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_is_valid_text_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._is_valid_text_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the object is a valid text type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obj</strong></dt><dd><p>The object to check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>True if a valid text type, False otherwise.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._validate_label_types">
<code class="sig-name descname"><span class="pre">_validate_label_types</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder._validate_label_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure the label types matched the expected types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec</strong></dt><dd><p>The spec.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>The list of labels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None, throws a TypeError if not expected.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples">
<code class="sig-name descname"><span class="pre">add_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Add some samples to the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_points</strong></dt><dd><p>List of input data points.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>List of corresponding labels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">author</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the author for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The author</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">description</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the description for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The description.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">index_type</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The index type.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_updatable</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the KNearestNeighborsClassifier is updatable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Is updatable.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">leaf_size</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the leaf size for the KNearestNeighborsClassifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The leaf size.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">license</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the author for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The author</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">number_of_dimensions</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the input data for the
KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Number of dimensions.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">number_of_neighbors</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of neighbors value for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The number of neighbors default value.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range">
<code class="sig-name descname"><span class="pre">number_of_neighbors_allowed_range</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the range of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the range hasn’t been set.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set">
<code class="sig-name descname"><span class="pre">number_of_neighbors_allowed_set</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the set of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Set of allowed values or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the set of allowed values hasn’t been</dt><dd></dd>
<dt>populated.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type">
<code class="sig-name descname"><span class="pre">set_index_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index_type</strong></dt><dd><p>One of [ <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>, <code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code> ].</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>For kd_tree indexes, the leaf size to use (default = 30).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds">
<code class="sig-name descname"><span class="pre">set_number_of_neighbors_with_bounds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the numberOfNeighbors parameter for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>allowed_range</strong></dt><dd><p>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) defining the range of allowed values.</p>
</dd>
<dt><strong>allowed_values</strong></dt><dd><p>Set of allowed values for the number of neighbors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">weighting_scheme</span></code><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the weighting scheme for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>The weighting scheme.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.builder">
<span id="neural-network-builder"></span><h2>neural_network.builder<a class="headerlink" href="#module-coremltools.models.neural_network.builder" title="Permalink to this headline">¶</a></h2>
<p>Neural network builder class to construct Core ML models.</p>
<dl class="py class">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.builder.</span></code><code class="sig-name descname"><span class="pre">NeuralNetworkBuilder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_rank5_shape_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_float_arraytype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural network builder class to construct Core ML models.</p>
<p>The NeuralNetworkBuilder constructs a Core ML neural network specification
layer by layer. The layers should be added in such an order that the inputs
to each layer (referred to as blobs) of each layer has been previously
defined. The builder can also set pre-processing steps to handle
specialized input format (e.g. images), and set class labels for neural
network classifiers.
Refer to the protobuf messages in specification (NeuralNetwork.proto) for more details.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">datatypes</span><span class="p">,</span> <span class="n">NeuralNetworkBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a neural network binary classifier that classifies</span>
<span class="c1"># 3-dimensional data points</span>
<span class="c1"># Specify input and output dimensions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>

<span class="c1"># Specify input and output features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">input_dim</span><span class="p">))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">output_dim</span><span class="p">))]</span>

<span class="c1"># Build a simple neural network with 1 inner product layer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_inner_product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ip_layer&#39;</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">input_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;probs&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;network.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_rank5_shape_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_float_arraytype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a NeuralNetworkBuilder object to build an MLModel specification with
model interface or a NeuralNetwork protobuf message, either from scratch or an
existing specification.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>input_features: [(str, datatypes.Array)] or None</strong></dt><dd><p>List of input feature of the network. Each feature is a (name,
array) tuple, where name the name of the feature, and array
is an datatypes.Array object describing the feature type.
When spec is None (building from scratch), input_features must not be None.
When spec is not None, input_features will be ignored; input feature of
existing spec will be used instead.</p>
</dd>
<dt><strong>output_features: [(str, datatypes.Array or None)] or None</strong></dt><dd><p>List of output feature of the network. Each feature is a (name,
array) tuple, where name is the name of the feature, and array
is an datatypes.Array object describing the feature type.
array can be None if not known.
When spec is None (building from scratch), output_features must not be None.
When spec is not None, output_features will be ignored; output feature of
existing spec will be used instead.</p>
</dd>
<dt><strong>mode: str (‘classifier’, ‘regressor’ or None)</strong></dt><dd><p>Mode (one of ‘classifier’, ‘regressor’, or None).</p>
<p>When mode = ‘classifier’, a NeuralNetworkClassifier spec will be
constructed.  When mode = ‘regressor’, a NeuralNetworkRegressor
spec will be constructed.</p>
</dd>
<dt><strong>disable_rank5_shape_mapping: bool</strong></dt><dd><p>Only applicable for neural networks.
If True, inputs are no longer forced to map to rank 5 tensors
(rank is equal to the length of the shape of the tensor).
Instead, for multi-array inputs “EXACT_ARRAY_MAPPING” mapping is used, whereas
for image inputs “RANK4_IMAGE_MAPPING” is used.
For details, see description of enums “NeuralNetworkMultiArrayShapeMapping”
and “NeuralNetworkImageShapeMapping” in NeuralNetwork.proto.
When spec is not None, this argument will be ignored.</p>
</dd>
<dt><strong>spec: None or coremltools.proto.Model_pb2</strong></dt><dd><p>If None, a new MLModel spec will be created by the builder with input and output features.
Otherwise, the builder will continue to build on spec. This is useful when the MLModel is
built incrementally.</p>
</dd>
<dt><strong>nn_spec: None or coremltools.proto.NeuralNetwork_pb2</strong></dt><dd><p>If None, a new, empty NeuralNetwork proto will be created for spec.
If nn_spec is not None and spec is None, the builder will build a NeuralNetwork spec without
wrapping it within an MLModel. This is useful to create nested NeuralNetworks for models
with control flow operations.</p>
</dd>
<dt><strong>use_float_arraytype: bool</strong></dt><dd><p>If true, the datatype of input/output multiarrays is set to Float32 instead
of double.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct a builder that builds a neural network classifier with a 299 x 299 x 3</span>
<span class="c1"># dimensional input and 1000 dimensional output</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">299</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">1000</span><span class="p">,)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;classifier&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder._check_fp16_weight_param_exists">
<code class="sig-name descname"><span class="pre">_check_fp16_weight_param_exists</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder._check_fp16_weight_param_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the network has at least one weight_param which is in FP16 format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>layers: list of nn_spec.layer</strong></dt><dd><p>List of layers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder._check_fp16_weight_params_lstms">
<code class="sig-name descname"><span class="pre">_check_fp16_weight_params_lstms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lstm_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_peephole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder._check_fp16_weight_params_lstms" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a lstm layer has at least one weight_param which is in FP16 format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lstm_wp: lstm weights</strong></dt><dd></dd>
<dt><strong>has_peephole: if the lstm has peephole</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos">
<code class="sig-name descname"><span class="pre">add_acos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an acos layer to the model that computes element-wise arc-cosine
for the input tensor.
Refer to the <strong>AcosLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh">
<code class="sig-name descname"><span class="pre">add_acosh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an acosh layer to the model that computes element-wise inverse
hyperbolic cosine for the input tensor.
Refer to the <strong>AcoshLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation">
<code class="sig-name descname"><span class="pre">add_activation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_linearity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an activation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>non_linearity: str</strong></dt><dd><p>The non_linearity (activation) function of this layer.
It can be one of the following:</p>
<blockquote>
<div><ul>
<li><p>‘RELU’: Rectified Linear Unit (ReLU) function.</p></li>
<li><p>‘SIGMOID’: sigmoid function.</p></li>
<li><p>‘TANH’: tanh function.</p></li>
<li><p>‘SCALED_TANH’: scaled tanh function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">tanh(beta</span> <span class="pre">*</span> <span class="pre">x)</span></code></p>
<p>where alpha and beta are constant scalars.</p>
</li>
<li><p>‘SOFTPLUS’: softplus function.</p></li>
<li><p>‘SOFTSIGN’: softsign function.</p></li>
<li><p>‘SIGMOID_HARD’: hard sigmoid function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">min(max(alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta,</span> <span class="pre">-1),</span> <span class="pre">1)</span></code></p>
<p>where alpha and beta are constant scalars.</p>
</li>
<li><p>‘LEAKYRELU’: leaky relu function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p>‘PRELU’: Parametric ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a multi-dimensional array of same size as x.</p>
</li>
<li><p>‘ELU’: Exponential linear unit function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">(alpha</span> <span class="pre">*</span> <span class="pre">exp(x)</span> <span class="pre">-</span> <span class="pre">1)</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p>‘PARAMETRICSOFTPLUS’: Parametric softplus function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">log(1</span> <span class="pre">+</span> <span class="pre">exp(beta</span> <span class="pre">*</span> <span class="pre">x))</span></code></p>
<p>where alpha and beta are two multi-dimensional arrays of same size as x.</p>
</li>
<li><p>‘THRESHOLDEDRELU’: Thresholded ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">alpha)</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p>‘LINEAR’: linear function.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>params: list of float or numpy.array</strong></dt><dd><p>Parameters for the activation, depending on non_linearity.</p>
<blockquote>
<div><ul class="simple">
<li><p>When non_linearity is one of [‘RELU’, ‘SIGMOID’, ‘TANH’, ‘SCALED_TANH’, ‘SOFTPLUS’, ‘SOFTSIGN’], params is ignored.</p></li>
<li><p>When non_linearity is one of [‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’], param is a list of 2 floats
[alpha, beta].</p></li>
<li><p>When non_linearity is one of [‘LEAKYRELU’, ‘ELU’, ‘THRESHOLDEDRELU’], param is a list of 1 float
[alpha].</p></li>
<li><p>When non_linearity is ‘PRELU’, param is a list of 1 numpy array [alpha]. The shape of
alpha is (C,), where C is either the number of input channels or
1. When C = 1, same alpha is applied to all channels.</p></li>
<li><p>When non_linearity is ‘PARAMETRICSOFTPLUS’, param is a list of 2 numpy arrays [alpha,
beta]. The shape of alpha and beta is (C, ), where C is either
the number of input channels or 1. When C = 1, same alpha and
beta are applied to all channels.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_softmax</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable">
<code class="sig-name descname"><span class="pre">add_add_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an add_broadcastable layer to the model that performs element-wise
addition operation with broadcast support.
Refer to the <strong>AddBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax">
<code class="sig-name descname"><span class="pre">add_argmax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an argmax layer to the model that returns the indices of the maximum
value along a specified axis in the input tensor.
Refer to the <strong>ArgMaxLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which the argmax is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmin</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin">
<code class="sig-name descname"><span class="pre">add_argmin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an argmin layer to the model that returns the indices of the minimum
value along a specified axis in the input tensor.
Refer to the <strong>ArgMinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which the argmin is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmax</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argsort">
<code class="sig-name descname"><span class="pre">add_argsort</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an argsort layer to the model.
Refer to the <strong>ArgsortLayerParams</strong> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>axis along which to compute the sorting indices</p>
</dd>
<dt><strong>descending: bool, optional</strong></dt><dd><p>order of sorting</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_topk</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin">
<code class="sig-name descname"><span class="pre">add_asin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an asin layer to the model that computes element-wise arc-sine for
the input tensor.
Refer to the <strong>AsinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh">
<code class="sig-name descname"><span class="pre">add_asinh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an asinh layer to the model that computes element-wise inverse
hyperbolic sine for the input tensor.
Refer to the <strong>AsinhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan">
<code class="sig-name descname"><span class="pre">add_atan</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atan layer to the model that computes element-wise arc-tangent
for the input tensor.
Refer to the <strong>AtanLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh">
<code class="sig-name descname"><span class="pre">add_atanh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atanh layer to the model that computes element-wise inverse
hyperbolic tangent for the input tensor.
Refer to the <strong>AtanhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul">
<code class="sig-name descname"><span class="pre">add_batched_mat_mul</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_8_dynamic_quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a N-D Batched Matrix Multiplication layer with numpy like broadcasting.
Refer to the <strong>BatchedMatMulLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>transpose_a: bool, optional</strong></dt><dd><p>Whether or not to transpose A, default: false.</p>
</dd>
<dt><strong>transpose_b: bool, optional</strong></dt><dd><p>Whether or not to transpose B, default: false.</p>
</dd>
<dt><strong>weight_matrix_rows: int, optional</strong></dt><dd><p>Must be equal to the last dimension of the input, default: 0.</p>
</dd>
<dt><strong>weight_matrix_columns: int, optional</strong></dt><dd><p>Must be equal to the last dimension of the output, default: 0.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes(), optional</strong></dt><dd><p>Weight matrix of shape (weight_matrix_rows, weight_matrix_columns)
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>bias: float32 numpy.array, optional</strong></dt><dd><p>Bias vector of shape (weight_matrix_columns,).</p>
</dd>
<dt><strong>Quantization arguments, used when W is of type bytes():</strong></dt><dd></dd>
<dt><strong>is_quantized_weight: bool, optional</strong></dt><dd><p>Set it to true when W is of type bytes(), representing quantized weights, default: false.</p>
</dd>
<dt><strong>quantization_type: str, optional</strong></dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”, default: linear.</p>
</dd>
<dt><strong>nbits: int, optional</strong></dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value, default: 8.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32), optional</strong></dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or weight_matrix_columns, default: None.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32), optional</strong></dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or weight_matrix_columns, default: None.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32), optional</strong></dt><dd><p>The LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits, default: None.</p>
</dd>
<dt><strong>int_8_dynamic_quantize: bool</strong></dt><dd><p>Whether to quantize and dequantize before and after batched matmul, respectively.
Expects byte weights, representing int8 values, if True. See NeuralNetwork.proto for other validation conditions.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm">
<code class="sig-name descname"><span class="pre">add_batchnorm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_mean_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance_normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a batch normalization layer. Batch normalization operation is
defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">gamma</span> <span class="pre">*</span> <span class="pre">(x</span> <span class="pre">-</span> <span class="pre">mean)</span> <span class="pre">/</span> <span class="pre">sqrt(variance</span> <span class="pre">+</span> <span class="pre">epsilon)</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
<p>Refer to the <strong>BatchnormLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>channels: int</strong></dt><dd><p>Number of channels of the input blob.</p>
</dd>
<dt><strong>gamma: numpy.array</strong></dt><dd><p>Values of gamma. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>beta: numpy.array</strong></dt><dd><p>Values of beta. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>mean: numpy.array</strong></dt><dd><p>Means of the input blob on each channel. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>variance:</strong></dt><dd><p>Variances of the input blob on each channel. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>compute_mean_var: bool</strong></dt><dd><p>Set to True if mean and variance is to be computed from the input data.</p>
</dd>
<dt><strong>instance_normalization: bool</strong></dt><dd><p>Set compute_mean_var and this to True to perform
instance normalization i.e., mean and variance are computed from the single input instance.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>Value of epsilon. Defaults to 1e-5 if not specified.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias">
<code class="sig-name descname"><span class="pre">add_bias</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bias layer to the model.
Refer to the <strong>BiasLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt><dd><p>Bias to add to the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt><dd><p>List of ints that specifies the shape of the bias parameter (if present). Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scale</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm">
<code class="sig-name descname"><span class="pre">add_bidirlstm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_state_update_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_input_forget_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Bi-directional LSTM layer to the model.
Refer to the <strong>BiDirectionalLSTMLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices for the forward layer. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices for the forward layer. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array]</strong></dt><dd><p>List of biases for the forward layer. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>W_h_back: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices for the backward layer. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x_back: [numpy.array]</strong></dt><dd><p>List of input weight matrices for the backward layer. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b_back: [numpy.array]</strong></dt><dd><p>List of biases for the backward layer. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
The shapes of the biases (hidden_size).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer, in the order of [x, h_input, c_input, h_reverse_input, c_reverse_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer, in the order of [y, h_output, c_output, h_reverse_output, c_reverse_output].</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at input and forget gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘SIGMOID’.</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt><dd><p>Cell state update activation function used at the cell state update gate.
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.</p>
</dd>
<dt><strong>output_activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors for the forward layer. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,). Defaults to None.</p>
</dd>
<dt><strong>peep_back: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors for the backward layer. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,). Defaults to None.</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the LSTM layer should output at every time step. Defaults to False.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt><dd><p>If True, a vector of 1s is added to forget gate bias. Defaults to False.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt><dd><p>If True, the input gate and forget gate is coupled. i.e. forget gate is not used.
Defaults to False.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt><dd><p>The limit on the maximum and minimum values on the cell state.
Defaults to 50.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch">
<code class="sig-name descname"><span class="pre">add_branch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">else_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a branch layer to the model that provides the functionality of
branching or an <code class="docutils literal notranslate"><span class="pre">if-else</span></code> block.
Refer to the <strong>BranchLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>if_branch: NeuralNetwork</strong></dt><dd><p>Neural network to execute if the absolute value of the input tensor is greater than 1e-6.</p>
</dd>
<dt><strong>else_branch: NeuralNetwork, optional</strong></dt><dd><p>Neural network to execute if the absolute value of the input tensor is less than 1e-6.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic">
<code class="sig-name descname"><span class="pre">add_broadcast_to_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_dynamic layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like">
<code class="sig-name descname"><span class="pre">add_broadcast_to_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_like layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static">
<code class="sig-name descname"><span class="pre">add_broadcast_to_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_static layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>The target shape of the output tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution">
<code class="sig-name descname"><span class="pre">add_categorical_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a categorical_distribution layer to the model that fills the output
tensor with random values from categorical distribution.
Refer to the <strong>CategoricalDistributionLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>num_samples: int</strong></dt><dd><p>List of dimensions for the reduce operations.</p>
</dd>
<dt><strong>is_logits: bool, optional</strong></dt><dd><p>If true, the input is log probabilities. If false, the input is
probabilities, default: True</p>
</dd>
<dt><strong>eps: float, optional</strong></dt><dd><p>Epsilon parameter for categorical distribution, default 1e-10.</p>
</dd>
<dt><strong>temperature: float, optional</strong></dt><dd><p>Temperature parameter for categorical distribution, default 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil">
<code class="sig-name descname"><span class="pre">add_ceil</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a ceil layer to the model that performs element-wise ceil operation
on the input tensor that rounds the value to the smallest integer not
less than x.
Refer to the <strong>CeilLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clamped_relu">
<code class="sig-name descname"><span class="pre">add_clamped_relu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clamped_relu" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a clamped relu layer to the model.
Clamped relu formula is f(x) = min((x &gt;= 0 ? x : alpha * x), beta)
Refer to the <strong>ClampedReluLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>slope of the output when input is negative, default: 0.0.</p>
</dd>
<dt><strong>beta: float, optional</strong></dt><dd><p>Upper bound on the output value, default: 6.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip">
<code class="sig-name descname"><span class="pre">add_clip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a clip layer to the model that performs element-wise clip operation.
Clip the values in the input tensor to the range [min_value, max_value].
Refer to the <strong>ClipLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>min_value: float, optional</strong></dt><dd><p>Lower bound / minimum value for clip, default: 0.0.</p>
</dd>
<dt><strong>max_value: float, optional</strong></dt><dd><p>Upper bound / maximum value for clip, default: 1.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd">
<code class="sig-name descname"><span class="pre">add_concat_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a concat_nd layer to the model that performs concatenation along the
given axis.
Refer to the <strong>ConcatNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the concat operation on.</p>
</dd>
<dt><strong>interleave</strong><span class="classifier">bool</span></dt><dd><p>(Only available in Core ML Specification &gt;= 5 (iOS &gt;= 14, macOS &gt;= 11.0)
If true, concatenate by interleaving the inputs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad">
<code class="sig-name descname"><span class="pre">add_constant_pad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_to_given_output_size_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_amounts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constant pad layer.
Refer to the <strong>ConstantPaddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float</strong></dt><dd><p>value to be used for padding.</p>
</dd>
<dt><strong>pad_to_given_output_size_mode: bool</strong></dt><dd><p>if true, pad_amounts are interpreted as output shapes (see example in NeuralNetwork.proto)</p>
</dd>
<dt><strong>pad_amounts: [int], optional</strong></dt><dd><p>must be non negative. Amount to pad in each dimension. Length of the list must be twice the input/output rank.
Not required if second input is present.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution">
<code class="sig-name descname"><span class="pre">add_convolution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_deconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_padding_asymmetry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a convolution layer to the network.
Refer to the <strong>ConvolutionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>kernel_channels: int</strong></dt><dd><p>Number of channels for the convolution kernels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of filter kernels. This is equal to the number of channels in the output blob.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of each kernel.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of each kernel.</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>border_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape. Can be either ‘valid’ or ‘same’.</p>
</dd>
<dt><strong>groups: int</strong></dt><dd><p>Number of kernel groups. Input is divided into groups along the channel axis. Each kernel group share the same weights.</p>
</dd>
<dt><strong>W: numpy.array or bytes() or None</strong></dt><dd><p>Weight of the convolution kernels.</p>
<ul class="simple">
<li><p>If is_deconv is False, W should have shape (height, width, kernel_channels, output_channels), where kernel_channel = input_channels / groups</p></li>
<li><p>If is_deconv is True, W should have shape (height, width, kernel_channels, output_channels / groups), where kernel_channel = input_channels</p></li>
</ul>
<p>If W is of type bytes(), i.e. quantized, other quantization related arguments must be provided as well (see below).
For Core ML specification version &gt;=4, W can be None. In this case,
the convolution layer takes 2 inputs, where the 1st input represents the input feature map,
the 2nd input represents the weight blob.</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Biases of the convolution kernels. b should have shape (outputChannels, ).</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether bias is ignored.</p>
<ul class="simple">
<li><p>If True, bias is not ignored.</p></li>
<li><p>If False, bias is ignored.</p></li>
</ul>
</dd>
<dt><strong>is_deconv: boolean</strong></dt><dd><p>Whether the convolution layer is performing a convolution or a transposed convolution (deconvolution).</p>
<ul class="simple">
<li><p>If True, the convolution layer is performing transposed convolution.</p></li>
<li><p>If False, the convolution layer is performing regular convolution.</p></li>
</ul>
</dd>
<dt><strong>output_shape: tuple or None</strong></dt><dd><p>Either None or a 2-tuple, specifying the output shape (output_height, output_width). Used only when is_deconv == True.
When is_deconv == False, this parameter is ignored.
If it is None, the output shape is calculated automatically using the border_mode.</p>
</dd>
<dt><strong>input_name: str or list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>dilation_factors: list of int</strong></dt><dd><p>Dilation factors across height and width directions. Must be a list of two positive integers.
Defaults to [1, 1]</p>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>values of height (top, bottom) and width (left, right) padding to be used if border_more is “valid”.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str.</strong></dt><dd><p>Type of asymmetric padding to be used when  border_mode is ‘same’.
Can be either ‘BOTTOM_RIGHT_HEAVY’ or  ‘TOP_LEFT_HEAVY’.</p>
</dd>
<dt><strong>Depthwise convolution is a special case of convolution, where we have:</strong></dt><dd><p>kernel_channels = 1 (== input_channels / groups)
output_channels = channel_multiplier * input_channels
groups = input_channels
W: [Kernel_height, Kernel_width, 1, channel_multiplier * input_channels]</p>
</dd>
<dt><strong>Quantization arguments expected in kwargs, when W is of type bytes():</strong></dt><dd><dl class="simple">
<dt>quantization_type: str</dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt>nbits: int</dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value. Only applicable when
weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt><dd><p>the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution3d</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batchnorm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d">
<code class="sig-name descname"><span class="pre">add_convolution3d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_deconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a 3 dimensional convolution layer to the network.
Refer to the <strong>Convolution3DLayerParams</strong> message in specification (NeuralNetwork.proto) for
more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_channels: int</strong></dt><dd><p>Number of input channels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of filter kernels. This is equal to the number of channels in the output blob.</p>
</dd>
<dt><strong>depth: int</strong></dt><dd><p>Depth of each kernel.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of each kernel.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of each kernel.</p>
</dd>
<dt><strong>W: numpy.array or bytes()</strong></dt><dd><p>Weight of the convolution kernels.
- W should have shape:
- If deconv is False: (output_channels, kernel_channels, depth, height, width), where</p>
<blockquote>
<div><p>kernel_channels = input_channels / groups</p>
</div></blockquote>
<ul class="simple">
<li><p>If deconv is True: (output_channels / groups, kernel_channels, depth, height, width)
where kernel_channels = input_channels</p></li>
</ul>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Biases of the convolution kernels. b should have shape (outputChannels, ).</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether bias is ignored.
- If True, bias is not ignored.
- If False, bias is ignored.</p>
</dd>
<dt><strong>groups: int</strong></dt><dd><p>Number of kernel groups. Input is divided into groups along the channel axis. Each
kernel group share the same weights. Defaults to 1.</p>
</dd>
<dt><strong>stride_depth, stride_height, stride_width: int</strong></dt><dd><p>Stride along the depth, height, and width directions, respectively. Must all be positive
integers. Defaults to 1.</p>
</dd>
<dt><strong>dilation_depth, dilation_width, dilation_height: int</strong></dt><dd><p>Dilation factors across depth, height, and width directions. Must all be positive
integers. Defaults to 1 in each dimension.</p>
</dd>
<dt><strong>is_deconv: bool</strong></dt><dd><p>True if this is Convolution Transpose, otherwise False.</p>
</dd>
<dt><strong>output_shape: None or Tuple of int</strong></dt><dd><p>Applicable only for Deconvolution layer.
None if Convolution.
Tuple of length 3 if Convolution Transpose.</p>
</dd>
<dt><strong>padding_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape. Can be ‘custom’, ‘valid’, or ‘same’.
Defaults to ‘valid’. Case-insensitive.</p>
</dd>
<dt><strong>padding_front, padding_back, padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>Values of depth (front, back), height (top, bottom), and width (left, right) padding to
be used. Must all be positive integers. All default to 0.</p>
</dd>
<dt><strong>input_name: str or list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Depthwise convolution is a special case of convolution, where we have:</strong></dt><dd><p>kernel_channels = 1 (== input_channels / groups)
output_channels = channel_multiplier * input_channels
groups = input_channels
W: [Kernel_depth, Kernel_height, Kernel_width, 1, channel_multiplier * input_channels]</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batchnorm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy">
<code class="sig-name descname"><span class="pre">add_copy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a copy layer to the model that copies its input tensor to the output
tensor. Input tensor and output tensor must have distinct names.
Refer to the <strong>CopyLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos">
<code class="sig-name descname"><span class="pre">add_cos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a cos layer to the model that computes element-wise cosine for the
input tensor.
Refer to the <strong>CosLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh">
<code class="sig-name descname"><span class="pre">add_cosh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a osh layer to the model that computes element-wise hyperbolic
cosine for the input tensor.
Refer to the <strong>CoshLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop">
<code class="sig-name descname"><span class="pre">add_crop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a cropping layer to the model.
The cropping layer have two functional modes:</p>
<blockquote>
<div><ul class="simple">
<li><p>When it has 1 input blob, it crops the input blob based
on the 4 parameters [left, right, top, bottom].</p></li>
<li><p>When it has 2 input blobs, it crops the first input blob based
on the dimension of the second blob with an offset.</p></li>
</ul>
</div></blockquote>
<p>Refer to the <strong>CropLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt><dd><p>Number of elements to be cropped on the left side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>right: int</strong></dt><dd><p>Number of elements to be cropped on the right side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>top: int</strong></dt><dd><p>Number of elements to be cropped on the top of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>bottom: int</strong></dt><dd><p>Number of elements to be cropped on the bottom of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>offset: list of int</strong></dt><dd><p>Offset along the height and width directions when the crop layer takes 2 inputs. Must be a list of length 2.
When the crop layer takes 1 input, this parameter is ignored.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. Must be either a list of 1 string (1 input crop layer),
or a list of 2 strings (2-input crop layer).</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize">
<code class="sig-name descname"><span class="pre">add_crop_resize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'STRICT_ALIGN_ENDPOINTS_MODE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_roi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_indices_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CORNERS_HEIGHT_FIRST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a crop resize layer to the model. A layer that extracts cropped spatial patches or RoIs (regions of interest)
from the input and resizes them to a pre-specified size using bilinear interpolation.
Note that RoI Align layer can be implemented with this layer followed by a pooling layer.
Refer to the <strong>CropResizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>Must be a list of two names: image feature map and crop indices/RoI input.
First input corresponds to a blob with shape <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">Batch,</span> <span class="pre">C,</span> <span class="pre">H_in,</span> <span class="pre">W_in]</span></code>. This represents a batch of input image feature data with C channels.
The second input shape must be <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">1,</span> <span class="pre">1]</span></code> or <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>. This represents the bounding box coordinates for N patches/RoIs.
N: number of patches/RoIs to be extracted
If RoI shape = [N, 1, 4, 1, 1]
The channel axis corresponds to the four coordinates specifying the bounding box.
All the N~ RoIs are extracted from all the batches of the input.
If RoI shape = [N, 1, 5, 1, 1]
The first element of the channel axis specifies the input batch id from which to extract the RoI and
must be in the interval <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">Batch</span> <span class="pre">-</span> <span class="pre">1]</span></code>. That is, n-th RoI is extracted from the RoI[n,0,0,0]-th input batch id.
The last four elements of the channel axis specify the bounding box coordinates.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt><dd><p>Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt><dd><p>Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Following values are supported: ‘STRICT_ALIGN_ENDPOINTS_MODE’, ‘ALIGN_ENDPOINTS_MODE’, ‘UPSAMPLE_MODE’, ‘ROI_ALIGN_MODE’.
This parameter determines the sampling grid used for bilinear interpolation.</p>
</dd>
<dt><strong>normalized_roi: bool</strong></dt><dd><p>If true the bounding box coordinates must be in the interval [0, 1].
They are scaled by (input_height - 1), (input_width - 1), i.e. based on the input spatial dimensions.
If false the bounding box coordinates must be in the interval
[0, input_height - 1] and [0, input_width - 1], respectively for height and width dimensions.</p>
</dd>
<dt><strong>box_indices_mode: str</strong></dt><dd><p>Following values are supported: ‘CORNERS_HEIGHT_FIRST’, ‘CORNERS_WIDTH_FIRST’, ‘CENTER_SIZE_HEIGHT_FIRST’, ‘CENTER_SIZE_WIDTH_FIRST’
Representation used to interpret the bounding box coordinates (RoI) input.
‘CORNERS_HEIGHT_FIRST’: [h_start, w_start, h_end, w_end]
‘CORNERS_WIDTH_FIRST’: [w_start, h_start, w_end, h_end]
‘CENTER_SIZE_HEIGHT_FIRST’: [h_center, w_center, box_height, box_width]
‘CENTER_SIZE_WIDTH_FIRST’: [w_center, h_center, box_width, box_height]</p>
</dd>
<dt><strong>spatial_scale: float</strong></dt><dd><p>Additional spatial scale that multiplies the bounding box coordinates.
Generally used while implementing the RoI Align layer,
which uses unnormalized RoI coordinates along with a spatial scale less than or equal to 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_resize_bilinear</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cumsum">
<code class="sig-name descname"><span class="pre">add_cumsum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a cum sum layer to the model computes the cumulative sum values of the input along a given axis.
Refer to the <strong>CumSumLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>Axis to perform the operation, default: -1.</p>
</dd>
<dt><strong>reverse: bool, optional</strong></dt><dd><p>if true, cumsum is performed in the opposite direction, default: False.</p>
</dd>
<dt><strong>exclusive: bool, optional</strong></dt><dd><p>whether to perform exclusive or inclusive cumulative summation, default: False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom">
<code class="sig-name descname"><span class="pre">add_custom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_proto_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a custom layer.
Refer to the <strong>CustomLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names to this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names from this layer.</p>
</dd>
<dt><strong>custom_proto_spec: CustomLayerParams</strong></dt><dd><p>A protobuf CustomLayerParams message. This can also be left blank and filled in later.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable">
<code class="sig-name descname"><span class="pre">add_divide_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a divide_broadcastable layer to the model that performs element-wise
division operation with broadcast support.
Refer to the <strong>DivideBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise">
<code class="sig-name descname"><span class="pre">add_elementwise</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an element-wise operation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>A list of input blob names of this layer. The input blobs should have the same shape.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>A string specifying the mode of the elementwise layer. It can be one of the following:</p>
<ul class="simple">
<li><p>‘CONCAT’: concatenate input blobs along the channel axis.</p></li>
<li><p>‘SEQUENCE_CONCAT’: concatenate input blobs along the sequence axis.</p></li>
<li><p>‘ADD’: perform an element-wise summation over the input blobs.</p></li>
<li><p>‘MULTIPLY’: perform an element-wise multiplication over the input blobs.</p></li>
<li><p>‘DOT’: compute the dot product of the two input blobs. In this mode, the length of input_names should be 2.</p></li>
<li><p>‘COS’: compute the cosine similarity of the two input blobs. In this mode, the length of input_names should be 2.</p></li>
<li><p>‘MAX’: compute the element-wise maximum over the input blobs.</p></li>
<li><p>‘MIN’: compute the element-wise minimum over the input blobs.</p></li>
<li><p>‘AVE’: compute the element-wise average over the input blobs.</p></li>
</ul>
</dd>
<dt><strong>alpha: float</strong></dt><dd><p>if mode == ‘ADD’ and there is only one input_name, alpha is added to the input
if mode == ‘MULTIPLY’ and there is only one input_name, alpha is multiplied to the input</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sequence_repeat</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding">
<code class="sig-name descname"><span class="pre">add_embedding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an embedding layer to the model.
Refer to the <strong>EmbeddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape (output_channels, input_dim).
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Bias vector of shape (output_channels, ).</p>
</dd>
<dt><strong>input_dim: int</strong></dt><dd><p>Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the spec.</p>
<ul class="simple">
<li><p>If True, the bias vector of this layer is not ignored.</p></li>
<li><p>If False, the bias vector is ignored.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments expected, when W is of type bytes():</strong></dt><dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt><dd><p>Set it to true when W is of type bytes(), representing quantized weights</p>
</dd>
<dt><strong>quantization_type: str</strong></dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt><strong>nbits: int</strong></dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd">
<code class="sig-name descname"><span class="pre">add_embedding_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an embedding layer to the model that performs a matrix lookup and
optionally adds a bias.
Refer to the <strong>EmbeddingNDLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>vocab_size: int</strong></dt><dd><p>Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>embedding_size: int</strong></dt><dd><p>Size of the embedded vector.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape (embedding_size, vocab_size).
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array , optional</strong></dt><dd><p>Bias vector of shape (embedding_size, ).</p>
</dd>
<dt><strong>Quantization arguments expected, when W is of type bytes():</strong></dt><dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt><dd><p>Set it to true when W is of type bytes(), representing quantized weights</p>
</dd>
<dt><strong>quantization_type: str</strong></dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt><strong>nbits: int</strong></dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal">
<code class="sig-name descname"><span class="pre">add_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an equal layer to the model that performs the element-wise equal
(=) operation. Broadcasting is supported.
Refer to the <strong>EqualLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf">
<code class="sig-name descname"><span class="pre">add_erf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an erf function (gaussian error function) layer to the model.
Refer to the <strong>ErfLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2">
<code class="sig-name descname"><span class="pre">add_exp2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an exp2 layer to the model that performs element-wise experiential operation.
Refer to the <strong>Exp2LayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims">
<code class="sig-name descname"><span class="pre">add_expand_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an expand dims layer to the model that increases the rank of the
input tensor by adding unit dimensions.
Refer to the <strong>ExpandDimsLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt><dd><p>Dimensions the operation perform on.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_squeeze</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic">
<code class="sig-name descname"><span class="pre">add_fill_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_dynamic layer to the model that outputs a tensor filled
with a scalar value.
Refer to the <strong>FillDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like">
<code class="sig-name descname"><span class="pre">add_fill_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_like layer to the model outputs a tensor filled with a
scalar value.
Refer to the <strong>FillLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static">
<code class="sig-name descname"><span class="pre">add_fill_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_static layer to the model that outputs a tensor filled
with a scalar value given shape as parameter.
Refer to the <strong>FillStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>The target shape of the output tensor.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten">
<code class="sig-name descname"><span class="pre">add_flatten</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a flatten layer. Only flattens the channel, height and width axis. Leaves the sequence axis as is.
Refer to the <strong>FlattenLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>mode: int</strong></dt><dd><ul class="simple">
<li><p>If mode == 0, the flatten layer is in CHANNEL_FIRST mode.</p></li>
<li><p>If mode == 1, the flatten layer is in CHANNEL_LAST mode.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d">
<code class="sig-name descname"><span class="pre">add_flatten_to_2d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a flatten_to_2d layer to the model that flattens the input tensor
into a 2-dimensional matrix.
Refer to the <strong>FlattenTo2DLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>Axis to perform the operation, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor">
<code class="sig-name descname"><span class="pre">add_floor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a floor layer to the model that performs element-wise floor operation
on the input tensor that rounds the value to the largest integer not
greater than x.
Refer to the <strong>FloorLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable">
<code class="sig-name descname"><span class="pre">add_floor_div_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a floor_div_broadcastable layer to the model that performs floor
division operation with broadcast support.
Refer to the <strong>FloorDivBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_divide_broadcastable</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather">
<code class="sig-name descname"><span class="pre">add_gather</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input.
Refer to the <strong>GatherLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis">
<code class="sig-name descname"><span class="pre">add_gather_along_axis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather_along_axis layer to the model that gathers elements or slices
from data and store to a tensor whose shape is defined by indices from the
input along the given axis into the output tensor.
Refer to the <strong>GatherAlongAxisLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd">
<code class="sig-name descname"><span class="pre">add_gather_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input. This is the reverse operation of the scatter operation.
Refer to the <strong>GatherNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu">
<code class="sig-name descname"><span class="pre">add_gelu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EXACT'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a GELU (gaussian error linear unit) activation layer, which is:
<code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">erf(x</span> <span class="pre">/</span> <span class="pre">sqrt(2)))</span></code>.
Refer to the <strong>GeluLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Gelu mode in [EXACT | TANH_APPROXIMATION | SIGMOID_APPROXIMATION], default EXACT.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape">
<code class="sig-name descname"><span class="pre">add_get_shape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a get_shape layer to the model.
Refer to the <strong>GetShapeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d">
<code class="sig-name descname"><span class="pre">add_global_pooling3d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a layer to pool three spatial dimensions down to one value.
This behaves like a special case of Pooling3DLayerParams in which
the Kernel is the size of the input and there is no padding.
Refer to the <strong>GlobalPooling3DLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>pooling_type: str</strong></dt><dd><p>Type of pooling performed. Can either be ‘MAX’ OR ‘AVERAGE’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling3d</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than">
<code class="sig-name descname"><span class="pre">add_greater_than</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_greater_than_equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a greater_than layer to the model that performs the element-wise
greater-than (&gt;) operation or greater-than-or-equal-to (&gt;=) operation.
Broadcasting is supported.
Refer to the <strong>GreaterThanLayerParams</strong>, <strong>GreaterEqualLayerParams</strong> messages
in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>use_greater_than_equal: bool, optional</strong></dt><dd><p>Whether or not to allow greater than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru">
<code class="sig-name descname"><span class="pre">add_gru</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID_HARD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Gated-Recurrent Unit (GRU) layer to the model.
Refer to the <strong>GRULayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices. The ordering is [R_z, R_r, R_o],
where R_z, R_r and R_o are weight matrices at update gate, reset gate and output gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices. The ordering is [W_z, W_r, W_o],
where W_z, W_r, and W_o are weight matrices at update gate, reset gate and output gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt><dd><p>List of biases of the GRU layer. The ordering is [b_z, b_r, b_o],
where b_z, b_r, b_o are biases at update gate, reset gate and output gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at update and reset gates. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘SIGMOID_HARD’.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of [x, h_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of [y, h_output].</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the recurrent layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product">
<code class="sig-name descname"><span class="pre">add_inner_product</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_8_dynamic_quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an inner product layer to the model.
Refer to the <strong>InnerProductLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape (output_channels, input_channels)
If W is of type bytes(), i.e. quantized, other quantization related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Bias vector of shape (output_channels, ).</p>
</dd>
<dt><strong>input_channels: int</strong></dt><dd><p>Number of input channels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the spec.</p>
<ul class="simple">
<li><p>If True, the bias vector of this layer is not ignored.</p></li>
<li><p>If False, the bias vector is ignored.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments, used when W is of type bytes():</strong></dt><dd><dl class="simple">
<dt>int_8_dynamic_quantize: boolean</dt><dd><p>Whether to quantize and dequantize before and after inner product, respectively.
Expects byte weights, representing int8 values, if True. See NeuralNetwork.proto for other validation conditions.</p>
</dd>
<dt>is_quantized_weight: bool, optional</dt><dd><p>Set it to true when W is of type bytes(), representing quantized weights, default: false.</p>
</dd>
<dt>quantization_type: str</dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt>nbits: int</dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value. Only applicable when
weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt><dd><p>the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batched_mat_mul</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize">
<code class="sig-name descname"><span class="pre">add_l2_normalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Add L2 normalize layer. Normalizes the input by the L2 norm, i.e. divides by the
the square root of the sum of squares of all elements of the input along C, H and W dimensions.
Refer to the <strong>L2NormalizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to avoid division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization">
<code class="sig-name descname"><span class="pre">add_layer_normalization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a layer normalization layer to the model that applies layer
normalization over the input tensor.
Refer to the <strong>LayerNormalizationLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>normalized_shape: list of int or tuple of int</strong></dt><dd><p>Input shape from an expected input of size.</p>
</dd>
<dt><strong>gamma: WeightParams</strong></dt><dd><p>Weight parameters.</p>
</dd>
<dt><strong>beta: WeightParams</strong></dt><dd><p>Bias parameters.</p>
</dd>
<dt><strong>eps: float, optional</strong></dt><dd><p>Constant value added to the denominator, default: 1e-5.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than">
<code class="sig-name descname"><span class="pre">add_less_than</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_less_than_equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a less_than layer to the model that performs the element-wise
less-than (&lt;) operation or less-than-or-equal-to (&lt;=) operation.
Broadcasting is supported.
Refer to the <strong>LessThanL_ayerParams</strong>, <strong>LessEqualLayerParams</strong> messages in
specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>use_less_than_equal: bool, optional</strong></dt><dd><p>Whether or not to allow less than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant">
<code class="sig-name descname"><span class="pre">add_load_constant</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a load constant layer.
Refer to the <strong>LoadConstantLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array</strong></dt><dd><p>value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt><dd><p>List of ints representing the shape of the constant. Must be of length 3: [C,H,W]</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd">
<code class="sig-name descname"><span class="pre">add_load_constant_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a load_constant layer that loads data as a parameter and provides it
as an output.
Refer to the <strong>LoadConstantNDLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array()</strong></dt><dd><p>value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt><dd><p>List of ints representing the shape of the constant.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical">
<code class="sig-name descname"><span class="pre">add_logical</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a logical layer to the model that performs element-wise logical
and/or/xor/not operation. Broadcasting is supported.
Refer to the <strong>LogicalOrLayerParams, LogicalNotLayerParams,
LogicalNotLayerParams, LogicalAndLayerParam</strong> messages in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Logical operation mode in [AND | OR | XOR | NOT].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop">
<code class="sig-name descname"><span class="pre">add_loop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop layer to the model that provides the functionality of a <code class="docutils literal notranslate"><span class="pre">for</span></code>
loop, or a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop.
Refer to the <strong>LoopLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>body_network: NeuralNetwork</strong></dt><dd><p>Neural network to execute for the body of the loop.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>condition: str, optional</strong></dt><dd><p>Condition of the loop.</p>
</dd>
<dt><strong>condition_network: NeuralNetwork, optional</strong></dt><dd><p>Neural network to execute for the condition of the loop.</p>
</dd>
<dt><strong>max_iterations: int, optional</strong></dt><dd><p>Maximum number of iterations of the loop.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break">
<code class="sig-name descname"><span class="pre">add_loop_break</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop_break layer to the model that terminates the loop that
contains this layer. Must reside in the <code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <strong>LoopBreakLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue">
<code class="sig-name descname"><span class="pre">add_loop_continue</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop_continue layer to the model that stops the current loop
iteration and continue on the next iteration. Must reside in the
<code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <strong>LoopContinueLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular">
<code class="sig-name descname"><span class="pre">add_lower_triangular</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a lower_triangular layer to the model that copies a tensor setting
everything outside lower triangular to zero.
Refer to the <strong>LowerTriangularLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>Diagonal below which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upper_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn">
<code class="sig-name descname"><span class="pre">add_lrn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a LRN (local response normalization) layer. Supports “across” channels normalization.
Refer to the <strong>LRNLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float</strong></dt><dd><p>multiplicative constant in the denominator.</p>
</dd>
<dt><strong>beta: float</strong></dt><dd><p>exponent of the normalizing term in the denominator.</p>
</dd>
<dt><strong>k: float</strong></dt><dd><p>bias term in the denominator. Must be positive.</p>
</dd>
<dt><strong>local_size: int</strong></dt><dd><p>size of the neighborhood along the channel axis.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part">
<code class="sig-name descname"><span class="pre">add_matrix_band_part</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a matrix_band_part layer to the model that copies a tensor setting
everything outside a central band in each inner-most matrix to zero.
Refer to the <strong>MatrixBandPartLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>num_lower: int, optional</strong></dt><dd><p>Number of lower sub-diagonals to keep.
Default: -1 (keep entire lower triangle).</p>
</dd>
<dt><strong>num_upper: int, optional</strong></dt><dd><p>Number of upper sub-diagonals to keep.
Default: -1 (keep entire upper triangle).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable">
<code class="sig-name descname"><span class="pre">add_max_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a max_broadcastable layer to the model that performs element-wise
maximum operation with broadcast support.
Refer to the <strong>MaxBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable">
<code class="sig-name descname"><span class="pre">add_min_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a min_broadcastable layer to the model that performs element-wise
minimum operation with broadcast support.
Refer to the <strong>MinBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable">
<code class="sig-name descname"><span class="pre">add_mod_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a mod_broadcastable layer to the model that performs element-wise
modular operation with broadcast support.
Refer to the <strong>ModBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable">
<code class="sig-name descname"><span class="pre">add_multiply_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a multiply_broadcastable layer to the model that performs element-wise
multiplication operation with broadcast support.
Refer to the <strong>MultiplyBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn">
<code class="sig-name descname"><span class="pre">add_mvn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an MVN (mean variance normalization) layer. Computes mean, variance and normalizes the input.
Refer to the <strong>MeanVarianceNormalizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>across_channels: boolean</strong></dt><dd><p>If False, each channel plane is normalized separately
If True, mean/variance is computed across all C, H and W dimensions</p>
</dd>
<dt><strong>normalize_variance: boolean</strong></dt><dd><p>If False, only mean subtraction is performed.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to avoid division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms">
<code class="sig-name descname"><span class="pre">add_nms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_class_suppression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a non maximum suppression layer.
Refer to the <strong>NonMaximumSuppressionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. Must be at least 2, and maximum 5.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer. Must be of length 4 exactly.</p>
</dd>
<dt><strong>iou_threshold: float</strong></dt><dd><p>intersection over union threshold for suppression. Ignored if 3rd input is present.</p>
</dd>
<dt><strong>score_threshold: float</strong></dt><dd><p>threshold for selecting boxes to be used for NMS algorithm. Ignored if 4th input is present.</p>
</dd>
<dt><strong>max_boxes: int</strong></dt><dd><p>maximum number of boxes to output. Ignored if 5th input is present.</p>
</dd>
<dt><strong>per_class_suppression: bool</strong></dt><dd><p>If true, boxes are organized into classes and suppression is applied to each class group separately</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal">
<code class="sig-name descname"><span class="pre">add_not_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a not_equal layer to the model that performs the element-wise not
equal (!=) operation. Broadcasting is supported.
Refer to the <strong>NotEqualLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_one_hot">
<code class="sig-name descname"><span class="pre">add_one_hot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_hot_vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">off_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a one hot layer to the model that computes the one hot representation of the input tensor.
Refer to the <strong>OneHotLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>one_hot_vector_size:  int &gt; 0</strong></dt><dd><p>size of the one hot vector.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>refers to the axis in the output tensor, default: -1.</p>
</dd>
<dt><strong>on_value: float, optional</strong></dt><dd><p>Constant value on locations represented by first input, default: 1.0.</p>
</dd>
<dt><strong>off_value: float, optional</strong></dt><dd><p>Constant value at all other locations, default: 0.0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals">
<code class="sig-name descname"><span class="pre">add_optionals</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optionals_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionals_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals" title="Permalink to this definition">¶</a></dt>
<dd><p>Add optional inputs and outputs to the model spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>optionals_in: list of str</strong></dt><dd><p>List of inputs that are optionals.</p>
</dd>
<dt><strong>optionals_out: list of str</strong></dt><dd><p>List of outputs that are optionals.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding">
<code class="sig-name descname"><span class="pre">add_padding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a padding layer to the model that performs padding along spatial dimensions.
Refer to the <strong>PaddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt><dd><p>Number of elements to be padded on the left side of the input blob.</p>
</dd>
<dt><strong>right: int</strong></dt><dd><p>Number of elements to be padded on the right side of the input blob.</p>
</dd>
<dt><strong>top: int</strong></dt><dd><p>Number of elements to be padded on the top of the input blob.</p>
</dd>
<dt><strong>bottom: int</strong></dt><dd><p>Number of elements to be padded on the bottom of the input blob.</p>
</dd>
<dt><strong>value: float</strong></dt><dd><p>Value of the elements padded. Used only when padding_type = ‘constant’</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>padding_type: str</strong></dt><dd><p>Type of the padding. Can be one of ‘constant’, ‘reflection’ or ‘replication’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute">
<code class="sig-name descname"><span class="pre">add_permute</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a permute layer. Assumes that the input has dimensions in the order [Seq, C, H, W]
Refer to the <strong>PermuteLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>dim: tuple</strong></dt><dd><p>The order in which to permute the input dimensions = [seq,C,H,W].
Must have length 4 and a permutation of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>.</p>
<p>examples:</p>
<p>Lets say input has shape: [seq, C, H, W].</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>,
then the output has shape <code class="docutils literal notranslate"><span class="pre">[W,C,H]</span></code>
and has the same sequence length that of the input.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">0]</span></code>,
and the input is a sequence of data
with length <code class="docutils literal notranslate"><span class="pre">Seq</span></code> and shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>,
then the output is a unit sequence of data with shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">Seq]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">2,</span> <span class="pre">1]</span></code>,
the output is a reverse of the input: <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">H,</span> <span class="pre">W]</span> <span class="pre">-&gt;</span> <span class="pre">[W,</span> <span class="pre">H,</span> <span class="pre">C]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is not set, or is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>,
the output is the same as the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling">
<code class="sig-name descname"><span class="pre">add_pooling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_pad_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_global</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_padding_asymmetry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pooling layer to the model that performs spatial pooling.
Refer to the <strong>PoolingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of pooling region.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of pooling region.</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the width direction.</p>
</dd>
<dt><strong>layer_type: str</strong></dt><dd><p>Type of pooling performed. Can either be ‘MAX’, ‘AVERAGE’ or ‘L2’.</p>
</dd>
<dt><strong>padding_type: str</strong></dt><dd><p>Option for the type of padding and output blob shape. Can be either ‘VALID’ , ‘SAME’ or ‘INCLUDE_LAST_PIXEL’.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>exclude_pad_area: boolean</strong></dt><dd><p>Whether to exclude padded area in the ‘AVERAGE’ pooling operation, default: true.
- If True, the value of the padded area will be excluded.
- If False, the padded area will be included.
This flag is only used with average pooling.</p>
</dd>
<dt><strong>is_global: boolean</strong></dt><dd><p>Whether the pooling operation is global. Defaults to False.
- If True, the pooling operation is global – the pooling region is of the same size of the input blob.
Parameters height, width, stride_height, stride_width will be ignored.
- If False, the pooling operation is not global.</p>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>values of height (top, bottom) and width (left, right) padding to be used if padding type is “VALID” or “INCLUDE_LAST_PIXEL”.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str.</strong></dt><dd><p>Type of asymmetric padding to be used when padding_type = ‘SAME’.
Can be either ‘BOTTOM_RIGHT_HEAVY’ or ‘TOP_LEFT_HEAVY’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling3d</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d">
<code class="sig-name descname"><span class="pre">add_pooling3d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_pooling_count_excludes_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pooling layer to the model that performs spatial pooling across three dimensions.
Refer to the <strong>Pooling3DLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>pooling_type: str</strong></dt><dd><p>Type of pooling performed. Can either be ‘MAX’ OR ‘AVERAGE’.</p>
</dd>
<dt><strong>kernel_depth: int</strong></dt><dd><p>Depth of the pooling region.</p>
</dd>
<dt><strong>kernel_height: int</strong></dt><dd><p>Height of pooling region.</p>
</dd>
<dt><strong>kernel_width: int</strong></dt><dd><p>Width of pooling region.</p>
</dd>
<dt><strong>stride_depth: int</strong></dt><dd><p>Stride along the depth direction</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the width direction.</p>
</dd>
<dt><strong>padding_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape.
Can be ‘VALID’, ‘SAME’, or ‘CUSTOM’.</p>
</dd>
<dt><strong>custom_padding_front: int</strong></dt><dd><p>Padding before the input in the depth direction.</p>
</dd>
<dt><strong>custom_padding_back: int</strong></dt><dd><p>Padding after the input in the depth direction.</p>
</dd>
<dt><strong>custom_padding_top: int</strong></dt><dd><p>Padding before the input in the height direction.</p>
</dd>
<dt><strong>custom_padding_bottom: int</strong></dt><dd><p>Padding after the input in the height direction.</p>
</dd>
<dt><strong>custom_padding_left: int</strong></dt><dd><p>Padding before the input in the width direction.</p>
</dd>
<dt><strong>custom_padding_right: int</strong></dt><dd><p>Padding after the input in the width direction.</p>
</dd>
<dt><strong>average_pooling_count_excludes_padding: boolean</strong></dt><dd><p>If true, exclude zeros from padding in average pooling.  Can only be true for AVERAGE padding.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_global_pooling3d</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable">
<code class="sig-name descname"><span class="pre">add_pow_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pow_broadcastable layer to the model that performs element-wise
power operation with broadcast support.
Refer to the <strong>PowBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic">
<code class="sig-name descname"><span class="pre">add_random_bernoulli_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_dynamic layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like">
<code class="sig-name descname"><span class="pre">add_random_bernoulli_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_like layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static">
<code class="sig-name descname"><span class="pre">add_random_bernoulli_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_static layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic">
<code class="sig-name descname"><span class="pre">add_random_normal_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_dynamic layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormalDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like">
<code class="sig-name descname"><span class="pre">add_random_normal_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_like layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormalLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution, default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static">
<code class="sig-name descname"><span class="pre">add_random_normal_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_static layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormaStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic">
<code class="sig-name descname"><span class="pre">add_random_uniform_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_dynamic layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like">
<code class="sig-name descname"><span class="pre">add_random_uniform_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_like layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static">
<code class="sig-name descname"><span class="pre">add_random_uniform_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_static layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic">
<code class="sig-name descname"><span class="pre">add_range_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a range_dynamic layer that returns a tensor that contains evenly spaced values.
This layer has up to three inputs or no input and three parameters.
Refer to the <strong>RangeDynamicLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names.
If input size == 1: end is input, start and step are read from parameters
If input size == 2: end, start are inputs, step is read from parameters
If input size == 3: start, end, step are all inputs, none of the parameters are used.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>start: int, optional</strong></dt><dd><p>Range parameter: start. Ignored if start is provided as input, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>Range parameter: step. Ignored if step is provided as input, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static">
<code class="sig-name descname"><span class="pre">add_range_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a range_static layer that returns a tensor that contains evenly spaced values.
This layer has no input and three parameters.
Refer to the <strong>RangeStaticLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>end: int, optional</strong></dt><dd><p>Range parameter: end, default: 1.</p>
</dd>
<dt><strong>start: int, optional</strong></dt><dd><p>Range parameter: start, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>Range parameter: step size, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape">
<code class="sig-name descname"><span class="pre">add_rank_preserving_reshape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rank_preserving_reshape layer to the model that reshapes the input
tensor without altering the rank of the tensor.
Refer to the <strong>RankPreservingReshapeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Determines the shape of the output blob.
0: copy the dimension of the input to output
-1: calculate dimensions from the rest of the shape</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce">
<code class="sig-name descname"><span class="pre">add_reduce</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce layer. Applies the function specified by the parameter mode,
along dimension(s) specified by the parameter axis.
Refer to the <strong>ReduceLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt><dd><p>dimensions along which the reduction operation is applied.
Allowed values: ‘CHW’, ‘HW’, ‘C’, ‘H’, ‘W’</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Reduction operation to be applied.
Allowed values:
‘sum’, ‘avg’, ‘prod’, ‘logsum’, ‘sumsquare’, ‘L1’, ‘L2’, ‘max’, ‘min’, ‘argmax’.
‘argmax’ is only supported with axis values ‘C’, ‘H’ and ‘W’.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>number that is added to the input when ‘logsum’ function is applied.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1">
<code class="sig-name descname"><span class="pre">add_reduce_l1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_l1 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l1_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceL1LayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2">
<code class="sig-name descname"><span class="pre">add_reduce_l2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_l2 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l2_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceL2LayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum">
<code class="sig-name descname"><span class="pre">add_reduce_logsum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_logsum layer to the model that reduces the input tensor
using log(sum(elements across given dimensions)).
Refer to the <strong>ReduceLogSumLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp">
<code class="sig-name descname"><span class="pre">add_reduce_logsumexp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_logsumexp layer to the model that computes <code class="docutils literal notranslate"><span class="pre">log(sum(exp(tensor)))</span></code>
and reduces along the given axis.
Refer to the <strong>ReduceLogSumExpLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max">
<code class="sig-name descname"><span class="pre">add_reduce_max</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_max layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">max(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMaxLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean">
<code class="sig-name descname"><span class="pre">add_reduce_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_mean layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">mean(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMeanLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min">
<code class="sig-name descname"><span class="pre">add_reduce_min</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_min layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">min(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMinLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod">
<code class="sig-name descname"><span class="pre">add_reduce_prod</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_prod layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">prod(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceProdLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes. If axes list is empty, it will
be set to true, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum">
<code class="sig-name descname"><span class="pre">add_reduce_sum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_sum layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceSumLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare">
<code class="sig-name descname"><span class="pre">add_reduce_sumsquare</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_sumsquare layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(square(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions))</span></code>.
Refer to the <strong>ReduceSumSquareLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data">
<code class="sig-name descname"><span class="pre">add_reorganize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPACE_TO_DEPTH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a data reorganization layer of type “SPACE_TO_DEPTH” or “DEPTH_TO_SPACE”.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><ul class="simple">
<li><p>If mode == ‘SPACE_TO_DEPTH’: data is moved from the spatial to the channel dimension.
Input is spatially divided into non-overlapping blocks of size block_size X block_size
and data from each block is moved to the channel dimension.
Output CHW dimensions are: [C * block_size * block_size, H/block_size, C/block_size].</p></li>
<li><p>If mode == ‘DEPTH_TO_SPACE’: data is moved from the channel to the spatial dimension.
Reverse of the operation ‘SPACE_TO_DEPTH’.
Output CHW dimensions are: [C/(block_size * block_size), H * block_size, C * block_size].</p></li>
<li><p>If mode == ‘PIXEL_SHUFFLE’:  data is moved from the channel to the spatial dimension.
Reverse of the operation ‘SPACE_TO_DEPTH’.
Output CHW dimensions are: [C/(block_size * block_size), H * block_size, C * block_size].</p></li>
</ul>
</dd>
<dt><strong>block_size: int</strong></dt><dd><p>Must be greater than 1. Must divide H and W, when mode is ‘SPACE_TO_DEPTH’. (block_size * block_size)
must divide C when mode is ‘DEPTH_TO_SPACE’ or ‘PIXEL_SHUFFLE’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape">
<code class="sig-name descname"><span class="pre">add_reshape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape layer.
Refer to the <strong>ReshapeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>target_shape: tuple</strong></dt><dd><p>Shape of the output blob. The product of target_shape must be equal
to the shape of the input blob.
Can be either length 3 (C,H,W) or length 4 (Seq,C,H,W).</p>
</dd>
<dt><strong>mode: int</strong></dt><dd><ul class="simple">
<li><p>If mode == 0, the reshape layer is in CHANNEL_FIRST mode.</p></li>
<li><p>If mode == 1, the reshape layer is in CHANNEL_LAST mode.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic">
<code class="sig-name descname"><span class="pre">add_reshape_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_dynamic layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like">
<code class="sig-name descname"><span class="pre">add_reshape_like</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_like layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static">
<code class="sig-name descname"><span class="pre">add_reshape_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_static layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear">
<code class="sig-name descname"><span class="pre">add_resize_bilinear</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ALIGN_ENDPOINTS_MODE'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a resize bilinear layer to the model. A layer that resize the input to a given spatial size using bilinear interpolation.
Refer to the <strong>ResizeBilinearLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt><dd><p>Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt><dd><p>Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Following values are supported: ‘STRICT_ALIGN_ENDPOINTS_MODE’, ‘ALIGN_ENDPOINTS_MODE’, ‘UPSAMPLE_MODE’, ‘ROI_ALIGN_MODE’.
This parameter determines the sampling grid used for bilinear interpolation.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse">
<code class="sig-name descname"><span class="pre">add_reverse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reverse layer to the model that reverses specific dimensions of
the input tensor.
Refer to the <strong>ReverseLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>reverse_dim: list of int or tuple of int</strong></dt><dd><p>Reverse along the dimension, default [1].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse_sequence</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence">
<code class="sig-name descname"><span class="pre">add_reverse_sequence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reverse sequence layer to the model that reverses variable length slices.
Refer to the <strong>ReverseSeqLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>batch_axis: int, optional</strong></dt><dd><p>Slices input along the dimension batch_axis, default 0.</p>
</dd>
<dt><strong>seq_axis: int, optional</strong></dt><dd><p>Reverse along the dimension seq_axis, default: -1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round">
<code class="sig-name descname"><span class="pre">add_round</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a round layer to the model that performs element-wise round operation
on the input tensor that rounds the value to the nearest integer.
Refer to the <strong>RoundLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale">
<code class="sig-name descname"><span class="pre">add_scale</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scale layer to the model.
Refer to the <strong>ScaleLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: int or numpy.array</strong></dt><dd><p>Scale of the input.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt><dd><p>Bias to add to the input.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the spec.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>shape_scale: list of int or tuple of int</strong></dt><dd><p>List of ints that specifies the shape of the scale parameter. Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt><dd><p>List of ints that specifies the shape of the bias parameter (if present). Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bias</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter">
<code class="sig-name descname"><span class="pre">add_scatter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from the input.
Refer to the <strong>ScatterLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis">
<code class="sig-name descname"><span class="pre">add_scatter_along_axis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter_along_axis layer to the model that scatters data into a new
tensor according to indices from the input along the given axis into the
output tensor.
Refer to the <strong>ScatterAlongAxisLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>The axis to perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd">
<code class="sig-name descname"><span class="pre">add_scatter_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from input. This is the reverse operation of the
gather operation.
Refer to the <strong>ScatterNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat">
<code class="sig-name descname"><span class="pre">add_sequence_repeat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sequence repeat layer to the model.
Refer to the <strong>SequenceRepeatLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>nrep: int</strong></dt><dd><p>Number of repetitions of the input blob along the sequence axis.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign">
<code class="sig-name descname"><span class="pre">add_sign</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sign layer to the model that performs element-wise sign operation
(+1 for positive values, -1 for negative values, 0 for zeroes).
Refer to the <strong>SignLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn">
<code class="sig-name descname"><span class="pre">add_simple_rnn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a simple recurrent layer to the model.
Refer to the <strong>SimpleRecurrentLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: numpy.array</strong></dt><dd><p>Weights of the recurrent layer’s hidden state. Must be of shape (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: numpy.array</strong></dt><dd><p>Weights of the recurrent layer’s input. Must be of shape (hidden_size, input_size).</p>
</dd>
<dt><strong>b: numpy.array or None</strong></dt><dd><p>Bias of the recurrent layer’s output. If None, bias is ignored. Otherwise it must be of shape (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt><dd><p>Activation function name. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of [x, h_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of [y, h_output].</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the recurrent layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin">
<code class="sig-name descname"><span class="pre">add_sin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sin layer to the model that computes element-wise sine for the
input tensor.
Refer to the <strong>SinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh">
<code class="sig-name descname"><span class="pre">add_sinh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sinh layer to the model that computes element-wise hyperbolic sine for the input tensor.
Refer to the <strong>SinhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice">
<code class="sig-name descname"><span class="pre">add_slice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice layer. Equivalent to to numpy slice [start_index:end_index:stride],
start_index is included, while end_index is exclusive.
Refer to the <strong>SliceLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt><dd><p>axis along which input is sliced.
allowed values: ‘channel’, ‘height’, ‘width’</p>
</dd>
<dt><strong>start_index: int</strong></dt><dd><p>must be non-negative.</p>
</dd>
<dt><strong>end_index: int</strong></dt><dd><p>negative indexing is supported.</p>
</dd>
<dt><strong>stride: int</strong></dt><dd><p>must be positive.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_by_size">
<code class="sig-name descname"><span class="pre">add_slice_by_size</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_by_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice layer. Equivalent to to numpy slice [start_index: start_index+size],
Input is list of str which is [input_tensor, begin_id].</p>
<p>Assume input_tensor has shape (2, 3, 4), and axis=1, size=2.
This would produce input_tensor[:, begin_id:begin_id+2, :]</p>
<p>Refer to the <strong>SliceBySizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which input is sliced.</p>
</dd>
<dt><strong>size: int</strong></dt><dd><p>The size of which input will be taken</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic">
<code class="sig-name descname"><span class="pre">add_slice_dynamic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice_dynamic layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <strong>SliceDynamicLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int, optional</strong></dt><dd><p>End offsets for slice layer, default: [1].</p>
</dd>
<dt><strong>strides: list of int or tuple of int, optional</strong></dt><dd><p>Strides for slice layer, default: [1].</p>
</dd>
<dt><strong>begin_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for begin offsets, default: [false].</p>
</dd>
<dt><strong>end_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for end offsets, default: [false].</p>
</dd>
<dt><strong>squeeze_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for squeezing axis, default: [false].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static">
<code class="sig-name descname"><span class="pre">add_slice_static</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice_static layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <strong>SliceStaticLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>begin_ids: list of int or tuple of int</strong></dt><dd><p>Begin offsets for slice layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int</strong></dt><dd><p>End offsets for slice layer.</p>
</dd>
<dt><strong>strides: list of int or tuple of int</strong></dt><dd><p>Strides for slice layer.</p>
</dd>
<dt><strong>begin_masks: list of bool</strong></dt><dd><p>Boolean masks for begin offsets.</p>
</dd>
<dt><strong>end_masks: list of bool</strong></dt><dd><p>Boolean masks for end offsets.</p>
</dd>
<dt><strong>squeeze_masks: list of bool</strong></dt><dd><p>Boolean masks for squeezing axis.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows">
<code class="sig-name descname"><span class="pre">add_sliding_windows</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sliding_windows layer to the model that returns a tensor containing
all windows of size <code class="docutils literal notranslate"><span class="pre">window_size</span></code> * separated by <code class="docutils literal notranslate"><span class="pre">step</span></code> along the dimension <code class="docutils literal notranslate"><span class="pre">axis</span></code>.
Refer to the <strong>SlidingWindowsLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the operation.</p>
</dd>
<dt><strong>window_size: int</strong></dt><dd><p>Number of elements in the sliding window.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>The stride of the input elements in the sliding window, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax">
<code class="sig-name descname"><span class="pre">add_softmax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a softmax layer to the model.
Refer to the <strong>SoftmaxLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd">
<code class="sig-name descname"><span class="pre">add_softmax_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a softmax_nd layer to the model that performs softmax operation along
the given axis.
Refer to the <strong>SoftmaxNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the softmax operation on.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split">
<code class="sig-name descname"><span class="pre">add_split</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a split layer that uniformly splits the input along the channel dimension
to produce multiple outputs.
Refer to the <strong>SplitLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>List of output blob names of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd">
<code class="sig-name descname"><span class="pre">add_split_nd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a split layer to the model that splits the input tensor into multiple
output tensors. Either uniformly split the input tensor into <code class="docutils literal notranslate"><span class="pre">num_splits</span></code>
tensors, or split into given size list <code class="docutils literal notranslate"><span class="pre">split_sizes</span></code> output tensors.
Refer to the <strong>SplitNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform split on.</p>
</dd>
<dt><strong>num_splits: int, optional</strong></dt><dd><p>Number of splits, default: 2.</p>
</dd>
<dt><strong>split_sizes: list of int or tuple of int, optional</strong></dt><dd><p>List of size to split, default [] or None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze">
<code class="sig-name descname"><span class="pre">add_squeeze</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a squeeze layer to the model that decrease the rank of the input
tensor by removing unit dimensions.
Refer to the <strong>SqueezeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>Dimensions to perform the operation, default: None (squeeze_all).</p>
</dd>
<dt><strong>squeeze_all: bool, optional</strong></dt><dd><p>If true, all dimensions that are 1 are squeezed, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_expand_dims</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack">
<code class="sig-name descname"><span class="pre">add_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a stack layer to the model that performs stack operation on a list of
tensors into one rank+1 tensor on the given axis.
Refer to the <strong>StackLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis to perform stack operation, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable">
<code class="sig-name descname"><span class="pre">add_subtract_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a subtract_broadcastable layer to the model that performs element-wise
subtraction operation with broadcast support.
Refer to the <strong>SubtractBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan">
<code class="sig-name descname"><span class="pre">add_tan</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tan layer to the model that computes element-wise tangent for the
input tensor.
Refer to the <strong>TanLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh">
<code class="sig-name descname"><span class="pre">add_tanh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tanh layer to the model that computes element-wise hyperbolic
tangent for the input tensor.
Refer to the <strong>TanhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile">
<code class="sig-name descname"><span class="pre">add_tile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tile layer to the model that construct a tensor by repeating the
input tensor multiple number of times.
Refer to the <strong>TileLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str or list[str]</strong></dt><dd><p>The input blob name of this layer.
If second input is provided, reps parameter is ignored.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>reps: list of int or tuple of int</strong></dt><dd><p>Number of times to replicate.
If <cite>input_name</cite> provides two inputs, second input is used as
reps and this parameter is ignored.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_stack</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_concat_nd</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk">
<code class="sig-name descname"><span class="pre">add_topk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a topk layer to the model that returns top or bottom k values and
the corresponding indices of the input tensor along a given axis.
Refer to the <strong>TopKLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. It must be of length 1 or 2.
The optional second input corresponds to value of K.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer. First and second correspond to
values and indices, respectively.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>number of values/indices to be computed along the axis.
Need not be given of there are two inputs, default: 0.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>axis along which the topk values/indices are computed.
negative indexing is supported, default: 0</p>
</dd>
<dt><strong>use_bottom_k: bool, optional</strong></dt><dd><p>if true, bottom k values are computed instead, default: false.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose">
<code class="sig-name descname"><span class="pre">add_transpose</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a N-D transpose layer with axes as a parameter.
Refer to the <strong>TransposeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt><dd><p>The list containing a permutation of “[0,1,2,…,N-1]” where N is the rank of input/output tensor.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary">
<code class="sig-name descname"><span class="pre">add_unary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Unary layer. Applies the specified function (mode) to all the elements of the input.
Prior to the application of the function the input can be scaled and shifted by using the ‘scale’,
‘shift’ parameters.
Refer to the <strong>UnaryFunctionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Unary function.
Allowed values: ‘sqrt’, ‘rsqrt’, ‘inverse’, ‘power’, ‘exp’, ‘log’, ‘abs’, threshold’.</p>
</dd>
<dt><strong>alpha: float</strong></dt><dd><p>constant used in with modes ‘power’ and ‘threshold’.</p>
</dd>
<dt><strong>shift, scale: float</strong></dt><dd><p>input is modified by scale and shift prior to the application of the unary function.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to prevent division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm">
<code class="sig-name descname"><span class="pre">add_unilstm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_state_update_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_input_forget_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Uni-directional LSTM layer to the model.
Refer to the <strong>UniDirectionalLSTMLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt><dd><p>List of biases. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of [x, h_input, c_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of [y, h_output, c_output].</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at input and forget gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt><dd><p>Cell state update activation function used at the cell state update gate.
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>output_activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,).</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the LSTM layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt><dd><p>If True, a vector of 1s is added to forget gate bias.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt><dd><p>If True, the input gate and forget gate is coupled. i.e. forget gate is not used.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt><dd><p>The limit on the maximum and minimum values on the cell state.
If not provided, it is defaulted to 50.0.</p>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the LSTM layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular">
<code class="sig-name descname"><span class="pre">add_upper_triangular</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a upper_triangular layer to the model that copies a tensor setting
everything outside upper triangular to zero.
Refer to the <strong>UpperTriangularLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>Diagonal above which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample">
<code class="sig-name descname"><span class="pre">add_upsample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEFAULT'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an upsample layer to the model.
Refer to the <strong>UpsampleLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>scaling_factor_h: int or float</strong></dt><dd><p>Scaling factor on the vertical direction. Float values only supported with BILINEAR and ALIGN_CORNERS_*</p>
</dd>
<dt><strong>scaling_factor_w: int or float</strong></dt><dd><p>Scaling factor on the horizontal direction. Float values only supported with BILINEAR and ALIGN_CORNERS_*</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Overall interpolation mode. The following values are supported:
‘NN’: nearest neighbour
‘BILINEAR’: bilinear interpolation</p>
</dd>
<dt><strong>linear_upsample_mode: str</strong></dt><dd><p>Specifies the behavior for linear upsampling. Only valid when Interpolation Mode is BILINEAR.
If input grid is [0, Xin-1] (corresponding to an input size of Xin), and if the output size is Xout,
then the grid points are sampled in the following manner:
‘DEFAULT’:</p>
<blockquote>
<div><p>spacing = (Xin-Xin/Xout) / (Xout-1)
grid_point[i] = min(Xin-1, max(0, i * spacing)), for i = 0,1,2,..,Xout-1</p>
</div></blockquote>
<dl class="simple">
<dt>‘ALIGN_CORNERS_TRUE’:</dt><dd><p>spacing = (Xin-1) / (Xout-1)
grid_point[i] = min(Xin-1, max(0, i * spacing)), for i = 0,1,2,..,Xout-1</p>
</dd>
<dt>‘ALIGN_CORNERS_FALSE’:</dt><dd><p>spacing = Xin / Xout
grid_point[i] = min(Xin-1, max(0, i * spacing + 0.5 * spacing - 0.5)), for i = 0,1,2,..,Xout-1</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_resize_bilinear</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable">
<code class="sig-name descname"><span class="pre">add_where_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a where_broadcastable layer to the model that returns the elements
either from tensor x or tensor y, depending on the value in the
condition tensor.
Refer to the <strong>WhereBroadcastableLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_nonzero</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero">
<code class="sig-name descname"><span class="pre">add_where_nonzero</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a where_nonzero layer to the model that returns a tensor containing
the indices of all non-zero elements of input tensor.
Refer to the <strong>WhereNonZeroLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_broadcastable</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels">
<code class="sig-name descname"><span class="pre">inspect_conv_channels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the output and kernel channels of a convolution layer.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels">
<code class="sig-name descname"><span class="pre">inspect_innerproduct_channels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the output and kernel channels of an innerProduct layer.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features">
<code class="sig-name descname"><span class="pre">inspect_input_features</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the name and type of input features.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers">
<code class="sig-name descname"><span class="pre">inspect_layers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for last “last” number of layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>last: int</strong></dt><dd><p>The numbers of layers to inspect, starting from the last one.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Whether to display layer-specific parameters or not</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers">
<code class="sig-name descname"><span class="pre">inspect_loss_layers</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for the loss layer.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer">
<code class="sig-name descname"><span class="pre">inspect_optimizer</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for the optimizer.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features">
<code class="sig-name descname"><span class="pre">inspect_output_features</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the name and type of output features.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers">
<code class="sig-name descname"><span class="pre">inspect_updatable_layers</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all updatable layers with their inputs and outputs.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable">
<code class="sig-name descname"><span class="pre">make_updatable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the builder’s NeuralNetwork spec updatable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trainables: list of str</strong></dt><dd><p>List of layer names to be set trainable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss">
<code class="sig-name descname"><span class="pre">set_categorical_cross_entropy_loss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Categorical Cross Entropy is used for single label categorization (only one category is applicable for each data point).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: The name of the loss layer</strong></dt><dd></dd>
<dt><strong>input: The name of the input, which should be a vector of length N representing the distribution over N categories. This must be the output of a softmax.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels">
<code class="sig-name descname"><span class="pre">set_class_labels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classLabel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_blob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Set class labels to the model spec to make it a neural network classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>class_labels: list of int or list of str</strong></dt><dd><p>A list of integers or strings that map the index of the output of a
neural network to labels in a classifier.</p>
</dd>
<dt><strong>predicted_feature_name: str</strong></dt><dd><p>Name of the output feature for the class labels exposed in the
Core ML neural network classifier, defaults: ‘classLabel’.</p>
</dd>
<dt><strong>prediction_blob: str</strong></dt><dd><p>If provided, then this is the name of the neural network blob which
generates the probabilities for each class label (typically the output
of a softmax layer). If not provided, then the last output layer is
assumed.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pre_processing_parameters</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input">
<code class="sig-name descname"><span class="pre">set_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_names: list of str</strong></dt><dd><p>The input names of the network.</p>
</dd>
<dt><strong>input_dims: [tuple]</strong></dt><dd><p>The input dimensions of the network. The ordering of input_dims
is the same as input_names.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec inputs to be 3 dimensional vector data1 and</span>
<span class="c1"># 4 dimensional vector data2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">],</span> <span class="n">input_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss">
<code class="sig-name descname"><span class="pre">set_mean_squared_error_loss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>input_feature: [(str, datatypes.Array)] or None</dt><dd><p>The input feature of the loss layer. Each feature is a (name,
array) tuple, where name is the name of the model’s tensor our loss will be attached to,
and array is a datatypes.Array object describing the shape of that tensor.
Both the name and the array’s shape must be provided in the tuple.
&gt;&gt;&gt; feature = [(‘output_tensor’, datatypes.Array((299, 299, 3)))]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_optional_input">
<code class="sig-name descname"><span class="pre">set_optional_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_optional_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks given input as optional input.
Optionally, sets default value for optional input if value is not None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_idx: int</strong></dt><dd><p>Index of input to be marked and fill with default value</p>
</dd>
<dt><strong>value: int/double/float/None</strong></dt><dd><p>Value to be fill as default value</p>
</dd>
<dt><strong>format: str</strong></dt><dd><p>Format of default value
Must be one of ‘float’, ‘double’ or ‘int’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output">
<code class="sig-name descname"><span class="pre">set_output</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output_names: list of str</strong></dt><dd><p>The output names of the network.</p>
</dd>
<dt><strong>output_dims: [tuple]</strong></dt><dd><p>The output dimensions of the network. The ordering of output_dims is the same
as output_names.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec outputs to be 3 dimensional vector feature1 and</span>
<span class="c1"># 4 dimensional vector feature2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span> <span class="s1">&#39;feature2&#39;</span><span class="p">],</span> <span class="n">output_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters">
<code class="sig-name descname"><span class="pre">set_pre_processing_parameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_bgr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">green_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NCHW'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pre-processing parameters layer to the neural network object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image_input_names: list of str</strong></dt><dd><p>Name of input blobs that are images</p>
</dd>
<dt><strong>is_bgr: boolean or dict()</strong></dt><dd><p>Channel order for input blobs that are images. BGR if True else RGB.
To specify a different value for each image input,
provide a dictionary with input names as keys.</p>
</dd>
<dt><strong>red_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (red channel)</p>
</dd>
<dt><strong>blue_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (blue channel)</p>
</dd>
<dt><strong>green_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (green channel)</p>
</dd>
<dt><strong>gray_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (for grayscale images)</p>
</dd>
<dt><strong>image_scale: float or dict()</strong></dt><dd><p>Value by which to scale the images.</p>
</dd>
<dt><strong>image_format: str</strong></dt><dd><p>Image format, either ‘NCHW’ / ‘NHWC’</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input">
<code class="sig-name descname"><span class="pre">set_training_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>The training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec training inputs to be 3 dimensional vector for &#39;input&#39; and</span>
<span class="c1"># Double for &#39;target&#39;.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_training_input</span><span class="p">([(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.builder._fill_tensor_fields">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.builder.</span></code><code class="sig-name descname"><span class="pre">_fill_tensor_fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder._fill_tensor_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the tensor fields.
ranks - None or a list of integers with the same length of number of inputs/outputs
shapes - None or a list of shapes the same length of number of inputs/outputs. Each shape is a list or tuple</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.builder._get_lstm_weight_fields">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.builder.</span></code><code class="sig-name descname"><span class="pre">_get_lstm_weight_fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lstm_wp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder._get_lstm_weight_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Get LSTM weight fields.
lstm_wp: _NeuralNetwork_pb2.LSTMWeightParams</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.flexible_shape_utils">
<span id="neural-network-flexible-shape-utils"></span><h2>neural_network.flexible_shape_utils<a class="headerlink" href="#module-coremltools.models.neural_network.flexible_shape_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities to annotate Neural Network Features with flexible shape information.
Only available in coremltools 2.0b1 and onwards</p>
<dl class="py class">
<dt id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSize">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">NeuralNetworkImageSize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSize" title="Permalink to this definition">¶</a></dt>
<dd><p>An object representing a size for an image feature inside a
neural network. Valid sizess for height and width are &gt; 0.</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSizeRange">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">NeuralNetworkImageSizeRange</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSizeRange" title="Permalink to this definition">¶</a></dt>
<dd><p>An object representing a range of sizes for an image feature inside a
neural network. Valid ranges for height and width are &gt; 0. A “-1”
upper bound value for either width or height represents an unbounded size
for that dimension.</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShape">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">NeuralNetworkMultiArrayShape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShape" title="Permalink to this definition">¶</a></dt>
<dd><p>An object representing a shape for a multiArray feature in a
neural network. Valid shapes must have have only the Channel [C]
shape or the Channel, Height and Width [C, H, W] shapes populated</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">NeuralNetworkMultiArrayShapeRange</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange" title="Permalink to this definition">¶</a></dt>
<dd><p>An object representing a range of shapes for a multiArray feature in a
neural network. Valid shape ranges must have have only the Channel [C]
range or the Channel, Height and Width [C, H, W] ranges populated. A “-1”
value in an upper bound represents an unbounded range.</p>
<dl class="py method">
<dt id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange.isFlexible">
<code class="sig-name descname"><span class="pre">isFlexible</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange.isFlexible" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if any one of the channel, height, or width ranges of this shape allow more than one input value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.add_enumerated_image_sizes">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">add_enumerated_image_sizes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sizes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_image_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output image feature in a Neural Network spec to
to accommodate a list of enumerated image sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the image feature for which to add size information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>sizes</strong> – [] | NeuralNetworkImageSize
A single or a list of NeuralNetworkImageSize objects which encode valid
size information for a image feature</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSize</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSize</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_enumerated_image_sizes</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">image_sizes</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.add_enumerated_multiarray_shapes">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">add_enumerated_multiarray_shapes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_multiarray_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output multiArray feature in a Neural Network spec to
to accommodate a list of enumerated array shapes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the image feature for which to add shape information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>shapes</strong> – [] | NeuralNetworkMultiArrayShape
A single or a list of NeuralNetworkImageSize objects which encode valid
size information for a image feature</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShape</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShape</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_channel_shape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_height_shape</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_width_shape</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_enumerated_multiarray_shapes</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">shapes</span><span class="o">=</span><span class="n">array_shapes</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.add_multiarray_ndshape_enumeration">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">add_multiarray_ndshape_enumeration</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enumerated_shapes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_multiarray_ndshape_enumeration" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes.
Add provided enumerated shapes to the list of shapes already present.
This method is different from “add_enumerated_multiarray_shapes”, which is applicable
for rank 5 mapping, SBCHW, arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>enumerated_shapes</strong> – List[Tuple(int)]
list of shapes, where each shape is specified as a tuple of integers.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># say, the default shape of &quot;my_multiarray_featurename&quot; is (2,3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_multiarray_ndshape_enumeration</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">enumerated_shapes</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.set_multiarray_ndshape_range">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">set_multiarray_ndshape_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.set_multiarray_ndshape_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes.
This is different from “update_multiarray_shape_range”, which works with rank 5
SBCHW mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>lower_bounds</strong> – List[int]
list of integers specifying the lower bounds of each dimension.
Length must be same as the rank (length of shape) of the feature_name.</p></li>
<li><p><strong>upper_bounds</strong> – List[int]
list of integers specifying the upper bounds of each dimension.
-1 corresponds to unbounded range.
Length must be same as the rank (length of shape) of the feature_name.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># say, the default shape of &quot;my_multiarray_featurename&quot; is (2,3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">set_multiarray_ndshape_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">lower_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.update_image_size_range">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">update_image_size_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.update_image_size_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output Image feature in a Neural Network spec to
to accommodate a range of image sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the Image feature for which to add shape information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>size_range</strong> – NeuralNetworkImageSizeRange
A NeuralNetworkImageSizeRange object with the populated image size
range information.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSizeRange</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span><span class="o">.</span><span class="n">add_height_range</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span><span class="o">.</span><span class="n">add_width_range</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">update_image_size_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">size_range</span><span class="o">=</span><span class="n">img_size_ranges</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.flexible_shape_utils.update_multiarray_shape_range">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></code><code class="sig-name descname"><span class="pre">update_multiarray_shape_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.update_multiarray_shape_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>shape_range</strong> – NeuralNetworkMultiArrayShapeRange
A NeuralNetworkMultiArrayShapeRange object with the populated shape
range information. The shape_range object must either contain only
shape information for channel or channel, height and width. If
the object is invalid then an exception is thrown</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShapeRange</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_channel_range</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_width_range</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_height_range</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">update_multiarray_shape_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">shape_range</span><span class="o">=</span><span class="n">shape_range</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.printer">
<span id="neural-network-printer"></span><h2>neural_network.printer<a class="headerlink" href="#module-coremltools.models.neural_network.printer" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="coremltools.models.neural_network.printer._print_network_spec_coding_style">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.printer.</span></code><code class="sig-name descname"><span class="pre">_print_network_spec_coding_style</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.printer._print_network_spec_coding_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
mlmodel_spec : the mlmodel spec
interface_only : Shows only the input and output of the network</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.printer._print_network_spec_parameter_info_style">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.printer.</span></code><code class="sig-name descname"><span class="pre">_print_network_spec_parameter_info_style</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.printer._print_network_spec_parameter_info_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the network information summary.
Args:
mlmodel_spec : the mlmodel spec
interface_only : Shows only the input and output of the network</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.printer.print_network_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.printer.</span></code><code class="sig-name descname"><span class="pre">print_network_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.printer.print_network_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the network information summary.
Args:
mlmodel_spec : the mlmodel spec
interface_only : Shows only the input and output of the network
style : str. Either ‘coding’ or default, which prints information on parameters of layers.</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.quantization_utils">
<span id="neural-network-quantization-utils"></span><h2>neural_network.quantization_utils<a class="headerlink" href="#module-coremltools.models.neural_network.quantization_utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities to compress Neural Network Models.
Only available in coremltools 2.0b1 and onwards</p>
<dl class="py class">
<dt id="coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">AdvancedQuantizedLayerSelector</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_layer_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_conv_kernel_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_conv_weight_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantized layer selector allowing the user to specify some types of
layers to skip during quantization process and the minimum size parameters
in quantized convolution layers.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network.quantization_utils</span> <span class="kn">import</span> <span class="n">AdvancedQuantizedLayerSelector</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">AdvancedQuantizedLayerSelector</span><span class="p">(</span>
        <span class="n">skip_layer_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;batchnorm&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;depthwiseConv&#39;</span><span class="p">],</span>
        <span class="n">minimum_conv_kernel_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">minimum_conv_weight_count</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
<span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantize_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector.do_quantize">
<code class="sig-name descname"><span class="pre">do_quantize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector.do_quantize" title="Permalink to this definition">¶</a></dt>
<dd><p>weight_param - should be name of the WeightParam field</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">MatrixMultiplyLayerSelector</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimum_weight_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_output_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_output_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_layers_with_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer selector object that allows users to select matrix multiplication layers
with one of the matrices being constant, based on some criterions like total
numbers of parameters/weights, number of input or output channels and/or layer
names. If any of the criterion is not valid, the corresponding layer is not
selected.</p>
<dl class="py method">
<dt id="coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector.do_quantize">
<code class="sig-name descname"><span class="pre">do_quantize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector.do_quantize" title="Permalink to this definition">¶</a></dt>
<dd><p>weight_param - should be name of the WeightParam field</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.quantization_utils.ModelMetrics">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">ModelMetrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.ModelMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility class to hold evaluation metrics</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.quantization_utils.OutputMetric">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">OutputMetric</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.OutputMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility class to calculate and hold metrics between
two model outputs</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.quantization_utils.QuantizedLayerSelector">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">QuantizedLayerSelector</span></code><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.QuantizedLayerSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the base class to implement custom selectors to skip certain
layers during quantization. To implement a custom selector, create a class
that inherits this class and override <cite>do_quantize()</cite> method.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLayerSelector</span><span class="p">(</span><span class="n">QuantizedLayerSelector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyLayerSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">do_quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyLayerSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">do_quantize</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span> <span class="ow">or</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dense_2&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">MyLayerSelector</span><span class="p">()</span>
<span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantize_weights</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">quantization_mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._convert_1bit_array_to_byte_array">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_convert_1bit_array_to_byte_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._convert_1bit_array_to_byte_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert bit array to byte array.</p>
<dl class="simple">
<dt>arr: list</dt><dd><p>Bits as a list where each element is an integer of 0 or 1</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.array</dt><dd><p>1D numpy array of type uint8</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._decompose_bytes_to_bit_arr">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_decompose_bytes_to_bit_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._decompose_bytes_to_bit_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack bytes to bits</p>
<dl class="simple">
<dt>arr: list</dt><dd><p>Byte Stream, as a list of uint8 values</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>bit_arr: list</dt><dd><p>Decomposed bit stream as a list of 0/1s of length (len(arr) * 8)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._dequantize_nn_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_dequantize_nn_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._dequantize_nn_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Dequantize weights in NeuralNetwork type mlmodel specifications.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._get_kmeans_lookup_table_and_weight">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_get_kmeans_lookup_table_and_weight</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k-means++'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._get_kmeans_lookup_table_and_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate K-Means lookup table given a weight parameter field</p>
<dl class="simple">
<dt>nbits:</dt><dd><p>Number of bits for quantization</p>
</dd>
<dt>w:</dt><dd><p>Weight as numpy array</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>lut: numpy.array</dt><dd><p>Lookup table, numpy array of shape (1 &lt;&lt; nbits, );</p>
</dd>
<dt>wq: numpy.array</dt><dd><p>Quantized weight of type numpy.uint8</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._get_linear_lookup_table_and_weight">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_get_linear_lookup_table_and_weight</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._get_linear_lookup_table_and_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a linear lookup table.</p>
<dl class="simple">
<dt>nbits: int</dt><dd><p>Number of bits to represent a quantized weight value</p>
</dd>
<dt>wp: numpy.array</dt><dd><p>Weight blob to be quantized</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>lookup_table: numpy.array</dt><dd><p>Lookup table of shape (2^nbits, )</p>
</dd>
<dt>qw: numpy.array</dt><dd><p>Decomposed bit stream as a list of 0/1s of length (len(arr) * 8)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._quantize_channelwise_linear">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_quantize_channelwise_linear</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._quantize_channelwise_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Linearly quantize weight blob.</p>
<dl class="simple">
<dt>weight: numpy.array</dt><dd><p>Weight to be quantized.</p>
</dd>
<dt>nbits: int</dt><dd><p>Number of bits per weight element</p>
</dd>
<dt>axis: int</dt><dd><p>Axis of the weight blob to compute channel-wise quantization, can be 0 or 1</p>
</dd>
<dt>symmetric: bool</dt><dd><p>If true, set quantization range to be symmetrical to 0.
Otherwise, set quantization range to be the minimum and maximum of
weight parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>quantized_weight: numpy.array</dt><dd><p>quantized weight as float numpy array, with the same shape as weight</p>
</dd>
<dt>scale: numpy.array</dt><dd><p>per channel scale</p>
</dd>
<dt>bias: numpy.array</dt><dd><p>per channel bias</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._quantize_nn_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_quantize_nn_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._quantize_nn_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantize weights in NeuralNetwork type mlmodel specifications.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._quantize_wp">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_quantize_wp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._quantize_wp" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantize the weight blob</p>
<dl class="simple">
<dt>wp: numpy.array</dt><dd><p>Weight parameters</p>
</dd>
<dt>nbits: int</dt><dd><p>Number of bits</p>
</dd>
<dt>qm:</dt><dd><p>Quantization mode</p>
</dd>
<dt>lut_function: (<code class="docutils literal notranslate"><span class="pre">callable</span> <span class="pre">function</span></code>)</dt><dd><p>Python callable representing a look-up table</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>scale: numpy.array</dt><dd><p>Per-channel scale</p>
</dd>
<dt>bias: numpy.array</dt><dd><p>Per-channel bias</p>
</dd>
<dt>lut: numpy.array</dt><dd><p>Lookup table</p>
</dd>
<dt>quantized_wp: numpy.array</dt><dd><p>Quantized weight of same shape as wp, with dtype numpy.uint8</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils._quantize_wp_field">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">_quantize_wp_field</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils._quantize_wp_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantize WeightParam field in Neural Network Protobuf</p>
<dl class="simple">
<dt>wp: MLModel.NeuralNetwork.WeightParam</dt><dd><p>WeightParam field</p>
</dd>
<dt>nbits: int</dt><dd><p>Number of bits to be quantized</p>
</dd>
<dt>qm: str</dt><dd><p>Quantization mode</p>
</dd>
<dt>shape: tuple</dt><dd><p>Tensor shape held by wp</p>
</dd>
<dt>axis: int</dt><dd><p>Axis over which quantization is performed on, can be either 0 or 1</p>
</dd>
<dt>lut_function: (<code class="docutils literal notranslate"><span class="pre">callable</span> <span class="pre">function</span></code>)</dt><dd><p>Python callable representing a LUT table function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils.activate_int8_int8_matrix_multiplications">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">activate_int8_int8_matrix_multiplications</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.activate_int8_int8_matrix_multiplications" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function that takes in either a full precision (float) spec or
an nbit quantized spec to selectively enable int8 activation + weight quantization
of matrix multiplication operations where the second matrix represents a constant weight.</p>
<dl class="simple">
<dt>spec: MLModel.get_spec()</dt><dd><p>Currently conversion for only neural network models is supported.
If a pipeline model is passed in then all embedded neural network models embedded within
will be modified.</p>
</dd>
<dt>selector: (optional) MatrixMultiplyLayerSelector</dt><dd><p>A MatrixMultiplyLayerSelector object that enables int8 activation + weight quantization
only on those layers for which the user-specified criterion on the minimum/maximum number
of size/channels in constant weight parameters is met.
It can also be derived to provide custom selection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils.compare_models">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">compare_models</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_precision_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantized_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.compare_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to compare the performance of a full precision vs quantized model</p>
<dl class="simple">
<dt>full_precision_model: MLModel</dt><dd><p>The full precision model with float32 weights</p>
</dd>
<dt>quantized_model: MLModel</dt><dd><p>Quantized version of the model with quantized weights</p>
</dd>
<dt>sample_data: str | [dict]</dt><dd><p>Data used to characterize performance of the quantized model in
comparison to the full precision model. Either a list of sample input
dictionaries or an absolute path to a directory containing images.
Path to a directory containing images is only valid for models with
one image input. For all other models a list of sample inputs must be
provided.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. Performance metrics are printed out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.quantization_utils.quantize_weights">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></code><code class="sig-name descname"><span class="pre">quantize_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_precision_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.quantize_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to convert a full precision (float) MLModel to a
nbit quantized MLModel (float16).</p>
<dl>
<dt>full_precision_model: MLModel</dt><dd><p>Model which will be converted to half precision. Currently conversion
for only neural network models is supported. If a pipeline model is
passed in then all embedded neural network models embedded within
will be converted.</p>
</dd>
<dt>nbits: int</dt><dd><dl class="simple">
<dt>Number of bits per quantized weight. Only 16-bit float point and</dt><dd><p>1-8 bit is supported</p>
</dd>
</dl>
</dd>
<dt>quantization_mode: str</dt><dd><p>One of the following:</p>
<dl class="simple">
<dt>“linear”:</dt><dd><p>Linear quantization with scale and bias assuming the range of weight
values is [A, B], where A = min(weight), B = max(weight)</p>
</dd>
<dt>“linear_lut”:</dt><dd><p>Simple linear quantization represented as a lookup table</p>
</dd>
<dt>“kmeans_lut”:</dt><dd><p>LUT based quantization, where LUT is generated by K-Means clustering</p>
</dd>
<dt>“custom_lut”:</dt><dd><p>LUT quantization where LUT and quantized weight params are
calculated using a custom function. If this mode is selected then
a custom function must be passed in kwargs with key lut_function.
The function must have input params (nbits, wp) where nbits is the
number of quantization bits and wp is the list of weights for a
given layer. The function should return two parameters (lut, qw)
where lut is an array of length (2^n bits)containing LUT values and
qw is the list of quantized weight parameters. See
<code class="docutils literal notranslate"><span class="pre">_get_linear_lookup_table_and_weight</span></code> for a sample implementation.</p>
</dd>
<dt>“linear_symmetric”:</dt><dd><p>Linear quantization with scale and bias assuming the range of weight
values is [-A, A], where A = max(abs(weight)).</p>
</dd>
</dl>
</dd>
<dt>sample_data: str | [dict]</dt><dd><p>Data used to characterize performance of the quantized model in
comparison to the full precision model. Either a list of sample input
dictionaries or an absolute path to a directory containing images.
Path to a directory containing images is only valid for models with
one image input. For all other models a list of sample inputs must be
provided.</p>
</dd>
<dt>kwargs: keyword arguments</dt><dd><dl>
<dt><em>lut_function</em><span class="classifier">(<code class="docutils literal notranslate"><span class="pre">callable</span> <span class="pre">function</span></code>)</span></dt><dd><p>A callable function provided when quantization mode is set to
<code class="docutils literal notranslate"><span class="pre">_QUANTIZATION_MODE_CUSTOM_LOOKUP_TABLE</span></code>. See <code class="docutils literal notranslate"><span class="pre">quantization_mode</span></code>
for more details.</p>
</dd>
<dt><em>selector</em>: QuantizedLayerSelector</dt><dd><p>A QuanatizedLayerSelector object that can be derived to provide
custom quantization selection.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>model: MLModel</dt><dd><p>The quantized MLModel instance if running on macOS 10.14 or later,
otherwise the quantized model specification is returned</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">quantization_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s1">&#39;my_model.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantization_utils</span><span class="o">.</span><span class="n">quantize_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;linear&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.spec_inspection_utils">
<span id="neural-network-spec-inspection-utils"></span><h2>neural_network.spec_inspection_utils<a class="headerlink" href="#module-coremltools.models.neural_network.spec_inspection_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="coremltools.models.neural_network.spec_inspection_utils._get_weight_param_summary">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.spec_inspection_utils.</span></code><code class="sig-name descname"><span class="pre">_get_weight_param_summary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.spec_inspection_utils._get_weight_param_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a summary of _NeuralNetwork_pb2.WeightParams
Args:
wp : _NeuralNetwork_pb2.WeightParams - the _NeuralNetwork_pb2.WeightParams message to display
Returns:
a str summary for wp</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.spec_inspection_utils._summarize_network_layer_info">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.spec_inspection_utils.</span></code><code class="sig-name descname"><span class="pre">_summarize_network_layer_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.spec_inspection_utils._summarize_network_layer_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
layer - an MLModel NeuralNetwork Layer protobuf message
Returns:
layer_type : str - type of layer
layer_name : str - name of the layer
layer_inputs : list[str] - a list of strings representing input blobs of the layer
layer_outputs : list[str] - a list of strings representing output blobs of the layer
layer_field_content : list[(str, str)] - a list of two-tuple of (parameter_name, content)</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.spec_inspection_utils._summarize_neural_network_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.spec_inspection_utils.</span></code><code class="sig-name descname"><span class="pre">_summarize_neural_network_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel_spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.spec_inspection_utils._summarize_neural_network_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize network into the following structure.
Args:
mlmodel_spec : mlmodel spec
Returns:
inputs : list[(str, str)] - a list of two tuple (name, descriptor) for each input blob.
outputs : list[(str, str)] - a list of two tuple (name, descriptor) for each output blob
layers : list[(str, list[str], list[str], list[(str, str)])] - a list of layers represented by</p>
<blockquote>
<div><p>layer name, input blobs, output blobs, a list of (parameter name, content)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.spec_inspection_utils._summarize_neural_network_spec_code_style">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.spec_inspection_utils.</span></code><code class="sig-name descname"><span class="pre">_summarize_neural_network_spec_code_style</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.spec_inspection_utils._summarize_neural_network_spec_code_style" title="Permalink to this definition">¶</a></dt>
<dd><p>print nn_spec as if writing code</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.update_optimizer_utils">
<span id="neural-network-update-optimizer-utils"></span><h2>neural_network.update_optimizer_utils<a class="headerlink" href="#module-coremltools.models.neural_network.update_optimizer_utils" title="Permalink to this headline">¶</a></h2>
<p>Neural Network optimizer utilities.</p>
<dl class="py class">
<dt id="coremltools.models.neural_network.update_optimizer_utils.AdamParams">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></code><code class="sig-name descname"><span class="pre">AdamParams</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.AdamParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Adam - A Method for Stochastic Optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lr: float</strong></dt><dd><p>The learning rate that controls learning step size. Adjustable in progress, default: 0.01.</p>
</dd>
<dt><strong>batch: int</strong></dt><dd><p>The mini-batch size, number of examples used to compute single gradient step, default: 10.</p>
</dd>
<dt><strong>beta1: float</strong></dt><dd><p>Controls the exponential decay rate for the first moment estimates, default: 0.9.</p>
</dd>
<dt><strong>beta2: float</strong></dt><dd><p>Controls the exponential decay rate for the second moment estimates, default: 0.999.</p>
</dd>
<dt><strong>eps: float</strong></dt><dd><p>The epsilon, a very small number to prevent any division by zero in the implementation, default: 1e-8.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>set_lr(value, min, max)</strong></p></td>
<td><p>Set value for learning rate.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_batch(value, allow_set)</strong></p></td>
<td><p>Set value for batch size.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_beta1(value, min, max)</strong></p></td>
<td><p>Set value for beta1.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_beta2(value, min, max)</strong></p></td>
<td><p>Set value for beta2.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_eps(value, min, max)</strong></p></td>
<td><p>Set value for epsilon.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.update_optimizer_utils.Batch">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></code><code class="sig-name descname"><span class="pre">Batch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.Batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value: float</strong></dt><dd></dd>
<dt><strong>allowed_set: float</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.update_optimizer_utils.RangeParam">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></code><code class="sig-name descname"><span class="pre">RangeParam</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.RangeParam" title="Permalink to this definition">¶</a></dt>
<dd><p>Range Parameter optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value: float</strong></dt><dd></dd>
<dt><strong>min: float</strong></dt><dd></dd>
<dt><strong>max: float</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.neural_network.update_optimizer_utils.SgdParams">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></code><code class="sig-name descname"><span class="pre">SgdParams</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.SgdParams" title="Permalink to this definition">¶</a></dt>
<dd><p>SGD - Stochastic Gradient Descent optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lr: float</strong></dt><dd><p>The learning rate that controls learning step size. Adjustable in progress, default: 0.01.</p>
</dd>
<dt><strong>batch: int</strong></dt><dd><p>The mini-batch size, number of examples used to compute single gradient step, default: 10.</p>
</dd>
<dt><strong>momentum: float</strong></dt><dd><p>The momentum factor that helps accelerate gradients vectors in the right direction, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 46%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>set_lr(value, min, max)</strong></p></td>
<td><p>Set value for learning rate.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_batch(value, allow_set)</strong></p></td>
<td><p>Set value for batch size.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_momentum(value, min, max)</strong></p></td>
<td><p>Set value for momentum.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.neural_network.utils">
<span id="neural-network-utils"></span><h2>neural_network.utils<a class="headerlink" href="#module-coremltools.models.neural_network.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="coremltools.models.neural_network.utils.make_image_input">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.utils.</span></code><code class="sig-name descname"><span class="pre">make_image_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_bgr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">green_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NHWC'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.utils.make_image_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert input of type multiarray to type image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>TODO</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: MLModel</dt><dd></dd>
<dt>A coreML MLModel object</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>TODO</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.neural_network.utils.make_nn_classifier">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.utils.</span></code><code class="sig-name descname"><span class="pre">make_nn_classifier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_probabilities_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.utils.make_nn_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a model of type “neuralNetwork” to type “neuralNetworkClassifier”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>TODO</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: MLModel</dt><dd></dd>
<dt>A coreML MLModel object</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>TODO</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.array_feature_extractor">
<span id="array-feature-extractor"></span><h2>array_feature_extractor<a class="headerlink" href="#module-coremltools.models.array_feature_extractor" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="coremltools.models.array_feature_extractor.create_array_feature_extractor">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.array_feature_extractor.</span></code><code class="sig-name descname"><span class="pre">create_array_feature_extractor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.array_feature_extractor.create_array_feature_extractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a feature extractor from an input array feature, return</p>
<p>input_features is a list of one (name, array) tuple.</p>
<p>extract_indices is either an integer or a list.  If it’s an integer,
the output type is by default a double (but may also be an integer).
If a list, the output type is an array.</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.datatypes">
<span id="datatypes"></span><h2>datatypes<a class="headerlink" href="#module-coremltools.models.datatypes" title="Permalink to this headline">¶</a></h2>
<p>Basic Data Types.</p>
<dl class="py class">
<dt id="coremltools.models.datatypes.Array">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">Array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes.Array" title="Permalink to this definition">¶</a></dt>
<dd><p>Array Data Type</p>
<dl class="py method">
<dt id="coremltools.models.datatypes.Array.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes.Array.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a Array, given its dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dimensions: ints | longs</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># Create a single dimensions array of length five
&gt;&gt;&gt; arr = coremltools.models.datatypes.Array(5)</p>
<p># Create a multi dimension array five by two by ten.
&gt;&gt;&gt; multi_arr = coremltools.models.datatypes.Array(5, 2, 10)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.datatypes.Dictionary">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">Dictionary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes.Dictionary" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary Data Type</p>
<dl class="py method">
<dt id="coremltools.models.datatypes.Dictionary.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes.Dictionary.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a Dictionary, given its key type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>key_type: Int64 | String</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.datatypes</span> <span class="kn">import</span> <span class="n">Dictionary</span><span class="p">,</span> <span class="n">Int64</span><span class="p">,</span> <span class="n">String</span>
</pre></div>
</div>
<p># Create a dictionary with string keys
&gt;&gt;&gt; str_key_dict = Dictionary(key_type=String)</p>
<p># Create a dictionary with int keys
&gt;&gt;&gt; int_key_dict = Dictionary(Int64)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.datatypes.Double">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">Double</span></code><a class="headerlink" href="#coremltools.models.datatypes.Double" title="Permalink to this definition">¶</a></dt>
<dd><p>Double Data Type</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.datatypes.Int64">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">Int64</span></code><a class="headerlink" href="#coremltools.models.datatypes.Int64" title="Permalink to this definition">¶</a></dt>
<dd><p>Int64 Data Type</p>
</dd></dl>

<dl class="py class">
<dt id="coremltools.models.datatypes.String">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">String</span></code><a class="headerlink" href="#coremltools.models.datatypes.String" title="Permalink to this definition">¶</a></dt>
<dd><p>String Data Type</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.datatypes._is_valid_datatype">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">_is_valid_datatype</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datatype_instance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes._is_valid_datatype" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if datatype_instance is a valid datatype object and false otherwise.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.datatypes._normalize_datatype">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.datatypes.</span></code><code class="sig-name descname"><span class="pre">_normalize_datatype</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datatype_instance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.datatypes._normalize_datatype" title="Permalink to this definition">¶</a></dt>
<dd><p>Translates a user specified datatype to an instance of the ones defined above.</p>
<p>Valid data types are passed through, and the following type specifications
are translated to the proper instances:</p>
<p>str, “String” -&gt; String()
int, “Int64” -&gt; Int64()
float, “Double” -&gt; Double()</p>
<p>If a data type is not recognized, then an error is raised.</p>
</dd></dl>

</div>
<div class="section" id="module-coremltools.models.pipeline">
<span id="pipeline"></span><h2>pipeline<a class="headerlink" href="#module-coremltools.models.pipeline" title="Permalink to this headline">¶</a></h2>
<p>Pipeline utils for this package.</p>
<dl class="py class">
<dt id="coremltools.models.pipeline.Pipeline">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></code><code class="sig-name descname"><span class="pre">Pipeline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.Pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.</p>
<p>This class is the base class for <a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier" title="coremltools.models.pipeline.PipelineClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineClassifier</span></code></a> and
<a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor" title="coremltools.models.pipeline.PipelineRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineRegressor</span></code></a>, which contain a sequence ending in a classifier
or regressor and themselves behave like a classifier or regressor.  This class
may be used directly for a sequence of feature transformer objects.</p>
<dl class="py method">
<dt id="coremltools.models.pipeline.Pipeline.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pipeline of models to be executed sequentially.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.Pipeline.add_model">
<code class="sig-name descname"><span class="pre">add_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.Pipeline.set_training_input">
<code class="sig-name descname"><span class="pre">set_training_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.set_training_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.pipeline.PipelineClassifier">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></code><code class="sig-name descname"><span class="pre">PipelineClassifier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a classification model by designating
a discrete categorical output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineClassifier.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The last
model in this list must be a classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
This list must match the class labels in the model outputting the categorical
predictedFeatureName</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <cite>output_features</cite>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <cite>“classProbability.”</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineClassifier.add_model">
<code class="sig-name descname"><span class="pre">add_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineClassifier.set_training_input">
<code class="sig-name descname"><span class="pre">set_training_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.set_training_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.pipeline.PipelineRegressor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></code><code class="sig-name descname"><span class="pre">PipelineRegressor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor" title="Permalink to this definition">¶</a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a regression model by designating
a real valued output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineRegressor.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The final
output model must be a regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineRegressor.add_model">
<code class="sig-name descname"><span class="pre">add_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.pipeline.PipelineRegressor.set_training_input">
<code class="sig-name descname"><span class="pre">set_training_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.set_training_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-coremltools.models.tree_ensemble">
<span id="tree-ensemble"></span><h2>tree_ensemble<a class="headerlink" href="#module-coremltools.models.tree_ensemble" title="Permalink to this headline">¶</a></h2>
<p>Tree ensemble builder class to construct CoreML models.</p>
<dl class="py class">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></code><code class="sig-name descname"><span class="pre">TreeEnsembleBase</span></code><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for the tree ensemble builder class.  This should be instantiated
either through the <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="coremltools.models.tree_ensemble.TreeEnsembleRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleRegressor</span></code></a> or
<a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="coremltools.models.tree_ensemble.TreeEnsembleClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleClassifier</span></code></a> classes.</p>
<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>High level Python API to build a tree ensemble model for Core ML.</p>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node">
<code class="sig-name descname"><span class="pre">add_branch_node</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value_tracks_true_child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a branch node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>feature_index: int</strong></dt><dd><p>Index of the feature in the input being split on.</p>
</dd>
<dt><strong>feature_value: double or int</strong></dt><dd><p>The value used in the feature comparison determining the traversal
direction from this node.</p>
</dd>
<dt><strong>branch_mode: str</strong></dt><dd><p>Branch mode of the node, specifying the condition under which the node
referenced by <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code> is called next.</p>
<p>Must be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">==</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueNotEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">!=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>true_child_id: int</strong></dt><dd><p>ID of the child under the true condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>false_child_id: int</strong></dt><dd><p>ID of the child under the false condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>relative_hit_rate: float [optional]</strong></dt><dd><p>When the model is converted compiled by CoreML, this gives hints to
Core ML about which node is more likely to be hit on evaluation,
allowing for additional optimizations. The values can be on any scale,
with the values between child nodes being compared relative to each
other.</p>
</dd>
<dt><strong>missing_value_tracks_true_child: bool [optional]</strong></dt><dd><p>If the training data contains NaN values or missing values, then this
flag determines which direction a NaN value traverses.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node">
<code class="sig-name descname"><span class="pre">add_leaf_node</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a leaf node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>values: [float | int | list | dict]</strong></dt><dd><p>Value(s) at the leaf node to add to the prediction when this node is
activated.  If the prediction dimension of the tree is 1, then the
value is specified as a float or integer value.</p>
<p>For multidimensional predictions, the values can be a list of numbers
with length matching the dimension of the predictions or a dictionary
mapping index to value added to that dimension.</p>
<p>Note that the dimension of any tree must match the dimension given
when <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_prediction_value()</span></code></a> is called.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value">
<code class="sig-name descname"><span class="pre">set_default_prediction_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the default prediction value(s).</p>
<p>The values given here form the base prediction value that the values
at activated leaves are added to.  If values is a scalar, then
the output of the tree must also be 1 dimensional; otherwise, values
must be a list with length matching the dimension of values in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>values: [int | double | list[double]]</strong></dt><dd><p>Default values for predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform">
<code class="sig-name descname"><span class="pre">set_post_evaluation_transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the post processing transform applied after the prediction value
from the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>value: str</strong></dt><dd><p>A value denoting the transform applied.  Possible values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;NoTransform&quot;</span></code> (default).  Do not apply a transform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Classification_SoftMax&quot;</span></code>.</p>
<p>Apply a softmax function to the outcome to produce normalized,
non-negative scores that sum to 1.  The transformation applied to
dimension <cite>i</cite> is equivalent to:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{e^{x_i}}{\sum_j e^{x_j}}\]</div>
</div></blockquote>
<p>Note: This is the output transformation applied by the XGBoost package
with multiclass classification.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Regression_Logistic&quot;</span></code>.</p>
<p>Applies a logistic transform the predicted value, specifically:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[(1 + e^{-v})^{-1}\]</div>
</div></blockquote>
<p>This is the transformation used in binary classification.</p>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleClassifier">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></code><code class="sig-name descname"><span class="pre">TreeEnsembleClassifier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble classification model.</p>
<p>The TreeEnsembleClassifier class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleClassifier</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">                                output_features = &quot;predicted_class&quot;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Put in a softmax transform to translate these into probabilities.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_post_evaluation_transform</span><span class="p">(</span><span class="s2">&quot;Classification_SoftMax&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a tree ensemble classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
The length of this must match the dimension of the tree model.</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <code class="docutils literal notranslate"><span class="pre">output_features</span></code>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <code class="docutils literal notranslate"><span class="pre">&quot;classProbability&quot;</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleRegressor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></code><code class="sig-name descname"><span class="pre">TreeEnsembleRegressor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="Permalink to this definition">¶</a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble regression model.</p>
<p>The TreeEnsembleRegressor class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Required inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">datatypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.tree_ensemble</span> <span class="kn">import</span> <span class="n">TreeEnsembleRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define input features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">()))]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define output_features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;predicted_values&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleRegressor</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">output_features</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0, which is index 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Tree Ensemble regression model that takes one or more input
features and maps them to an output feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>target:  (default = None)</strong></dt><dd><p>Name of the target feature predicted.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-coremltools.models.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-coremltools.models.utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for the entire package.</p>
<dl class="py function">
<dt id="coremltools.models.utils._convert_neural_network_weights_to_fp16">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_convert_neural_network_weights_to_fp16</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_precision_model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._convert_neural_network_weights_to_fp16" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to convert a full precision (float) MLModel to a
half precision MLModel (float16).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>full_precision_model: MLModel</strong></dt><dd><p>Model which will be converted to half precision. Currently conversion
for only neural network models is supported. If a pipeline model is
passed in then all embedded neural network models embedded within
will be converted.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: MLModel</dt><dd><p>The converted half precision MLModel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._element_equal">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_element_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._element_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a robust equality test between elements.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._get_custom_layer_names">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_get_custom_layer_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._get_custom_layer_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of className fields which appear in the given protobuf spec</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: mlmodel spec</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>set(str) A set of unique className fields of custom layers that appear in the model.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._get_custom_layers">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_get_custom_layers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._get_custom_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all neural network custom layers in the spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: mlmodel spec</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>[NN layer] A list of custom layer implementations</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._get_input_names">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_get_input_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._get_input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the names of the inputs to this model.
:param spec: The model protobuf specification
:return: list of str A list of input feature names</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._get_model">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_get_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility to get the model and the data.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._get_nn_layers">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_get_nn_layers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._get_nn_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of neural network layers if the model contains any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>A model protobuf specification.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>[NN layer]</dt><dd><p>list of all layers (including layers from elements of a pipeline</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._has_custom_layer">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_has_custom_layer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._has_custom_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the given protobuf specification has a custom layer, and false otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: mlmodel spec</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>True if the protobuf specification contains a neural network with a custom layer, False otherwise.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._is_macos">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_is_macos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._is_macos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if current platform is MacOS, False otherwise.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._macos_version">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_macos_version</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._macos_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns macOS version as a tuple of integers, making it easy to do proper
version comparisons. On non-Macs, it returns an empty tuple.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._python_version">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_python_version</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._python_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Return python version as a tuple of integers</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._replace_custom_layer_name">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_replace_custom_layer_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oldname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._replace_custom_layer_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitutes newname for oldname in the className field of custom layers. If there are no custom layers, or no
layers with className=oldname, then the spec is unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: mlmodel spec</strong></dt><dd></dd>
<dt><strong>oldname: str The custom layer className to be replaced.</strong></dt><dd></dd>
<dt><strong>newname: str The new className value to replace oldname</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>An mlmodel spec.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils._sanitize_value">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">_sanitize_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils._sanitize_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cleaning steps on the data so various type comparisons can
be performed correctly.</p>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.convert_double_to_float_multiarray_type">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">convert_double_to_float_multiarray_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.convert_double_to_float_multiarray_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all double multiarrays feature descriptions (input, output, training input)
to float multiarrays</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the multiarrays types to convert</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place convert multiarray type of spec</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spec</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_double_to_float_multiarray_type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.evaluate_classifier">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">evaluate_classifier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a Core ML classifier model and compare against predictions
from the original framework (for testing correctness of conversion).
Use this evaluation for models that don’t deal with probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: list of str or list of MLModel</strong></dt><dd><p>File from where to load the model from (OR) a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: list of str or list of Dataframe</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a csv file).</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Column to interpret as the target column</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for a more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="coremltools.models.utils.evaluate_classifier_with_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier_with_probabilities</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span>  <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_classifier</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;data_and_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="go">{&quot;samples&quot;: 10, num_errors: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.evaluate_classifier_with_probabilities">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">evaluate_classifier_with_probabilities</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'probabilities'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a classifier specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: [str | Model]</strong></dt><dd><p>File from where to load the model from (OR) a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: [str | Dataframe]</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a csv file).</p>
</dd>
<dt><strong>probabilities: str</strong></dt><dd><p>Column to interpret as the probabilities column</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.evaluate_regressor">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">evaluate_regressor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.evaluate_regressor" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a CoreML regression model and compare against predictions
from the original framework (for testing correctness of conversion)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: list of str or list of MLModel</strong></dt><dd><p>File path from which to load the MLModel from (OR) a loaded version of
MLModel.</p>
</dd>
<dt><strong>data: list of str or list of Dataframe</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a .csv file).</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Name of the column in the dataframe that must be interpreted
as the target column.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for a more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_regressor</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;data_and_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="go">{&quot;samples&quot;: 10, &quot;rmse&quot;: 0.0, max_error: 0.0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.evaluate_transformer">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">evaluate_transformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.evaluate_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a transformer specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: list of str or list of MLModel</strong></dt><dd><p>File from where to load the Model from (OR) a loaded
version of MLModel.</p>
</dd>
<dt><strong>input_data: list of dict</strong></dt><dd><p>Test data on which to evaluate the models.</p>
</dd>
<dt><strong>reference_output: list of dict</strong></dt><dd><p>Expected results for the model.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;input_1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;input_2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;input_1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;input_2&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected_output</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;input_1&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;input_2&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;input_1&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s1">&#39;input_2&#39;</span><span class="p">:</span> <span class="mf">2.3</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_transformer</span><span class="p">(</span><span class="n">scaler_spec</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">expected_output</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.load_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">load_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.load_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a protobuf model specification from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: str</strong></dt><dd><p>Location on disk (a valid file path) from which the file is loaded
as a protobuf spec.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model_spec: Model_pb</dt><dd><p>Protobuf representation of the model</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.save_spec" title="coremltools.models.utils.save_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;HousePricer.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.rename_feature">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">rename_feature</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.rename_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename a feature in the specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the feature to rename.</p>
</dd>
<dt><strong>current_name: str</strong></dt><dd><p>Current name of the feature. If this feature doesn’t exist, the rename
is a no-op.</p>
</dd>
<dt><strong>new_name: str</strong></dt><dd><p>New name of the feature.</p>
</dd>
<dt><strong>rename_inputs: bool</strong></dt><dd><p>Search for <cite>current_name</cite> only in the input features (i.e ignore output
features)</p>
</dd>
<dt><strong>rename_outputs: bool</strong></dt><dd><p>Search for <cite>current_name</cite> only in the output features (i.e ignore input
features)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place rename of spec</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_feature</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;old_feature&#39;</span><span class="p">,</span> <span class="s1">&#39;new_feature_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="coremltools.models.utils.save_spec">
<code class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></code><code class="sig-name descname"><span class="pre">save_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_set_specification_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.utils.save_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a protobuf model specification to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>Protobuf representation of the model</p>
</dd>
<dt><strong>filename: str</strong></dt><dd><p>File path  where the spec gets saved.</p>
</dd>
<dt><strong>auto_set_specification_version: bool</strong></dt><dd><p>If true, will always try to set specification version automatically.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.load_spec" title="coremltools.models.utils.load_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;HousePricer.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="coremltools.converters.mil.input_types.html" class="btn btn-neutral float-right" title="MIL Input Types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="coremltools.converters.xgboost.html" class="btn btn-neutral float-left" title="XGBoost" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Apple

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>