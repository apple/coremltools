<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coremltools.converters.sklearn._converter &mdash; coremltools API Reference 7.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/norightmargin.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            coremltools API Reference
          </a>
              <div class="version">
                7.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.models.html">Model APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.converters.mil.html">MIL Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.converters.mil.input_types.html">MIL Input Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.converters.mil.mil.ops.defs.html">MIL Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.converters.mil.mil.passes.defs.html">MIL Graph Passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/coremltools.optimize.html">Optimizers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/docs-guides/index.html">Guide and Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/mlmodel/index.html">Core ML Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/api-versions.html">Previous Versions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apple/coremltools">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">coremltools API Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">coremltools.converters.sklearn._converter</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for coremltools.converters.sklearn._converter</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2017, Apple Inc. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Use of this source code is governed by a BSD-3-clause license that can be</span>
<span class="c1"># found in the LICENSE.txt file or at https://opensource.org/licenses/BSD-3-Clause</span>

<span class="kn">from</span> <span class="nn">coremltools</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">ct_version</span>
<span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">_METADATA_SOURCE</span><span class="p">,</span> <span class="n">_METADATA_VERSION</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Defines the primary function for converting scikit-learn models.</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="convert"><a class="viewcode-back" href="../../../../source/coremltools.converters.sklearn.html#coremltools.converters.sklearn._converter.convert">[docs]</a><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">sk_obj</span><span class="p">,</span> <span class="n">input_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_feature_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert scikit-learn pipeline, classifier, or regressor to Core ML format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sk_obj: model | [model] of scikit-learn format.</span>
<span class="sd">        Scikit learn model(s) to convert to a Core ML format.</span>

<span class="sd">        The input model may be a single scikit learn model, a scikit learn</span>
<span class="sd">        pipeline model, or a list of scikit learn models.</span>

<span class="sd">        Currently supported scikit learn models are:</span>

<span class="sd">        -   Linear and Logistic Regression</span>
<span class="sd">        -   LinearSVC and LinearSVR</span>
<span class="sd">        -   Ridge Regression</span>
<span class="sd">        -   SVC and SVR</span>
<span class="sd">        -   NuSVC and NuSVR</span>
<span class="sd">        -   Gradient Boosting Classifier and Regressor</span>
<span class="sd">        -   Decision Tree Classifier and Regressor</span>
<span class="sd">        -   Random Forest Classifier and Regressor</span>
<span class="sd">        -   Normalizer</span>
<span class="sd">        -   Imputer</span>
<span class="sd">        -   Standard Scaler</span>
<span class="sd">        -   DictVectorizer</span>
<span class="sd">        -   One Hot Encoder</span>
<span class="sd">        -   KNeighborsClassifier</span>

<span class="sd">        The input model, or the last model in a pipeline or list of models,</span>
<span class="sd">        determines whether this is exposed as a Transformer, Regressor,</span>
<span class="sd">        or Classifier.</span>

<span class="sd">        Note that there may not be a one-to-one correspondence between scikit</span>
<span class="sd">        learn models and the Core ML models chosen to represent them.  For</span>
<span class="sd">        example, many scikit learn models are embedded in a pipeline to handle</span>
<span class="sd">        processing of input features.</span>


<span class="sd">    input_features: str | dict | list</span>

<span class="sd">        Optional name(s) that can be given to the inputs of the scikit-learn</span>
<span class="sd">        model. Defaults to ``&quot;input&quot;``.</span>

<span class="sd">        Input features can be specified in a number of forms.</span>

<span class="sd">        -   Single string: In this case, the input is assumed to be a single</span>
<span class="sd">            array, with the number of dimensions set using ``num_dimensions``.</span>

<span class="sd">        -   List of strings: In this case, the overall input dimensions to the</span>
<span class="sd">            scikit-learn model are assumed to be the length of the list. If</span>
<span class="sd">            neighboring names are identical, they are assumed to be an input</span>
<span class="sd">            array of that length. For example:</span>

<span class="sd">               ``[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]``</span>

<span class="sd">            resolves to:</span>

<span class="sd">                ``[(&quot;a&quot;, Double), (&quot;b&quot;, Double), (&quot;c&quot;, Double)]``.</span>

<span class="sd">            In addition:</span>

<span class="sd">                ``[&quot;a&quot;, &quot;a&quot;, &quot;b&quot;]``</span>

<span class="sd">            resolves to:</span>

<span class="sd">                ``[(&quot;a&quot;, Array(2)), (&quot;b&quot;, Double)]``.</span>

<span class="sd">        - Dictionary: Where the keys are the names and the indices or ranges of</span>
<span class="sd">          feature indices.</span>

<span class="sd">            In this case, the Dictionary is presented as a mapping from keys to indices or</span>
<span class="sd">            ranges of contiguous indices. For example:</span>

<span class="sd">                ``{&quot;a&quot; : 0, &quot;b&quot; : [2,3], &quot;c&quot; : 1}``</span>

<span class="sd">            resolves to:</span>

<span class="sd">                ``[(&quot;a&quot;, Double), (&quot;c&quot;, Double), (&quot;b&quot;, Array(2))]``.</span>

<span class="sd">            Note that the ordering is determined by the indices.</span>

<span class="sd">        -   List of tuples of the form ``(name, datatype)``, in which ``name`` is the</span>
<span class="sd">            name of the exposed feature, and ``datatype`` is an instance of</span>
<span class="sd">            ``String``, ``Double``, ``Int64``, ``Array``, or ``Dictionary``.</span>

<span class="sd">    output_feature_names: string or list of strings</span>
<span class="sd">        Optional name(s) that can be given to the inputs of the scikit-learn</span>
<span class="sd">        model.</span>

<span class="sd">        The ``output_feature_names`` is interpreted according to the model type:</span>

<span class="sd">        - If the scikit-learn model is a transformer, it is the name of the</span>
<span class="sd">          array feature output by the final sequence of the transformer</span>
<span class="sd">          (defaults to ``&quot;output&quot;``).</span>
<span class="sd">        - If it is a classifier, it should be a 2-tuple of names giving the top</span>
<span class="sd">          class prediction and the array of scores for each class (defaults to</span>
<span class="sd">          ``&quot;classLabel&quot;`` and ``&quot;classScores&quot;``).</span>
<span class="sd">        - If it is a regressor, it should give the name of the prediction value</span>
<span class="sd">          (defaults to ``&quot;prediction&quot;``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    model:MLModel</span>
<span class="sd">        Returns an MLModel instance representing a Core ML model.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    .. sourcecode:: python</span>

<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>

<span class="sd">        # Load data</span>
<span class="sd">        &gt;&gt;&gt; data = pd.read_csv(&#39;houses.csv&#39;)</span>

<span class="sd">        # Train a model</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; model.fit(data[[&quot;bedroom&quot;, &quot;bath&quot;, &quot;size&quot;]], data[&quot;price&quot;])</span>

<span class="sd">         # Convert and save the scikit-learn model</span>
<span class="sd">        &gt;&gt;&gt; import coremltools</span>
<span class="sd">        &gt;&gt;&gt; coreml_model = coremltools.converters.sklearn.convert(model,</span>
<span class="sd">                                                                 [&quot;bedroom&quot;, &quot;bath&quot;, &quot;size&quot;],</span>
<span class="sd">                                                                 &quot;price&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coreml_model.save(&#39;HousePricer.mlmodel&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function is just a thin wrapper around the internal converter so</span>
    <span class="c1"># that sklearn isn&#39;t actually imported unless this function is called</span>
    <span class="kn">from</span> <span class="nn">...models</span> <span class="kn">import</span> <span class="n">MLModel</span>
    <span class="c1"># NOTE: Providing user-defined class labels will be enabled when</span>
    <span class="c1"># several issues with the ordering of the classes are worked out.  For now,</span>
    <span class="c1"># to use custom class labels, directly import the internal function below.</span>
    <span class="kn">from</span> <span class="nn">._converter_internal</span> <span class="kn">import</span> <span class="n">_convert_sklearn_model</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">_convert_sklearn_model</span><span class="p">(</span>
        <span class="n">sk_obj</span><span class="p">,</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">output_feature_names</span><span class="p">,</span> <span class="n">class_labels</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">sklearn_version</span>

    <span class="n">model</span><span class="o">.</span><span class="n">user_defined_metadata</span><span class="p">[</span><span class="n">_METADATA_VERSION</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct_version</span>
    <span class="n">model</span><span class="o">.</span><span class="n">user_defined_metadata</span><span class="p">[</span><span class="n">_METADATA_SOURCE</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn==</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">sklearn_version</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Apple Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>