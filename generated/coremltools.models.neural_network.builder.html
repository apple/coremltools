

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>coremltools.models.neural_network.builder &mdash; coremltools 3.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
        <script type="text/javascript" src="../static/jquery.js"></script>
        <script type="text/javascript" src="../static/underscore.js"></script>
        <script type="text/javascript" src="../static/doctools.js"></script>
        <script type="text/javascript" src="../static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="coremltools.models.neural_network.flexible_shape_utils" href="coremltools.models.neural_network.flexible_shape_utils.html" />
    <link rel="prev" title="coremltools.models.nearest_neighbors.builder" href="coremltools.models.nearest_neighbors.builder.html" />
    <link href="../static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> coremltools
          

          
          </a>

          
            
            
              <div class="version">
                3.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../coremltools.converters.html">Converters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="coremltools.converters.caffe.convert.html">coremltools.converters.caffe.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.converters.libsvm.convert.html">coremltools.converters.libsvm.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.converters.sklearn.convert.html">coremltools.converters.sklearn.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.converters.xgboost.convert.html">coremltools.converters.xgboost.convert</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../coremltools.models.html">Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.MLModel.html">coremltools.models.MLModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.pipeline.html">coremltools.models.pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.tree_ensemble.html">coremltools.models.tree_ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.nearest_neighbors.builder.html">coremltools.models.nearest_neighbors.builder</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">coremltools.models.neural_network.builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.neural_network.flexible_shape_utils.html">coremltools.models.neural_network.flexible_shape_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.neural_network.quantization_utils.html">coremltools.models.neural_network.quantization_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.neural_network.update_optimizer_utils.html">coremltools.models.neural_network.update_optimizer_utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coremltools.utils.html">Utilities</a><ul class="simple">
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coremltools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../coremltools.models.html">Models</a> &raquo;</li>
        
      <li>coremltools.models.neural_network.builder</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../sources/generated/coremltools.models.neural_network.builder.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-coremltools.models.neural_network.builder">
<span id="coremltools-models-neural-network-builder"></span><h1>coremltools.models.neural_network.builder<a class="headerlink" href="#module-coremltools.models.neural_network.builder" title="Permalink to this headline">¶</a></h1>
<p>Neural network builder class to construct Core ML models.</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeuralNetworkBuilder</span></code></a>([input_features,&nbsp;…])</td>
<td>Neural network builder class to construct Core ML models.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder">
<em class="property">class </em><code class="descclassname">coremltools.models.neural_network.builder.</code><code class="descname">NeuralNetworkBuilder</code><span class="sig-paren">(</span><em>input_features=None</em>, <em>output_features=None</em>, <em>mode=None</em>, <em>spec=None</em>, <em>nn_spec=None</em>, <em>disable_rank5_shape_mapping=False</em>, <em>training_features=None</em>, <em>use_float_arraytype=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural network builder class to construct Core ML models.</p>
<p>The NeuralNetworkBuilder constructs a Core ML neural network specification
layer by layer. The layers should be added in such an order that the inputs
to each layer (referred to as blobs) of each layer has been previously
defined. The builder can also set pre-processing steps to handle
specialized input format (e.g. images), and set class labels for neural
network classifiers.
Refer to the protobuf messages in specification (NeuralNetwork.proto) for more details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">MLModel</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">datatypes</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">save_spec</span></code></dt>
<dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">datatypes</span><span class="p">,</span> <span class="n">NeuralNetworkBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a neural network binary classifier that classifies</span>
<span class="c1"># 3-dimensional data points</span>
<span class="c1"># Specify input and output dimensions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>

<span class="c1"># Specify input and output features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">input_dim</span><span class="p">))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">output_dim</span><span class="p">))]</span>

<span class="c1"># Build a simple neural network with 1 inner product layer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_inner_product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ip_layer&#39;</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">input_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;probs&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;network.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>self</em>, <em>input_features=None</em>, <em>output_features=None</em>, <em>mode=None</em>, <em>spec=None</em>, <em>nn_spec=None</em>, <em>disable_rank5_shape_mapping=False</em>, <em>training_features=None</em>, <em>use_float_arraytype=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a NeuralNetworkBuilder object to build an MLModel specification with
model interface or a NeuralNetwork protobuf message, either from scratch or an
existing specification.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>input_features: [(str, datatypes.Array)] or None</strong></dt>
<dd><p class="first last">List of input feature of the network. Each feature is a (name,
array) tuple, where name the name of the feature, and array
is an datatypes.Array object describing the feature type.
When spec is None (building from scratch), input_features must not be None.
When spec is not None, input_features will be ignored; input feature of
existing spec will be used instead.</p>
</dd>
<dt><strong>output_features: [(str, datatypes.Array or None)] or None</strong></dt>
<dd><p class="first last">List of output feature of the network. Each feature is a (name,
array) tuple, where name is the name of the feature, and array
is an datatypes.Array object describing the feature type.
array can be None if not known.
When spec is None (building from scratch), output_features must not be None.
When spec is not None, output_features will be ignored; output feature of
existing spec will be used instead.</p>
</dd>
<dt><strong>mode: str (‘classifier’, ‘regressor’ or None)</strong></dt>
<dd><p class="first">Mode (one of ‘classifier’, ‘regressor’, or None).</p>
<p class="last">When mode = ‘classifier’, a NeuralNetworkClassifier spec will be
constructed.  When mode = ‘regressor’, a NeuralNetworkRegressor
spec will be constructed.</p>
</dd>
<dt><strong>disable_rank5_shape_mapping: bool</strong></dt>
<dd><p class="first last">Only applicable for neural networks.
If True, inputs are no longer forced to map to rank 5 tensors
(rank is equal to the length of the shape of the tensor).
Instead, for multi-array inputs “EXACT_ARRAY_MAPPING” mapping is used, whereas
for image inputs “RANK4_IMAGE_MAPPING” is used.
For details, see description of enums “NeuralNetworkMultiArrayShapeMapping”
and “NeuralNetworkImageShapeMapping” in NeuralNetwork.proto.
When spec is not None, this argument will be ignored.</p>
</dd>
<dt><strong>spec: None or coremltools.proto.Model_pb2</strong></dt>
<dd><p class="first last">If None, a new MLModel spec will be created by the builder with input and output features.
Otherwise, the builder will continue to build on spec. This is useful when the MLModel is
built incrementally.</p>
</dd>
<dt><strong>nn_spec: None or coremltools.proto.NeuralNetwork_pb2</strong></dt>
<dd><p class="first last">If None, a new, empty NeuralNetwork proto will be created for spec.
If nn_spec is not None and spec is None, the builder will build a NeuralNetwork spec without
wrapping it within an MLModel. This is useful to create nested NeuralNetworks for models
with control flow operations.</p>
</dd>
<dt><strong>use_float_arraytype: bool</strong></dt>
<dd><p class="first last">If true, the datatype of input/output multiarrays is set to Float32 instead
of double.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt>
<dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct a builder that builds a neural network classifier with a 299 x 299 x 3</span>
<span class="c1"># dimensional input and 1000 dimensional output</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">299</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">1000</span><span class="p">,)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;classifier&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos">
<code class="descname">add_acos</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an acos layer to the model that computes element-wise arc-cosine
for the input tensor.
Refer to the <strong>AcosLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh">
<code class="descname">add_acosh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an acosh layer to the model that computes element-wise inverse
hyperbolic cosine for the input tensor.
Refer to the <strong>AcoshLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation">
<code class="descname">add_activation</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>non_linearity</em>, <em>input_name</em>, <em>output_name</em>, <em>params=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an activation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>non_linearity: str</strong></dt>
<dd><p class="first">The non_linearity (activation) function of this layer.
It can be one of the following:</p>
<blockquote class="last">
<div><ul>
<li><p class="first">‘RELU’: Rectified Linear Unit (ReLU) function.</p>
</li>
<li><p class="first">‘SIGMOID’: sigmoid function.</p>
</li>
<li><p class="first">‘TANH’: tanh function.</p>
</li>
<li><p class="first">‘SCALED_TANH’: scaled tanh function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">tanh(beta</span> <span class="pre">*</span> <span class="pre">x)</span></code></p>
<p>where alpha and beta are constant scalars.</p>
</li>
<li><p class="first">‘SOFTPLUS’: softplus function.</p>
</li>
<li><p class="first">‘SOFTSIGN’: softsign function.</p>
</li>
<li><p class="first">‘SIGMOID_HARD’: hard sigmoid function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">min(max(alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta,</span> <span class="pre">-1),</span> <span class="pre">1)</span></code></p>
<p>where alpha and beta are constant scalars.</p>
</li>
<li><p class="first">‘LEAKYRELU’: leaky relu function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p class="first">‘PRELU’: Parametric ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a multi-dimensional array of same size as x.</p>
</li>
<li><p class="first">‘ELU’: Exponential linear unit function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">(alpha</span> <span class="pre">*</span> <span class="pre">exp(x)</span> <span class="pre">-</span> <span class="pre">1)</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p class="first">‘PARAMETRICSOFTPLUS’: Parametric softplus function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">log(1</span> <span class="pre">+</span> <span class="pre">exp(beta</span> <span class="pre">*</span> <span class="pre">x))</span></code></p>
<p>where alpha and beta are two multi-dimensional arrays of same size as x.</p>
</li>
<li><p class="first">‘THRESHOLDEDRELU’: Thresholded ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">alpha)</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where alpha is a constant scalar.</p>
</li>
<li><p class="first">‘LINEAR’: linear function.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>params: list of float or numpy.array</strong></dt>
<dd><p class="first">Parameters for the activation, depending on non_linearity.</p>
<blockquote class="last">
<div><ul class="simple">
<li>When non_linearity is one of [‘RELU’, ‘SIGMOID’, ‘TANH’, ‘SCALED_TANH’, ‘SOFTPLUS’, ‘SOFTSIGN’], params is ignored.</li>
<li>When non_linearity is one of [‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’], param is a list of 2 floats
[alpha, beta].</li>
<li>When non_linearity is one of [‘LEAKYRELU’, ‘ELU’, ‘THRESHOLDEDRELU’], param is a list of 1 float
[alpha].</li>
<li>When non_linearity is ‘PRELU’, param is a list of 1 numpy array [alpha]. The shape of
alpha is (C,), where C is either the number of input channels or
1. When C = 1, same alpha is applied to all channels.</li>
<li>When non_linearity is ‘PARAMETRICSOFTPLUS’, param is a list of 2 numpy arrays [alpha,
beta]. The shape of alpha and beta is (C, ), where C is either
the number of input channels or 1. When C = 1, same alpha and
beta are applied to all channels.</li>
</ul>
</div></blockquote>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_softmax</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable">
<code class="descname">add_add_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an add_broadcastable layer to the model that performs element-wise
addition operation with broadcast support.
Refer to the <strong>AddBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax">
<code class="descname">add_argmax</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em>, <em>keepdims=True</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an argmax layer to the model that returns the indices of the maximum
value along a specified axis in the input tensor.
Refer to the <strong>ArgMaxLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">axis along which the argmax is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmin</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin">
<code class="descname">add_argmin</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em>, <em>keepdims=True</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an argmin layer to the model that returns the indices of the minimum
value along a specified axis in the input tensor.
Refer to the <strong>ArgMinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">axis along which the argmin is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmax</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin">
<code class="descname">add_asin</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an asin layer to the model that computes element-wise arc-sine for
the input tensor.
Refer to the <strong>AsinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh">
<code class="descname">add_asinh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an asinh layer to the model that computes element-wise inverse
hyperbolic sine for the input tensor.
Refer to the <strong>AsinhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan">
<code class="descname">add_atan</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atan layer to the model that computes element-wise arc-tangent
for the input tensor.
Refer to the <strong>AtanLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh">
<code class="descname">add_atanh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atanh layer to the model that computes element-wise inverse
hyperbolic tangent for the input tensor.
Refer to the <strong>AtanhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul">
<code class="descname">add_batched_mat_mul</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>transpose_a=False</em>, <em>transpose_b=False</em>, <em>weight_matrix_rows=0</em>, <em>weight_matrix_columns=0</em>, <em>W=None</em>, <em>bias=None</em>, <em>is_quantized_weight=False</em>, <em>quantization_type='linear'</em>, <em>nbits=8</em>, <em>quant_scale=None</em>, <em>quant_bias=None</em>, <em>quant_lut=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a N-D Batched Matrix Multiplication layer with numpy like broadcasting.
Refer to the <strong>BatchedMatMulLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>transpose_a: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to transpose A, default: false.</p>
</dd>
<dt><strong>transpose_b: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to transpose B, default: false.</p>
</dd>
<dt><strong>weight_matrix_rows: int, optional</strong></dt>
<dd><p class="first last">Must be equal to the last dimension of the input, default: 0.</p>
</dd>
<dt><strong>weight_matrix_columns: int, optional</strong></dt>
<dd><p class="first last">Must be equal to the last dimension of the output, default: 0.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes(), optional</strong></dt>
<dd><p class="first last">Weight matrix of shape (weight_matrix_rows, weight_matrix_columns)
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>bias: float32 numpy.array, optional</strong></dt>
<dd><p class="first last">Bias vector of shape (weight_matrix_columns,).</p>
</dd>
<dt><strong>Quantization arguments expected in kwargs, when W is of type bytes():</strong></dt>
<dd></dd>
<dt><strong>is_quantized_weight: bool, optional</strong></dt>
<dd><p class="first last">Set it to true when W is of type bytes(), representing quantized weights, default: false.</p>
</dd>
<dt><strong>quantization_type: str, optional</strong></dt>
<dd><p class="first last">When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”, default: linear.</p>
</dd>
<dt><strong>nbits: int, optional</strong></dt>
<dd><p class="first last">Should be between 1 and 8 (inclusive). Number of bits per weight value, default: 8.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32), optional</strong></dt>
<dd><p class="first last">scale vector to be used with linear quantization. Must be of length either 1 or weight_matrix_columns, default: None.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32), optional</strong></dt>
<dd><p class="first last">bias vector to be used with linear quantization. Must be of length either 1 or weight_matrix_columns, default: None.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32), optional</strong></dt>
<dd><p class="first last">The LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits, default: None.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm">
<code class="descname">add_batchnorm</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>channels</em>, <em>gamma</em>, <em>beta</em>, <em>mean=None</em>, <em>variance=None</em>, <em>input_name='data'</em>, <em>output_name='out'</em>, <em>compute_mean_var=False</em>, <em>instance_normalization=False</em>, <em>epsilon=1e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a batch normalization layer. Batch normalization operation is
defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">gamma</span> <span class="pre">*</span> <span class="pre">(x</span> <span class="pre">-</span> <span class="pre">mean)</span> <span class="pre">/</span> <span class="pre">sqrt(variance</span> <span class="pre">+</span> <span class="pre">epsilon)</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
<p>Refer to the <strong>BatchnormLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>channels: int</strong></dt>
<dd><p class="first last">Number of channels of the input blob.</p>
</dd>
<dt><strong>gamma: numpy.array</strong></dt>
<dd><p class="first last">Values of gamma. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>beta: numpy.array</strong></dt>
<dd><p class="first last">Values of beta. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>mean: numpy.array</strong></dt>
<dd><p class="first last">Means of the input blob on each channel. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>variance:</strong></dt>
<dd><p class="first last">Variances of the input blob on each channel. Must be numpy array of shape (channels, ).</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>compute_mean_var: bool</strong></dt>
<dd><p class="first last">Set to True if mean and variance is to be computed from the input data.</p>
</dd>
<dt><strong>instance_normalization: bool</strong></dt>
<dd><p class="first last">Set compute_mean_var and this to True to perform
instance normalization i.e., mean and variance are computed from the single input instance.</p>
</dd>
<dt><strong>epsilon: float</strong></dt>
<dd><p class="first last">Value of epsilon. Defaults to 1e-5 if not specified.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias">
<code class="descname">add_bias</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>b</em>, <em>input_name</em>, <em>output_name</em>, <em>shape_bias=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bias layer to the model.
Refer to the <strong>BiasLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt>
<dd><p class="first last">Bias to add to the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt>
<dd><p class="first last">List of ints that specifies the shape of the bias parameter (if present). Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scale</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm">
<code class="descname">add_bidirlstm</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W_h</em>, <em>W_x</em>, <em>b</em>, <em>W_h_back</em>, <em>W_x_back</em>, <em>b_back</em>, <em>hidden_size</em>, <em>input_size</em>, <em>input_names</em>, <em>output_names</em>, <em>inner_activation='SIGMOID'</em>, <em>cell_state_update_activation='TANH'</em>, <em>output_activation='TANH'</em>, <em>peep=None</em>, <em>peep_back=None</em>, <em>output_all=False</em>, <em>forget_bias=False</em>, <em>coupled_input_forget_gate=False</em>, <em>cell_clip_threshold=50000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Bi-directional LSTM layer to the model.
Refer to the <strong>BiDirectionalLSTMLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt>
<dd><p class="first last">List of recursion weight matrices for the forward layer. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt>
<dd><p class="first last">List of input weight matrices for the forward layer. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array]</strong></dt>
<dd><p class="first last">List of biases for the forward layer. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>W_h_back: [numpy.array]</strong></dt>
<dd><p class="first last">List of recursion weight matrices for the backward layer. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x_back: [numpy.array]</strong></dt>
<dd><p class="first last">List of input weight matrices for the backward layer. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b_back: [numpy.array]</strong></dt>
<dd><p class="first last">List of biases for the backward layer. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
The shapes of the biases (hidden_size).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt>
<dd><p class="first last">Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt>
<dd><p class="first last">Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer, in the order of [x, h_input, c_input, h_reverse_input, c_reverse_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names of this layer, in the order of [y, h_output, c_output, h_reverse_output, c_reverse_output].</p>
</dd>
<dt><strong>inner_activation: str</strong></dt>
<dd><p class="first last">Inner activation function used at input and forget gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘SIGMOID’.</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt>
<dd><p class="first last">Cell state update activation function used at the cell state update gate.
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.</p>
</dd>
<dt><strong>output_activation: str</strong></dt>
<dd><p class="first last">Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt>
<dd><p class="first last">List of peephole vectors for the forward layer. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,). Defaults to None.</p>
</dd>
<dt><strong>peep_back: [numpy.array] or None</strong></dt>
<dd><p class="first last">List of peephole vectors for the backward layer. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,). Defaults to None.</p>
</dd>
<dt><strong>output_all: boolean</strong></dt>
<dd><p class="first">Whether the LSTM layer should output at every time step. Defaults to False.</p>
<ul class="last simple">
<li>If False, the output is the result after the final state update.</li>
<li>If True, the output is a sequence, containing outputs at all time steps.</li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt>
<dd><p class="first last">If True, a vector of 1s is added to forget gate bias. Defaults to False.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt>
<dd><p class="first last">If True, the input gate and forget gate is coupled. i.e. forget gate is not used.
Defaults to False.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt>
<dd><p class="first last">The limit on the maximum and minimum values on the cell state.
Defaults to 50.0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch">
<code class="descname">add_branch</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>if_branch=None</em>, <em>else_branch=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a branch layer to the model that provides the functionality of
branching or an <code class="docutils literal notranslate"><span class="pre">if-else</span></code> block.
Refer to the <strong>BranchLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>if_branch: NeuralNetwork</strong></dt>
<dd><p class="first last">Neural network to execute if the absolute value of the input tensor is greater than 1e-6.</p>
</dd>
<dt><strong>else_branch: NeuralNetwork, optional</strong></dt>
<dd><p class="first last">Neural network to execute if the absolute value of the input tensor is less than 1e-6.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic">
<code class="descname">add_broadcast_to_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_dynamic layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like">
<code class="descname">add_broadcast_to_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_like layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static">
<code class="descname">add_broadcast_to_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>output_shape</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a broadcast_to_static layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <strong>BroadcastToStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">The target shape of the output tensor.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution">
<code class="descname">add_categorical_distribution</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>num_samples</em>, <em>is_logits=True</em>, <em>eps=1e-10</em>, <em>temperature=1.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a categorical_distribution layer to the model that fills the output
tensor with random values from categorical distribution.
Refer to the <strong>CategoricalDistributionLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>num_samples: int</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.</p>
</dd>
<dt><strong>is_logits: bool, optional</strong></dt>
<dd><p class="first last">If true, the input is log probabilities. If false, the input is
probabilities, default: True</p>
</dd>
<dt><strong>eps: float, optional</strong></dt>
<dd><p class="first last">Epsilon parameter for categorical distribution, default 1e-10.</p>
</dd>
<dt><strong>temperature: float, optional</strong></dt>
<dd><p class="first last">Temperature parameter for categorical distribution, default 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil">
<code class="descname">add_ceil</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a ceil layer to the model that performs element-wise ceil operation
on the input tensor that rounds the value to the smallest integer not
less than x.
Refer to the <strong>CeilLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip">
<code class="descname">add_clip</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>min_value=0.0</em>, <em>max_value=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a clip layer to the model that performs element-wise clip operation.
Clip the values in the input tensor to the range [min_value, max_value].
Refer to the <strong>ClipLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>min_value: float, optional</strong></dt>
<dd><p class="first last">Lower bound / minimum value for clip, default: 0.0.</p>
</dd>
<dt><strong>max_value: float, optional</strong></dt>
<dd><p class="first last">Upper bound / maximum value for clip, default: 1.0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd">
<code class="descname">add_concat_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a concat_nd layer to the model that performs concatenation along the
given axis.
Refer to the <strong>ConcatNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">Axis to perform the concat operation on.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad">
<code class="descname">add_constant_pad</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>value=0.0</em>, <em>pad_to_given_output_size_mode=False</em>, <em>pad_amounts=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constant pad layer.
Refer to the <strong>ConstantPaddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>value: float</strong></dt>
<dd><p class="first last">value to be used for padding.</p>
</dd>
<dt><strong>pad_to_given_output_size_mode: bool</strong></dt>
<dd><p class="first last">if true, pad_amounts are interpreted as output shapes (see example in NeuralNetwork.proto)</p>
</dd>
<dt><strong>pad_amounts: [int], optional</strong></dt>
<dd><p class="first last">must be non negative. Amount to pad in each dimension. Length of the list must be twice the input/output rank.
Not required if second input is present.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution">
<code class="descname">add_convolution</code><span class="sig-paren">(</span><em>self, name, kernel_channels, output_channels, height, width, stride_height, stride_width, border_mode, groups, W, b, has_bias, is_deconv=False, output_shape=None, input_name='data', output_name='out', dilation_factors=[1, 1], padding_top=0, padding_bottom=0, padding_left=0, padding_right=0, same_padding_asymmetry_mode='BOTTOM_RIGHT_HEAVY', **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a convolution layer to the network.
Refer to the <strong>ConvolutionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>kernel_channels: int</strong></dt>
<dd><p class="first last">Number of channels for the convolution kernels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt>
<dd><p class="first last">Number of filter kernels. This is equal to the number of channels in the output blob.</p>
</dd>
<dt><strong>height: int</strong></dt>
<dd><p class="first last">Height of each kernel.</p>
</dd>
<dt><strong>width: int</strong></dt>
<dd><p class="first last">Width of each kernel.</p>
</dd>
<dt><strong>stride_height: int</strong></dt>
<dd><p class="first last">Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt>
<dd><p class="first last">Stride along the height direction.</p>
</dd>
<dt><strong>border_mode: str</strong></dt>
<dd><p class="first last">Option for the padding type and output blob shape. Can be either ‘valid’ or ‘same’.</p>
</dd>
<dt><strong>groups: int</strong></dt>
<dd><p class="first last">Number of kernel groups. Input is divided into groups along the channel axis. Each kernel group share the same weights.</p>
</dd>
<dt><strong>W: numpy.array or bytes() or None</strong></dt>
<dd><p class="first">Weight of the convolution kernels.</p>
<ul class="simple">
<li>If is_deconv is False, W should have shape (height, width, kernel_channels, output_channels), where kernel_channel = input_channels / groups</li>
<li>If is_deconv is True, W should have shape (height, width, kernel_channels, output_channels / groups), where kernel_channel = input_channels</li>
</ul>
<p class="last">If W is of type bytes(), i.e. quantized, other quantization related arguments must be provided as well (see below).
For Core ML specification version &gt;=4, W can be None. In this case,
the convolution layer takes 2 inputs, where the 1st input represents the input feature map,
the 2nd input represents the weight blob.</p>
</dd>
<dt><strong>b: numpy.array</strong></dt>
<dd><p class="first last">Biases of the convolution kernels. b should have shape (outputChannels, ).</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt>
<dd><p class="first">Whether bias is ignored.</p>
<ul class="last simple">
<li>If True, bias is not ignored.</li>
<li>If False, bias is ignored.</li>
</ul>
</dd>
<dt><strong>is_deconv: boolean</strong></dt>
<dd><p class="first">Whether the convolution layer is performing a convolution or a transposed convolution (deconvolution).</p>
<ul class="last simple">
<li>If True, the convolution layer is performing transposed convolution.</li>
<li>If False, the convolution layer is performing regular convolution.</li>
</ul>
</dd>
<dt><strong>output_shape: tuple or None</strong></dt>
<dd><p class="first last">Either None or a 2-tuple, specifying the output shape (output_height, output_width). Used only when is_deconv == True.
When is_deconv == False, this parameter is ignored.
If it is None, the output shape is calculated automatically using the border_mode.</p>
</dd>
<dt><strong>input_name: str or list of str</strong></dt>
<dd><p class="first last">The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>dilation_factors: list of int</strong></dt>
<dd><p class="first last">Dilation factors across height and width directions. Must be a list of two positive integers.
Defaults to [1, 1]</p>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt>
<dd><p class="first last">values of height (top, bottom) and width (left, right) padding to be used if border_more is “valid”.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str.</strong></dt>
<dd><p class="first last">Type of asymmetric padding to be used when  border_mode is ‘same’.
Can be either ‘BOTTOM_RIGHT_HEAVY’ or  ‘TOP_LEFT_HEAVY’.</p>
</dd>
<dt><strong>Depthwise convolution is a special case of convolution, where we have:</strong></dt>
<dd><p class="first last">kernel_channels = 1 (== input_channels / groups)
output_channels = channel_multiplier * input_channels
groups = input_channels
W: [Kernel_height, Kernel_width, 1, channel_multiplier * input_channels]</p>
</dd>
<dt><strong>Quantization arguments expected in kwargs, when W is of type bytes():</strong></dt>
<dd><dl class="first last docutils">
<dt>quantization_type: str</dt>
<dd><p class="first last">When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt>nbits: int</dt>
<dd><p class="first last">Should be between 1 and 8 (inclusive). Number of bits per weight value. Only applicable when
weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batchnorm</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy">
<code class="descname">add_copy</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a copy layer to the model that copies its input tensor to the output
tensor. Input tensor and output tensor must have distinct names.
Refer to the <strong>CopyLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos">
<code class="descname">add_cos</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a cos layer to the model that computes element-wise cosine for the
input tensor.
Refer to the <strong>CosLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh">
<code class="descname">add_cosh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a osh layer to the model that computes element-wise hyperbolic
cosine for the input tensor.
Refer to the <strong>CoshLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop">
<code class="descname">add_crop</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>left</em>, <em>right</em>, <em>top</em>, <em>bottom</em>, <em>offset</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a cropping layer to the model.
The cropping layer have two functional modes:</p>
<blockquote>
<div><ul class="simple">
<li>When it has 1 input blob, it crops the input blob based
on the 4 parameters [left, right, top, bottom].</li>
<li>When it has 2 input blobs, it crops the first input blob based
on the dimension of the second blob with an offset.</li>
</ul>
</div></blockquote>
<p>Refer to the <strong>CropLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt>
<dd><p class="first last">Number of elements to be cropped on the left side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>right: int</strong></dt>
<dd><p class="first last">Number of elements to be cropped on the right side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>top: int</strong></dt>
<dd><p class="first last">Number of elements to be cropped on the top of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>bottom: int</strong></dt>
<dd><p class="first last">Number of elements to be cropped on the bottom of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>offset: list of int</strong></dt>
<dd><p class="first last">Offset along the height and width directions when the crop layer takes 2 inputs. Must be a list of length 2.
When the crop layer takes 1 input, this parameter is ignored.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer. Must be either a list of 1 string (1 input crop layer),
or a list of 2 strings (2-input crop layer).</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize">
<code class="descname">add_crop_resize</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>target_height=1</em>, <em>target_width=1</em>, <em>mode='STRICT_ALIGN_ENDPOINTS_MODE'</em>, <em>normalized_roi=False</em>, <em>box_indices_mode='CORNERS_HEIGHT_FIRST'</em>, <em>spatial_scale=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a crop resize layer to the model. A layer that extracts cropped spatial patches or RoIs (regions of interest)
from the input and resizes them to a pre-specified size using bilinear interpolation.
Note that RoI Align layer can be implemented with this layer followed by a pooling layer.
Refer to the <strong>CropResizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">Must be a list of two names: image feature map and crop indices/RoI input.
First input corresponds to a blob with shape <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">Batch,</span> <span class="pre">C,</span> <span class="pre">H_in,</span> <span class="pre">W_in]</span></code>. This represents a batch of input image feature data with C channels.
The second input shape must be <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">1,</span> <span class="pre">1]</span></code> or <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>. This represents the bounding box coordinates for N patches/RoIs.
N: number of patches/RoIs to be extracted
If RoI shape = [N, 1, 4, 1, 1]
The channel axis corresponds to the four coordinates specifying the bounding box.
All the N~ RoIs are extracted from all the batches of the input.
If RoI shape = [N, 1, 5, 1, 1]
The first element of the channel axis specifies the input batch id from which to extract the RoI and
must be in the interval <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">Batch</span> <span class="pre">-</span> <span class="pre">1]</span></code>. That is, n-th RoI is extracted from the RoI[n,0,0,0]-th input batch id.
The last four elements of the channel axis specify the bounding box coordinates.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt>
<dd><p class="first last">Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt>
<dd><p class="first last">Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Following values are supported: ‘STRICT_ALIGN_ENDPOINTS_MODE’, ‘ALIGN_ENDPOINTS_MODE’, ‘UPSAMPLE_MODE’, ‘ROI_ALIGN_MODE’.
This parameter determines the sampling grid used for bilinear interpolation.</p>
</dd>
<dt><strong>normalized_roi: bool</strong></dt>
<dd><p class="first last">If true the bounding box coordinates must be in the interval [0, 1].
They are scaled by (input_height - 1), (input_width - 1), i.e. based on the input spatial dimensions.
If false the bounding box coordinates must be in the interval
[0, input_height - 1] and [0, input_width - 1], respectively for height and width dimensions.</p>
</dd>
<dt><strong>box_indices_mode: str</strong></dt>
<dd><p class="first last">Following values are supported: ‘CORNERS_HEIGHT_FIRST’, ‘CORNERS_WIDTH_FIRST’, ‘CENTER_SIZE_HEIGHT_FIRST’, ‘CENTER_SIZE_WIDTH_FIRST’
Representation used to interpret the bounding box coordinates (RoI) input.
‘CORNERS_HEIGHT_FIRST’: [h_start, w_start, h_end, w_end]
‘CORNERS_WIDTH_FIRST’: [w_start, h_start, w_end, h_end]
‘CENTER_SIZE_HEIGHT_FIRST’: [h_center, w_center, box_height, box_width]
‘CENTER_SIZE_WIDTH_FIRST’: [w_center, h_center, box_width, box_height]</p>
</dd>
<dt><strong>spatial_scale: float</strong></dt>
<dd><p class="first last">Additional spatial scale that multiplies the bounding box coordinates.
Generally used while implementing the RoI Align layer,
which uses unnormalized RoI coordinates along with a spatial scale less than or equal to 1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_resize_bilinear</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom">
<code class="descname">add_custom</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_names</em>, <em>custom_proto_spec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a custom layer.
Refer to the <strong>CustomLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names to this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names from this layer.</p>
</dd>
<dt><strong>custom_proto_spec: CustomLayerParams</strong></dt>
<dd><p class="first last">A protobuf CustomLayerParams message. This can also be left blank and filled in later.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable">
<code class="descname">add_divide_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a divide_broadcastable layer to the model that performs element-wise
division operation with broadcast support.
Refer to the <strong>DivideBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise">
<code class="descname">add_elementwise</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>mode</em>, <em>alpha=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an element-wise operation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">A list of input blob names of this layer. The input blobs should have the same shape.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first">A string specifying the mode of the elementwise layer. It can be one of the following:</p>
<ul class="last simple">
<li>‘CONCAT’: concatenate input blobs along the channel axis.</li>
<li>‘SEQUENCE_CONCAT’: concatenate input blobs along the sequence axis.</li>
<li>‘ADD’: perform an element-wise summation over the input blobs.</li>
<li>‘MULTIPLY’: perform an element-wise multiplication over the input blobs.</li>
<li>‘DOT’: compute the dot product of the two input blobs. In this mode, the length of input_names should be 2.</li>
<li>‘COS’: compute the cosine similarity of the two input blobs. In this mode, the length of input_names should be 2.</li>
<li>‘MAX’: compute the element-wise maximum over the input blobs.</li>
<li>‘MIN’: compute the element-wise minimum over the input blobs.</li>
<li>‘AVE’: compute the element-wise average over the input blobs.</li>
</ul>
</dd>
<dt><strong>alpha: float</strong></dt>
<dd><p class="first last">if mode == ‘ADD’ and there is only one input_name, alpha is added to the input
if mode == ‘MULTIPLY’ and there is only one input_name, alpha is multiplied to the input</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sequence_repeat</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding">
<code class="descname">add_embedding</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W</em>, <em>b</em>, <em>input_dim</em>, <em>output_channels</em>, <em>has_bias</em>, <em>input_name</em>, <em>output_name</em>, <em>is_quantized_weight=False</em>, <em>quantization_type='linear'</em>, <em>nbits=8</em>, <em>quant_scale=None</em>, <em>quant_bias=None</em>, <em>quant_lut=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an embedding layer to the model.
Refer to the <strong>EmbeddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt>
<dd><p class="first last">Weight matrix of shape (output_channels, input_dim).
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt>
<dd><p class="first last">Bias vector of shape (output_channels, ).</p>
</dd>
<dt><strong>input_dim: int</strong></dt>
<dd><p class="first last">Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>output_channels: int</strong></dt>
<dd><p class="first last">Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt>
<dd><p class="first">Whether the bias vector of this layer is ignored in the spec.</p>
<ul class="last simple">
<li>If True, the bias vector of this layer is not ignored.</li>
<li>If False, the bias vector is ignored.</li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments expected, when W is of type bytes():</strong></dt>
<dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt>
<dd><p class="first last">Set it to true when W is of type bytes(), representing quantized weights</p>
</dd>
<dt><strong>quantization_type: str</strong></dt>
<dd><p class="first last">When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt><strong>nbits: int</strong></dt>
<dd><p class="first last">Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd">
<code class="descname">add_embedding_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>vocab_size</em>, <em>embedding_size</em>, <em>W</em>, <em>b=None</em>, <em>is_quantized_weight=False</em>, <em>quantization_type='linear'</em>, <em>nbits=8</em>, <em>quant_scale=None</em>, <em>quant_bias=None</em>, <em>quant_lut=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an embedding layer to the model that performs a matrix lookup and
optionally adds a bias.
Refer to the <strong>EmbeddingNDLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>vocab_size: int</strong></dt>
<dd><p class="first last">Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>embedding_size: int</strong></dt>
<dd><p class="first last">Size of the embedded vector.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt>
<dd><p class="first last">Weight matrix of shape (embedding_size, vocab_size).
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array , optional</strong></dt>
<dd><p class="first last">Bias vector of shape (embedding_size, ).</p>
</dd>
<dt><strong>Quantization arguments expected, when W is of type bytes():</strong></dt>
<dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt>
<dd><p class="first last">Set it to true when W is of type bytes(), representing quantized weights</p>
</dd>
<dt><strong>quantization_type: str</strong></dt>
<dd><p class="first last">When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt><strong>nbits: int</strong></dt>
<dd><p class="first last">Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">scale vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">bias vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt>
<dd><p class="first last">the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal">
<code class="descname">add_equal</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>alpha=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an equal layer to the model that performs the element-wise equal
(=) operation. Broadcasting is supported.
Refer to the <strong>EqualLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt>
<dd><p class="first last">y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf">
<code class="descname">add_erf</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an erf function (gaussian error function) layer to the model.
Refer to the <strong>ErfLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2">
<code class="descname">add_exp2</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an exp2 layer to the model that performs element-wise experiential operation.
Refer to the <strong>Exp2LayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims">
<code class="descname">add_expand_dims</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an expand dims layer to the model that increases the rank of the
input tensor by adding unit dimensions.
Refer to the <strong>ExpandDimsLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt>
<dd><p class="first last">Dimensions the operation perform on.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_squeeze</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic">
<code class="descname">add_fill_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>value=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_dynamic layer to the model that outputs a tensor filled
with a scalar value.
Refer to the <strong>FillDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt>
<dd><p class="first last">A scalar value for the fill operation, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like">
<code class="descname">add_fill_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>value=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_like layer to the model outputs a tensor filled with a
scalar value.
Refer to the <strong>FillLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt>
<dd><p class="first last">A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static">
<code class="descname">add_fill_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>output_shape</em>, <em>value=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a fill_static layer to the model that outputs a tensor filled
with a scalar value given shape as parameter.
Refer to the <strong>FillStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">The target shape of the output tensor.</p>
</dd>
<dt><strong>value: float, optional</strong></dt>
<dd><p class="first last">A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten">
<code class="descname">add_flatten</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>mode</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a flatten layer. Only flattens the channel, height and width axis. Leaves the sequence axis as is.
Refer to the <strong>FlattenLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>mode: int</strong></dt>
<dd><ul class="first last simple">
<li>If mode == 0, the flatten layer is in CHANNEL_FIRST mode.</li>
<li>If mode == 1, the flatten layer is in CHANNEL_LAST mode.</li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d">
<code class="descname">add_flatten_to_2d</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis=1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a flatten_to_2d layer to the model that flattens the input tensor
into a 2-dimensional matrix.
Refer to the <strong>FlattenTo2DLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt>
<dd><p class="first last">Axis to perform the operation, default: 1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor">
<code class="descname">add_floor</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a floor layer to the model that performs element-wise floor operation
on the input tensor that rounds the value to the largest integer not
greater than x.
Refer to the <strong>FloorLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable">
<code class="descname">add_floor_div_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a floor_div_broadcastable layer to the model that performs floor
division operation with broadcast support.
Refer to the <strong>FloorDivBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_divide_broadcastable</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather">
<code class="descname">add_gather</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input.
Refer to the <strong>GatherLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt>
<dd><p class="first last">The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis">
<code class="descname">add_gather_along_axis</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather_along_axis layer to the model that gathers elements or slices
from data and store to a tensor whose shape is defined by indices from the
input along the given axis into the output tensor.
Refer to the <strong>GatherAlongAxisLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt>
<dd><p class="first last">The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd">
<code class="descname">add_gather_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input. This is the reverse operation of the scatter operation.
Refer to the <strong>GatherNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu">
<code class="descname">add_gelu</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>mode='EXACT'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a GELU (gaussian error linear unit) activation layer, which is:
<code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">erf(x</span> <span class="pre">/</span> <span class="pre">sqrt(2)))</span></code>.
Refer to the <strong>GeluLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt>
<dd><p class="first last">Gelu mode in [EXACT | TANH_APPROXIMATION | SIGMOID_APPROXIMATION], default EXACT.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape">
<code class="descname">add_get_shape</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a get_shape layer to the model.
Refer to the <strong>GetShapeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than">
<code class="descname">add_greater_than</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>use_greater_than_equal=False</em>, <em>alpha=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a greater_than layer to the model that performs the element-wise
greater-than (&gt;) operation or greater-than-or-equal-to (&gt;=) operation.
Broadcasting is supported.
Refer to the <strong>GreaterThanLayerParams</strong>, <strong>GreaterEqualLayerParams</strong> messages
in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>use_greater_than_equal: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to allow greater than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt>
<dd><p class="first last">y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru">
<code class="descname">add_gru</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W_h</em>, <em>W_x</em>, <em>b</em>, <em>hidden_size</em>, <em>input_size</em>, <em>input_names</em>, <em>output_names</em>, <em>activation='TANH'</em>, <em>inner_activation='SIGMOID_HARD'</em>, <em>output_all=False</em>, <em>reverse_input=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Gated-Recurrent Unit (GRU) layer to the model.
Refer to the <strong>GRULayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt>
<dd><p class="first last">List of recursion weight matrices. The ordering is [R_z, R_r, R_o],
where R_z, R_r and R_o are weight matrices at update gate, reset gate and output gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt>
<dd><p class="first last">List of input weight matrices. The ordering is [W_z, W_r, W_o],
where W_z, W_r, and W_o are weight matrices at update gate, reset gate and output gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt>
<dd><p class="first last">List of biases of the GRU layer. The ordering is [b_z, b_r, b_o],
where b_z, b_r, b_o are biases at update gate, reset gate and output gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt>
<dd><p class="first last">Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt>
<dd><p class="first last">Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt>
<dd><p class="first last">Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘TANH’.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>inner_activation: str</strong></dt>
<dd><p class="first last">Inner activation function used at update and reset gates. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
Defaults to ‘SIGMOID_HARD’.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names list of this layer, in the order of [x, h_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names list of this layer, in the order of [y, h_output].</p>
</dd>
<dt><strong>output_all: boolean</strong></dt>
<dd><p class="first">Whether the recurrent layer should output at every time step.</p>
<ul class="last simple">
<li>If False, the output is the result after the final state update.</li>
<li>If True, the output is a sequence, containing outputs at all time steps.</li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt>
<dd><p class="first">Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="last simple">
<li>If False, the input sequence order is not reversed.</li>
<li>If True, the input sequence order is reversed.</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product">
<code class="descname">add_inner_product</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W</em>, <em>b</em>, <em>input_channels</em>, <em>output_channels</em>, <em>has_bias</em>, <em>input_name</em>, <em>output_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an inner product layer to the model.
Refer to the <strong>InnerProductLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W: numpy.array or bytes()</strong></dt>
<dd><p class="first last">Weight matrix of shape (output_channels, input_channels)
If W is of type bytes(), i.e. quantized, other quantization related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt>
<dd><p class="first last">Bias vector of shape (output_channels, ).</p>
</dd>
<dt><strong>input_channels: int</strong></dt>
<dd><p class="first last">Number of input channels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt>
<dd><p class="first last">Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt>
<dd><p class="first">Whether the bias vector of this layer is ignored in the spec.</p>
<ul class="last simple">
<li>If True, the bias vector of this layer is not ignored.</li>
<li>If False, the bias vector is ignored.</li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments expected in kwargs, when W is of type bytes():</strong></dt>
<dd><dl class="first last docutils">
<dt>quantization_type: str</dt>
<dd><p class="first last">When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt>nbits: int</dt>
<dd><p class="first last">Should be between 1 and 8 (inclusive). Number of bits per weight value. Only applicable when
weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">scale vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">bias vector to be used with linear quantization. Must be of length either 1 or output_channels.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt>
<dd><p class="first last">the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize">
<code class="descname">add_l2_normalize</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>epsilon=1e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Add L2 normalize layer. Normalizes the input by the L2 norm, i.e. divides by the
the square root of the sum of squares of all elements of the input along C, H and W dimensions.
Refer to the <strong>L2NormalizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>epsilon: float</strong></dt>
<dd><p class="first last">small bias to avoid division by zero.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization">
<code class="descname">add_layer_normalization</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>normalized_shape</em>, <em>gamma</em>, <em>beta</em>, <em>eps=1e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a layer normalization layer to the model that applies layer
normalization over the input tensor.
Refer to the <strong>LayerNormalizationLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>normalized_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Input shape from an expected input of size.</p>
</dd>
<dt><strong>gamma: WeightParams</strong></dt>
<dd><p class="first last">Weight parameters.</p>
</dd>
<dt><strong>beta: WeightParams</strong></dt>
<dd><p class="first last">Bias parameters.</p>
</dd>
<dt><strong>eps: float, optional</strong></dt>
<dd><p class="first last">Constant value added to the denominator, default: 1e-5.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than">
<code class="descname">add_less_than</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>use_less_than_equal=False</em>, <em>alpha=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a less_than layer to the model that performs the element-wise
less-than (&lt;) operation or less-than-or-equal-to (&lt;=) operation.
Broadcasting is supported.
Refer to the <strong>LessThanL_ayerParams</strong>, <strong>LessEqualLayerParams</strong> messages in
specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>use_less_than_equal: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to allow less than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt>
<dd><p class="first last">y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant">
<code class="descname">add_load_constant</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>constant_value</em>, <em>shape</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a load constant layer.
Refer to the <strong>LoadConstantLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array</strong></dt>
<dd><p class="first last">value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">List of ints representing the shape of the constant. Must be of length 3: [C,H,W]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd">
<code class="descname">add_load_constant_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>constant_value</em>, <em>shape</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a load_constant layer that loads data as a parameter and provides it
as an output.
Refer to the <strong>LoadConstantNDLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array()</strong></dt>
<dd><p class="first last">value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">List of ints representing the shape of the constant.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical">
<code class="descname">add_logical</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>mode</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a logical layer to the model that performs element-wise logical
and/or/xor/not operation. Broadcasting is supported.
Refer to the <strong>LogicalOrLayerParams, LogicalNotLayerParams,
LogicalNotLayerParams, LogicalAndLayerParam</strong> messages in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Logical operation mode in [AND | OR | XOR | NOT].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop">
<code class="descname">add_loop</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>body_network=None</em>, <em>input_name=None</em>, <em>condition=None</em>, <em>condition_network=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop layer to the model that provides the functionality of a <code class="docutils literal notranslate"><span class="pre">for</span></code>
loop, or a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop.
Refer to the <strong>LoopLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>body_network: NeuralNetwork</strong></dt>
<dd><p class="first last">Neural network to execute for the body of the loop.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>condition: str, optional</strong></dt>
<dd><p class="first last">Condition of the loop.</p>
</dd>
<dt><strong>condition_network: NeuralNetwork, optional</strong></dt>
<dd><p class="first last">Neural network to execute for the condition of the loop.</p>
</dd>
<dt><strong>max_iterations: int, optional</strong></dt>
<dd><p class="first last">Maximum number of iterations of the loop.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break">
<code class="descname">add_loop_break</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop_break layer to the model that terminates the loop that
contains this layer. Must reside in the <code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <strong>LoopBreakLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue">
<code class="descname">add_loop_continue</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a loop_continue layer to the model that stops the current loop
iteration and continue on the next iteration. Must reside in the
<code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <strong>LoopContinueLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular">
<code class="descname">add_lower_triangular</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>k=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a lower_triangular layer to the model that copies a tensor setting
everything outside lower triangular to zero.
Refer to the <strong>LowerTriangularLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt>
<dd><p class="first last">Diagonal below which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upper_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn">
<code class="descname">add_lrn</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>alpha</em>, <em>beta</em>, <em>local_size</em>, <em>k=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a LRN (local response normalization) layer. Supports “across” channels normalization.
Refer to the <strong>LRNLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float</strong></dt>
<dd><p class="first last">multiplicative constant in the denominator.</p>
</dd>
<dt><strong>beta: float</strong></dt>
<dd><p class="first last">exponent of the normalizing term in the denominator.</p>
</dd>
<dt><strong>k: float</strong></dt>
<dd><p class="first last">bias term in the denominator. Must be positive.</p>
</dd>
<dt><strong>local_size: int</strong></dt>
<dd><p class="first last">size of the neighborhood along the channel axis.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part">
<code class="descname">add_matrix_band_part</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>num_lower=-1</em>, <em>num_upper=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a matrix_band_part layer to the model that copies a tensor setting
everything outside a central band in each inner-most matrix to zero.
Refer to the <strong>MatrixBandPartLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>num_lower: int, optional</strong></dt>
<dd><p class="first last">Number of lower sub-diagonals to keep.
Default: -1 (keep entire lower triangle).</p>
</dd>
<dt><strong>num_upper: int, optional</strong></dt>
<dd><p class="first last">Number of upper sub-diagonals to keep.
Default: -1 (keep entire upper triangle).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable">
<code class="descname">add_max_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a max_broadcastable layer to the model that performs element-wise
maximum operation with broadcast support.
Refer to the <strong>MaxBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable">
<code class="descname">add_min_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a min_broadcastable layer to the model that performs element-wise
minimum operation with broadcast support.
Refer to the <strong>MinBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable">
<code class="descname">add_mod_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a mod_broadcastable layer to the model that performs element-wise
modular operation with broadcast support.
Refer to the <strong>ModBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable">
<code class="descname">add_multiply_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a multiply_broadcastable layer to the model that performs element-wise
multiplication operation with broadcast support.
Refer to the <strong>MultiplyBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn">
<code class="descname">add_mvn</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>across_channels=True</em>, <em>normalize_variance=True</em>, <em>epsilon=1e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an MVN (mean variance normalization) layer. Computes mean, variance and normalizes the input.
Refer to the <strong>MeanVarianceNormalizeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>across_channels: boolean</strong></dt>
<dd><p class="first last">If False, each channel plane is normalized separately
If True, mean/variance is computed across all C, H and W dimensions</p>
</dd>
<dt><strong>normalize_variance: boolean</strong></dt>
<dd><p class="first last">If False, only mean subtraction is performed.</p>
</dd>
<dt><strong>epsilon: float</strong></dt>
<dd><p class="first last">small bias to avoid division by zero.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms">
<code class="descname">add_nms</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_names</em>, <em>iou_threshold=0.5</em>, <em>score_threshold=0.0</em>, <em>max_boxes=1</em>, <em>per_class_suppression=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a non maximum suppression layer.
Refer to the <strong>NonMaximumSuppressionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer. Must be at least 2, and maximum 5.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names of this layer. Must be of length 4 exactly.</p>
</dd>
<dt><strong>iou_threshold: float</strong></dt>
<dd><p class="first last">intersection over union threshold for suppression. Ignored if 3rd input is present.</p>
</dd>
<dt><strong>score_threshold: float</strong></dt>
<dd><p class="first last">threshold for selecting boxes to be used for NMS algorithm. Ignored if 4th input is present.</p>
</dd>
<dt><strong>max_boxes: int</strong></dt>
<dd><p class="first last">maximum number of boxes to output. Ignored if 5th input is present.</p>
</dd>
<dt><strong>per_class_suppression: bool</strong></dt>
<dd><p class="first last">If true, boxes are organized into classes and suppression is applied to each class group separately</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal">
<code class="descname">add_not_equal</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>alpha=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a not_equal layer to the model that performs the element-wise not
equal (!=) operation. Broadcasting is supported.
Refer to the <strong>NotEqualLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt>
<dd><p class="first last">y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals">
<code class="descname">add_optionals</code><span class="sig-paren">(</span><em>self</em>, <em>optionals_in</em>, <em>optionals_out</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals" title="Permalink to this definition">¶</a></dt>
<dd><p>Add optional inputs and outputs to the model spec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>optionals_in: list of str</strong></dt>
<dd><p class="first last">List of inputs that are optionals.</p>
</dd>
<dt><strong>optionals_out: list of str</strong></dt>
<dd><p class="first last">List of outputs that are optionals.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding">
<code class="descname">add_padding</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>left=0</em>, <em>right=0</em>, <em>top=0</em>, <em>bottom=0</em>, <em>value=0</em>, <em>input_name='data'</em>, <em>output_name='out'</em>, <em>padding_type='constant'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a padding layer to the model that performs padding along spatial dimensions.
Refer to the <strong>PaddingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt>
<dd><p class="first last">Number of elements to be padded on the left side of the input blob.</p>
</dd>
<dt><strong>right: int</strong></dt>
<dd><p class="first last">Number of elements to be padded on the right side of the input blob.</p>
</dd>
<dt><strong>top: int</strong></dt>
<dd><p class="first last">Number of elements to be padded on the top of the input blob.</p>
</dd>
<dt><strong>bottom: int</strong></dt>
<dd><p class="first last">Number of elements to be padded on the bottom of the input blob.</p>
</dd>
<dt><strong>value: float</strong></dt>
<dd><p class="first last">Value of the elements padded. Used only when padding_type = ‘constant’</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>padding_type: str</strong></dt>
<dd><p class="first last">Type of the padding. Can be one of ‘constant’, ‘reflection’ or ‘replication’.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute">
<code class="descname">add_permute</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>dim</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a permute layer. Assumes that the input has dimensions in the order [Seq, C, H, W]
Refer to the <strong>PermuteLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>dim: tuple</strong></dt>
<dd><p class="first">The order in which to permute the input dimensions = [seq,C,H,W].
Must have length 4 and a permutation of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>.</p>
<p>examples:</p>
<p>Lets say input has shape: [seq, C, H, W].</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>,
then the output has shape <code class="docutils literal notranslate"><span class="pre">[W,C,H]</span></code>
and has the same sequence length that of the input.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">0]</span></code>,
and the input is a sequence of data
with length <code class="docutils literal notranslate"><span class="pre">Seq</span></code> and shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>,
then the output is a unit sequence of data with shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">Seq]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">2,</span> <span class="pre">1]</span></code>,
the output is a reverse of the input: <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">H,</span> <span class="pre">W]</span> <span class="pre">-&gt;</span> <span class="pre">[W,</span> <span class="pre">H,</span> <span class="pre">C]</span></code>.</p>
<p class="last">If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is not set, or is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>,
the output is the same as the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling">
<code class="descname">add_pooling</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>height</em>, <em>width</em>, <em>stride_height</em>, <em>stride_width</em>, <em>layer_type</em>, <em>padding_type</em>, <em>input_name</em>, <em>output_name</em>, <em>exclude_pad_area=True</em>, <em>is_global=False</em>, <em>padding_top=0</em>, <em>padding_bottom=0</em>, <em>padding_left=0</em>, <em>padding_right=0</em>, <em>same_padding_asymmetry_mode='BOTTOM_RIGHT_HEAVY'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pooling layer to the model that performs spatial pooling.
Refer to the <strong>PoolingLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>height: int</strong></dt>
<dd><p class="first last">Height of pooling region.</p>
</dd>
<dt><strong>width: int</strong></dt>
<dd><p class="first last">Width of pooling region.</p>
</dd>
<dt><strong>stride_height: int</strong></dt>
<dd><p class="first last">Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt>
<dd><p class="first last">Stride along the width direction.</p>
</dd>
<dt><strong>layer_type: str</strong></dt>
<dd><p class="first last">Type of pooling performed. Can either be ‘MAX’, ‘AVERAGE’ or ‘L2’.</p>
</dd>
<dt><strong>padding_type: str</strong></dt>
<dd><p class="first last">Option for the type of padding and output blob shape. Can be either ‘VALID’ , ‘SAME’ or ‘INCLUDE_LAST_PIXEL’.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>exclude_pad_area: boolean</strong></dt>
<dd><p class="first last">Whether to exclude padded area in the ‘AVERAGE’ pooling operation, default: true.
- If True, the value of the padded area will be excluded.
- If False, the padded area will be included.
This flag is only used with average pooling.</p>
</dd>
<dt><strong>is_global: boolean</strong></dt>
<dd><p class="first last">Whether the pooling operation is global. Defaults to False.
- If True, the pooling operation is global – the pooling region is of the same size of the input blob.
Parameters height, width, stride_height, stride_width will be ignored.
- If False, the pooling operation is not global.</p>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt>
<dd><p class="first last">values of height (top, bottom) and width (left, right) padding to be used if padding type is “VALID” or “INCLUDE_LAST_PIXEL”.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str.</strong></dt>
<dd><p class="first last">Type of asymmetric padding to be used when padding_type = ‘SAME’.
Can be either ‘BOTTOM_RIGHT_HEAVY’ or ‘TOP_LEFT_HEAVY’.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable">
<code class="descname">add_pow_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pow_broadcastable layer to the model that performs element-wise
power operation with broadcast support.
Refer to the <strong>PowBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic">
<code class="descname">add_random_bernoulli_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>prob=0.5</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_dynamic layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt>
<dd><p class="first last">Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like">
<code class="descname">add_random_bernoulli_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>prob=0.5</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_like layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt>
<dd><p class="first last">Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static">
<code class="descname">add_random_bernoulli_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>output_shape</em>, <em>prob=0.5</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_bernoulli_static layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <strong>RandomBernoulliStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Target shape of the output tensor.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt>
<dd><p class="first last">Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic">
<code class="descname">add_random_normal_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>mean=0.0</em>, <em>stddev=0.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_dynamic layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormalDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt>
<dd><p class="first last">The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt>
<dd><p class="first last">The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like">
<code class="descname">add_random_normal_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>mean=0.0</em>, <em>stddev=0.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_like layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormalLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt>
<dd><p class="first last">The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt>
<dd><p class="first last">The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution, default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static">
<code class="descname">add_random_normal_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>output_shape</em>, <em>mean=0.0</em>, <em>stddev=0.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_normal_static layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <strong>RandomNormaStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Target shape of the output tensor.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt>
<dd><p class="first last">The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt>
<dd><p class="first last">The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic">
<code class="descname">add_random_uniform_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>minval=0.0</em>, <em>maxval=1.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_dynamic layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt>
<dd><p class="first last">Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt>
<dd><p class="first last">Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like">
<code class="descname">add_random_uniform_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>minval=0.0</em>, <em>maxval=1.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_like layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt>
<dd><p class="first last">Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt>
<dd><p class="first last">Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static">
<code class="descname">add_random_uniform_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>output_shape</em>, <em>minval=0.0</em>, <em>maxval=1.0</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a random_uniform_static layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <strong>RandomUniformStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Target shape of the output tensor.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt>
<dd><p class="first last">Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt>
<dd><p class="first last">Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt>
<dd><p class="first last">Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic">
<code class="descname">add_range_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>start=0</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a range_dynamic layer that returns a tensor that contains evenly spaced values.
This layer has up to three inputs or no input and three parameters.
Refer to the <strong>RangeDynamicLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names.
If input size == 1: end is input, start and step are read from parameters
If input size == 2: end, start are inputs, step is read from parameters
If input size == 3: start, end, step are all inputs, none of the parameters are used.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>start: int, optional</strong></dt>
<dd><p class="first last">Range parameter: start. Ignored if start is provided as input, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt>
<dd><p class="first last">Range parameter: step. Ignored if step is provided as input, default: 1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static">
<code class="descname">add_range_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>output_name</em>, <em>input_names=None</em>, <em>end=1</em>, <em>start=0</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a range_static layer that returns a tensor that contains evenly spaced values.
This layer has no input and three parameters.
Refer to the <strong>RangeStaticLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>end: int, optional</strong></dt>
<dd><p class="first last">Range parameter: end, default: 1.</p>
</dd>
<dt><strong>start: int, optional</strong></dt>
<dd><p class="first last">Range parameter: start, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt>
<dd><p class="first last">Range parameter: step size, default: 1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape">
<code class="descname">add_rank_preserving_reshape</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>output_shape</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rank_preserving_reshape layer to the model that reshapes the input
tensor without altering the rank of the tensor.
Refer to the <strong>RankPreservingReshapeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Determines the shape of the output blob.
0: copy the dimension of the input to output
-1: calculate dimensions from the rest of the shape</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce">
<code class="descname">add_reduce</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em>, <em>mode</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce layer. Applies the function specified by the parameter mode,
along dimension(s) specified by the parameter axis.
Refer to the <strong>ReduceLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt>
<dd><p class="first last">dimensions along which the reduction operation is applied.
Allowed values: ‘CHW’, ‘HW’, ‘C’, ‘H’, ‘W’</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Reduction operation to be applied.
Allowed values:
‘sum’, ‘avg’, ‘prod’, ‘logsum’, ‘sumsquare’, ‘L1’, ‘L2’, ‘max’, ‘min’, ‘argmax’.
‘argmax’ is only supported with axis values ‘C’, ‘H’ and ‘W’.</p>
</dd>
<dt><strong>epsilon: float</strong></dt>
<dd><p class="first last">number that is added to the input when ‘logsum’ function is applied.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1">
<code class="descname">add_reduce_l1</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_l1 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l1_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceL1LayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2">
<code class="descname">add_reduce_l2</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_l2 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l2_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceL2LayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum">
<code class="descname">add_reduce_logsum</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_logsum layer to the model that reduces the input tensor
using log(sum(elements across given dimensions)).
Refer to the <strong>ReduceLogSumLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp">
<code class="descname">add_reduce_logsumexp</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_logsumexp layer to the model that computes <code class="docutils literal notranslate"><span class="pre">log(sum(exp(tensor)))</span></code>
and reduces along the given axis.
Refer to the <strong>ReduceLogSumExpLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max">
<code class="descname">add_reduce_max</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_max layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">max(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMaxLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean">
<code class="descname">add_reduce_mean</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_mean layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">mean(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMeanLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min">
<code class="descname">add_reduce_min</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_min layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">min(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceMinLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod">
<code class="descname">add_reduce_prod</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_prod layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">prod(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceProdLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes. If axes list is empty, it will
be set to true, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum">
<code class="descname">add_reduce_sum</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_sum layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <strong>ReduceSumLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare">
<code class="descname">add_reduce_sumsquare</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>keepdims=True</em>, <em>reduce_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reduce_sumsquare layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(square(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions))</span></code>.
Refer to the <strong>ReduceSumSquareLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: None (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt>
<dd><p class="first last">Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt>
<dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data">
<code class="descname">add_reorganize_data</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>mode='SPACE_TO_DEPTH'</em>, <em>block_size=2</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a data reorganization layer of type “SPACE_TO_DEPTH” or “DEPTH_TO_SPACE”.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><ul class="first last simple">
<li>If mode == ‘SPACE_TO_DEPTH’: data is moved from the spatial to the channel dimension.
Input is spatially divided into non-overlapping blocks of size block_size X block_size
and data from each block is moved to the channel dimension.
Output CHW dimensions are: [C * block_size * block_size, H/block_size, C/block_size].</li>
<li>If mode == ‘DEPTH_TO_SPACE’: data is moved from the channel to the spatial dimension.
Reverse of the operation ‘SPACE_TO_DEPTH’.
Output CHW dimensions are: [C/(block_size * block_size), H * block_size, C * block_size].</li>
</ul>
</dd>
<dt><strong>block_size: int</strong></dt>
<dd><p class="first last">Must be greater than 1. Must divide H and W, when mode is ‘SPACE_TO_DEPTH’. (block_size * block_size)
must divide C when mode is ‘DEPTH_TO_SPACE’.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape">
<code class="descname">add_reshape</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>target_shape</em>, <em>mode</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape layer.
Refer to the <strong>ReshapeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>target_shape: tuple</strong></dt>
<dd><p class="first last">Shape of the output blob. The product of target_shape must be equal
to the shape of the input blob.
Can be either length 3 (C,H,W) or length 4 (Seq,C,H,W).</p>
</dd>
<dt><strong>mode: int</strong></dt>
<dd><ul class="first last simple">
<li>If mode == 0, the reshape layer is in CHANNEL_FIRST mode.</li>
<li>If mode == 1, the reshape layer is in CHANNEL_LAST mode.</li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic">
<code class="descname">add_reshape_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_dynamic layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeDynamicLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like">
<code class="descname">add_reshape_like</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_like layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeLikeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static">
<code class="descname">add_reshape_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>output_shape</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reshape_static layer to the model that reshapes a tensor.
Refer to the <strong>ReshapeStaticLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt>
<dd><p class="first last">Target shape of the output tensor.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear">
<code class="descname">add_resize_bilinear</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>target_height=1</em>, <em>target_width=1</em>, <em>mode='ALIGN_ENDPOINTS_MODE'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a resize bilinear layer to the model. A layer that resize the input to a given spatial size using bilinear interpolation.
Refer to the <strong>ResizeBilinearLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt>
<dd><p class="first last">Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt>
<dd><p class="first last">Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Following values are supported: ‘STRICT_ALIGN_ENDPOINTS_MODE’, ‘ALIGN_ENDPOINTS_MODE’, ‘UPSAMPLE_MODE’, ‘ROI_ALIGN_MODE’.
This parameter determines the sampling grid used for bilinear interpolation.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse">
<code class="descname">add_reverse</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>reverse_dim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reverse layer to the model that reverses specific dimensions of
the input tensor.
Refer to the <strong>ReverseLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>reverse_dim: list of int or tuple of int</strong></dt>
<dd><p class="first last">Reverse along the dimension, default [1].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse_sequence</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence">
<code class="descname">add_reverse_sequence</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>batch_axis=0</em>, <em>seq_axis=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reverse sequence layer to the model that reverses variable length slices.
Refer to the <strong>ReverseSeqLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>batch_axis: int, optional</strong></dt>
<dd><p class="first last">Slices input along the dimension batch_axis, default 0.</p>
</dd>
<dt><strong>seq_axis: int, optional</strong></dt>
<dd><p class="first last">Reverse along the dimension seq_axis, default: -1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round">
<code class="descname">add_round</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a round layer to the model that performs element-wise round operation
on the input tensor that rounds the value to the nearest integer.
Refer to the <strong>RoundLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale">
<code class="descname">add_scale</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W</em>, <em>b</em>, <em>has_bias</em>, <em>input_name</em>, <em>output_name</em>, <em>shape_scale=None</em>, <em>shape_bias=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scale layer to the model.
Refer to the <strong>ScaleLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W: int or numpy.array</strong></dt>
<dd><p class="first last">Scale of the input.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt>
<dd><p class="first last">Bias to add to the input.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt>
<dd><p class="first last">Whether the bias vector of this layer is ignored in the spec.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>shape_scale: list of int or tuple of int</strong></dt>
<dd><p class="first last">List of ints that specifies the shape of the scale parameter. Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt>
<dd><p class="first last">List of ints that specifies the shape of the bias parameter (if present). Can be [1] or [C] or [1,H,W] or [C,H,W].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bias</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter">
<code class="descname">add_scatter</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis=0</em>, <em>mode='UPDATE'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from the input.
Refer to the <strong>ScatterLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">The axis the operation perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt>
<dd><p class="first last">Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis">
<code class="descname">add_scatter_along_axis</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis=0</em>, <em>mode='UPDATE'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter_along_axis layer to the model that scatters data into a new
tensor according to indices from the input along the given axis into the
output tensor.
Refer to the <strong>ScatterAlongAxisLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">The axis to perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt>
<dd><p class="first last">Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd">
<code class="descname">add_scatter_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>mode='UPDATE'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from input. This is the reverse operation of the
gather operation.
Refer to the <strong>ScatterNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt>
<dd><p class="first last">Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat">
<code class="descname">add_sequence_repeat</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>nrep</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sequence repeat layer to the model.
Refer to the <strong>SequenceRepeatLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>nrep: int</strong></dt>
<dd><p class="first last">Number of repetitions of the input blob along the sequence axis.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign">
<code class="descname">add_sign</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sign layer to the model that performs element-wise sign operation
(+1 for positive values, -1 for negative values, 0 for zeroes).
Refer to the <strong>SignLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn">
<code class="descname">add_simple_rnn</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W_h</em>, <em>W_x</em>, <em>b</em>, <em>hidden_size</em>, <em>input_size</em>, <em>activation</em>, <em>input_names</em>, <em>output_names</em>, <em>output_all=False</em>, <em>reverse_input=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a simple recurrent layer to the model.
Refer to the <strong>SimpleRecurrentLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W_h: numpy.array</strong></dt>
<dd><p class="first last">Weights of the recurrent layer’s hidden state. Must be of shape (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: numpy.array</strong></dt>
<dd><p class="first last">Weights of the recurrent layer’s input. Must be of shape (hidden_size, input_size).</p>
</dd>
<dt><strong>b: numpy.array or None</strong></dt>
<dd><p class="first last">Bias of the recurrent layer’s output. If None, bias is ignored. Otherwise it must be of shape (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt>
<dd><p class="first last">Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt>
<dd><p class="first last">Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt>
<dd><p class="first last">Activation function name. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names list of this layer, in the order of [x, h_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names list of this layer, in the order of [y, h_output].</p>
</dd>
<dt><strong>output_all: boolean</strong></dt>
<dd><p class="first">Whether the recurrent layer should output at every time step.</p>
<ul class="last simple">
<li>If False, the output is the result after the final state update.</li>
<li>If True, the output is a sequence, containing outputs at all time steps.</li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt>
<dd><p class="first">Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="last simple">
<li>If False, the input sequence order is not reversed.</li>
<li>If True, the input sequence order is reversed.</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin">
<code class="descname">add_sin</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sin layer to the model that computes element-wise sine for the
input tensor.
Refer to the <strong>SinLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh">
<code class="descname">add_sinh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sinh layer to the model that computes element-wise hyperbolic sine for the input tensor.
Refer to the <strong>SinhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice">
<code class="descname">add_slice</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em>, <em>start_index=0</em>, <em>end_index=-1</em>, <em>stride=1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice layer. Equivalent to to numpy slice [start_index:end_index:stride],
start_index is included, while end_index is exclusive.
Refer to the <strong>SliceLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt>
<dd><p class="first last">axis along which input is sliced.
allowed values: ‘channel’, ‘height’, ‘width’</p>
</dd>
<dt><strong>start_index: int</strong></dt>
<dd><p class="first last">must be non-negative.</p>
</dd>
<dt><strong>end_index: int</strong></dt>
<dd><p class="first last">negative indexing is supported.</p>
</dd>
<dt><strong>stride: int</strong></dt>
<dd><p class="first last">must be positive.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic">
<code class="descname">add_slice_dynamic</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>end_ids=None</em>, <em>strides=None</em>, <em>begin_masks=None</em>, <em>end_masks=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice_dynamic layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <strong>SliceDynamicLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">End offsets for slice layer, default: [1].</p>
</dd>
<dt><strong>strides: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">Strides for slice layer, default: [1].</p>
</dd>
<dt><strong>begin_masks: list of bool, optional</strong></dt>
<dd><p class="first last">Boolean masks for begin offsets, default: [false].</p>
</dd>
<dt><strong>end_masks: list of bool, optional</strong></dt>
<dd><p class="first last">Boolean masks for end offsets, default: [false].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static">
<code class="descname">add_slice_static</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>begin_ids</em>, <em>end_ids</em>, <em>strides</em>, <em>begin_masks</em>, <em>end_masks</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a slice_static layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <strong>SliceStaticLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>begin_ids: list of int or tuple of int</strong></dt>
<dd><p class="first last">Begin offsets for slice layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int</strong></dt>
<dd><p class="first last">End offsets for slice layer.</p>
</dd>
<dt><strong>strides: list of int or tuple of int</strong></dt>
<dd><p class="first last">Strides for slice layer.</p>
</dd>
<dt><strong>begin_masks: list of bool</strong></dt>
<dd><p class="first last">Boolean masks for begin offsets.</p>
</dd>
<dt><strong>end_masks: list of bool</strong></dt>
<dd><p class="first last">Boolean masks for end offsets.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows">
<code class="descname">add_sliding_windows</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em>, <em>window_size</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sliding_windows layer to the model that returns a tensor containing
all windows of size <code class="docutils literal notranslate"><span class="pre">window_size</span></code> * separated by <code class="docutils literal notranslate"><span class="pre">step</span></code> along the dimension <code class="docutils literal notranslate"><span class="pre">axis</span></code>.
Refer to the <strong>SlidingWindowsLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">Axis to perform the operation.</p>
</dd>
<dt><strong>window_size: int</strong></dt>
<dd><p class="first last">Number of elements in the sliding window.</p>
</dd>
<dt><strong>step: int, optional</strong></dt>
<dd><p class="first last">The stride of the input elements in the sliding window, default: 1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax">
<code class="descname">add_softmax</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a softmax layer to the model.
Refer to the <strong>SoftmaxLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd">
<code class="descname">add_softmax_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axis</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a softmax_nd layer to the model that performs softmax operation along
the given axis.
Refer to the <strong>SoftmaxNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">Axis to perform the softmax operation on.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split">
<code class="descname">add_split</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_names</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a split layer that uniformly splits the input along the channel dimension
to produce multiple outputs.
Refer to the <strong>SplitLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">List of output blob names of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd">
<code class="descname">add_split_nd</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_names</em>, <em>axis</em>, <em>num_splits=2</em>, <em>split_sizes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a split layer to the model that splits the input tensor into multiple
output tensors. Either uniformly split the input tensor into <code class="docutils literal notranslate"><span class="pre">num_splits</span></code>
tensors, or split into given size list <code class="docutils literal notranslate"><span class="pre">split_sizes</span></code> output tensors.
Refer to the <strong>SplitNDLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt>
<dd><p class="first last">Axis to perform split on.</p>
</dd>
<dt><strong>num_splits: int, optional</strong></dt>
<dd><p class="first last">Number of splits, default: 2.</p>
</dd>
<dt><strong>split_sizes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">List of size to split, default [] or None.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze">
<code class="descname">add_squeeze</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>axes=None</em>, <em>squeeze_all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a squeeze layer to the model that decrease the rank of the input
tensor by removing unit dimensions.
Refer to the <strong>SqueezeLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt>
<dd><p class="first last">Dimensions to perform the operation, default: None (squeeze_all).</p>
</dd>
<dt><strong>squeeze_all: bool, optional</strong></dt>
<dd><p class="first last">If true, all dimensions that are 1 are squeezed, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_expand_dims</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack">
<code class="descname">add_stack</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a stack layer to the model that performs stack operation on a list of
tensors into one rank+1 tensor on the given axis.
Refer to the <strong>StackLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt>
<dd><p class="first last">The axis to perform stack operation, default: 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable">
<code class="descname">add_subtract_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a subtract_broadcastable layer to the model that performs element-wise
subtraction operation with broadcast support.
Refer to the <strong>SubtractBroadcastableLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan">
<code class="descname">add_tan</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tan layer to the model that computes element-wise tangent for the
input tensor.
Refer to the <strong>TanLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh">
<code class="descname">add_tanh</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tanh layer to the model that computes element-wise hyperbolic
tangent for the input tensor.
Refer to the <strong>TanhLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile">
<code class="descname">add_tile</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>reps</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a tile layer to the model that construct a tensor by repeating the
input tensor multiple number of times.
Refer to the <strong>TileLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>reps: list of int or tuple of int</strong></dt>
<dd><p class="first last">Number of times to replicate.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_stack</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_concat_nd</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk">
<code class="descname">add_topk</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_names</em>, <em>k=0</em>, <em>axis=0</em>, <em>use_bottom_k=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a topk layer to the model that returns top or bottom k values and
the corresponding indices of the input tensor along a given axis.
Refer to the <strong>TopKLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer. It must be of length 1 or 2.
The optional second input corresponds to value of K.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names of this layer. First and second correspond to
values and indices, respectively.</p>
</dd>
<dt><strong>k: int, optional</strong></dt>
<dd><p class="first last">number of values/indices to be computed along the axis.
Need not be given of there are two inputs, default: 0.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt>
<dd><p class="first last">axis along which the topk values/indices are computed.
negative indexing is supported, default: 0</p>
</dd>
<dt><strong>use_bottom_k: bool, optional</strong></dt>
<dd><p class="first last">if true, bottom k values are computed instead, default: false.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose">
<code class="descname">add_transpose</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>axes</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a N-D transpose layer with axes as a parameter.
Refer to the <strong>TransposeLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt>
<dd><p class="first last">The list containing a permutation of “[0,1,2,…,N-1]” where N is the rank of input/output tensor.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary">
<code class="descname">add_unary</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>mode</em>, <em>alpha=1.0</em>, <em>shift=0</em>, <em>scale=1.0</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Unary layer. Applies the specified function (mode) to all the elements of the input.
Prior to the application of the function the input can be scaled and shifted by using the ‘scale’,
‘shift’ parameters.
Refer to the <strong>UnaryFunctionLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Unary function.
Allowed values: ‘sqrt’, ‘rsqrt’, ‘inverse’, ‘power’, ‘exp’, ‘log’, ‘abs’, threshold’.</p>
</dd>
<dt><strong>alpha: float</strong></dt>
<dd><p class="first last">constant used in with modes ‘power’ and ‘threshold’.</p>
</dd>
<dt><strong>shift, scale: float</strong></dt>
<dd><p class="first last">input is modified by scale and shift prior to the application of the unary function.</p>
</dd>
<dt><strong>epsilon: float</strong></dt>
<dd><p class="first last">small bias to prevent division by zero.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm">
<code class="descname">add_unilstm</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>W_h</em>, <em>W_x</em>, <em>b</em>, <em>hidden_size</em>, <em>input_size</em>, <em>input_names</em>, <em>output_names</em>, <em>inner_activation='SIGMOID'</em>, <em>cell_state_update_activation='TANH'</em>, <em>output_activation='TANH'</em>, <em>peep=None</em>, <em>output_all=False</em>, <em>forget_bias=False</em>, <em>coupled_input_forget_gate=False</em>, <em>cell_clip_threshold=50000.0</em>, <em>reverse_input=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Uni-directional LSTM layer to the model.
Refer to the <strong>UniDirectionalLSTMLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt>
<dd><p class="first last">List of recursion weight matrices. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt>
<dd><p class="first last">List of input weight matrices. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt>
<dd><p class="first last">List of biases. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
If None, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt>
<dd><p class="first last">Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt>
<dd><p class="first last">Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names list of this layer, in the order of [x, h_input, c_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output blob names list of this layer, in the order of [y, h_output, c_output].</p>
</dd>
<dt><strong>inner_activation: str</strong></dt>
<dd><p class="first last">Inner activation function used at input and forget gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt>
<dd><p class="first last">Cell state update activation function used at the cell state update gate.
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>output_activation: str</strong></dt>
<dd><p class="first last">Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt>
<dd><p class="first last">List of peephole vectors. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,).</p>
</dd>
<dt><strong>output_all: boolean</strong></dt>
<dd><p class="first">Whether the LSTM layer should output at every time step.</p>
<ul class="last simple">
<li>If False, the output is the result after the final state update.</li>
<li>If True, the output is a sequence, containing outputs at all time steps.</li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt>
<dd><p class="first last">If True, a vector of 1s is added to forget gate bias.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt>
<dd><p class="first last">If True, the input gate and forget gate is coupled. i.e. forget gate is not used.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt>
<dd><p class="first last">The limit on the maximum and minimum values on the cell state.
If not provided, it is defaulted to 50.0.</p>
</dd>
<dt><strong>reverse_input: boolean</strong></dt>
<dd><p class="first">Whether the LSTM layer should process the input sequence in the reverse order.</p>
<ul class="last simple">
<li>If False, the input sequence order is not reversed.</li>
<li>If True, the input sequence order is reversed.</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular">
<code class="descname">add_upper_triangular</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em>, <em>k=0</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a upper_triangular layer to the model that copies a tensor setting
everything outside upper triangular to zero.
Refer to the <strong>UpperTriangularLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt>
<dd><p class="first last">Diagonal above which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample">
<code class="descname">add_upsample</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>scaling_factor_h</em>, <em>scaling_factor_w</em>, <em>input_name</em>, <em>output_name</em>, <em>mode='NN'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an upsample layer to the model.
Refer to the <strong>UpsampleLayerParams</strong> message in specification (NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>scaling_factor_h: int</strong></dt>
<dd><p class="first last">Scaling factor on the vertical direction.</p>
</dd>
<dt><strong>scaling_factor_w: int</strong></dt>
<dd><p class="first last">Scaling factor on the horizontal direction.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt>
<dd><p class="first last">Following values are supported:
‘NN’: nearest neighbour
‘BILINEAR’: bilinear interpolation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sequence_repeat</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable">
<code class="descname">add_where_broadcastable</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_names</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a where_broadcastable layer to the model that returns the elements
either from tensor x or tensor y, depending on the value in the
condition tensor.
Refer to the <strong>WhereBroadcastableLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_nonzero</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero">
<code class="descname">add_where_nonzero</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_name</em>, <em>output_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a where_nonzero layer to the model that returns a tensor containing
the indices of all non-zero elements of input tensor.
Refer to the <strong>WhereNonZeroLayerParams</strong> message in specification
(NeuralNetwork.proto) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: str</strong></dt>
<dd><p class="first last">The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt>
<dd><p class="first last">The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt>
<dd><p class="first last">The output blob name of this layer.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_broadcastable</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels">
<code class="descname">inspect_conv_channels</code><span class="sig-paren">(</span><em>self</em>, <em>layer_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the output and kernel channels of a convolution layer.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels">
<code class="descname">inspect_innerproduct_channels</code><span class="sig-paren">(</span><em>self</em>, <em>layer_name</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the output and kernel channels of an innerProduct layer.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features">
<code class="descname">inspect_input_features</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the name and type of input features.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers">
<code class="descname">inspect_layers</code><span class="sig-paren">(</span><em>self</em>, <em>last=-1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for last “last” number of layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>last: int</strong></dt>
<dd><p class="first last">The numbers of layers to inspect, starting from the last one.</p>
</dd>
<dt><strong>verbose: bool</strong></dt>
<dd><p class="first last">Whether to display layer-specific parameters or not</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers">
<code class="descname">inspect_loss_layers</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for the loss layer.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer">
<code class="descname">inspect_optimizer</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the summary for the optimizer.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features">
<code class="descname">inspect_output_features</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the name and type of output features.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers">
<code class="descname">inspect_updatable_layers</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all updatable layers with their inputs and outputs.</p>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable">
<code class="descname">make_updatable</code><span class="sig-paren">(</span><em>self</em>, <em>trainables</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the builder’s NeuralNetwork spec updatable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trainables: list of str</strong></dt>
<dd><p class="first last">List of layer names to be set trainable.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss">
<code class="descname">set_categorical_cross_entropy_loss</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Categorical Cross Entropy is used for single label categorization (only one category is applicable for each data point).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name: The name of the loss layer</strong></dt>
<dd></dd>
<dt><strong>input: The name of the input, which should be a vector of length N representing the distribution over N categories. This must be the output of a softmax.</strong></dt>
<dd></dd>
<dt><strong>.. math::</strong></dt>
<dd></dd>
<dt><strong>Loss_ {CCE}(input, target) = -sum_{i = 1} ^ {N}(target == i) log(input[i]) = - log(input[target])</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels">
<code class="descname">set_class_labels</code><span class="sig-paren">(</span><em>self</em>, <em>class_labels</em>, <em>predicted_feature_name='classLabel'</em>, <em>prediction_blob=''</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Set class labels to the model spec to make it a neural network classifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>class_labels: list of int or list of str</strong></dt>
<dd><p class="first last">A list of integers or strings that map the index of the output of a
neural network to labels in a classifier.</p>
</dd>
<dt><strong>predicted_feature_name: str</strong></dt>
<dd><p class="first last">Name of the output feature for the class labels exposed in the
Core ML neural network classifier, defaults: ‘class_output’.</p>
</dd>
<dt><strong>prediction_blob: str</strong></dt>
<dd><p class="first last">If provided, then this is the name of the neural network blob which
generates the probabilities for each class label (typically the output
of a softmax layer). If not provided, then the last output layer is
assumed.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pre_processing_parameters</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input">
<code class="descname">set_input</code><span class="sig-paren">(</span><em>self</em>, <em>input_names</em>, <em>input_dims</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the inputs of the network spec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>input_names: list of str</strong></dt>
<dd><p class="first last">The input names of the network.</p>
</dd>
<dt><strong>input_dims: [tuple]</strong></dt>
<dd><p class="first last">The input dimensions of the network. The ordering of input_dims
is the same as input_names.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt>
<dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec inputs to be 3 dimensional vector data1 and</span>
<span class="c1"># 4 dimensional vector data2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">],</span> <span class="n">input_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss">
<code class="descname">set_mean_squared_error_loss</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>input_feature=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>input_feature: [(str, datatypes.Array)] or None</dt>
<dd>The input feature of the loss layer. Each feature is a (name,
array) tuple, where name is the name of the model’s tensor our loss will be attached to,
and array is a datatypes.Array object describing the shape of that tensor.
Both the name and the array’s shape must be provided in the tuple.
&gt;&gt;&gt; feature = [(‘output_tensor’, datatypes.Array((299, 299, 3)))]</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output">
<code class="descname">set_output</code><span class="sig-paren">(</span><em>self</em>, <em>output_names</em>, <em>output_dims</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outputs of the network spec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>output_names: list of str</strong></dt>
<dd><p class="first last">The output names of the network.</p>
</dd>
<dt><strong>output_dims: [tuple]</strong></dt>
<dd><p class="first last">The output dimensions of the network. The ordering of output_dims is the same
as output_names.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt>
<dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec outputs to be 3 dimensional vector feature1 and</span>
<span class="c1"># 4 dimensional vector feature2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span> <span class="s1">&#39;feature2&#39;</span><span class="p">],</span> <span class="n">output_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters">
<code class="descname">set_pre_processing_parameters</code><span class="sig-paren">(</span><em>self</em>, <em>image_input_names=None</em>, <em>is_bgr=False</em>, <em>red_bias=0.0</em>, <em>green_bias=0.0</em>, <em>blue_bias=0.0</em>, <em>gray_bias=0.0</em>, <em>image_scale=1.0</em>, <em>image_format='NCHW'</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pre-processing parameters layer to the neural network object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>image_input_names: list of str</strong></dt>
<dd><p class="first last">Name of input blobs that are images</p>
</dd>
<dt><strong>is_bgr: boolean or dict()</strong></dt>
<dd><p class="first last">Channel order for input blobs that are images. BGR if True else RGB.
To specify a different value for each image input,
provide a dictionary with input names as keys.</p>
</dd>
<dt><strong>red_bias: float or dict()</strong></dt>
<dd><p class="first last">Image re-centering parameter (red channel)</p>
</dd>
<dt><strong>blue_bias: float or dict()</strong></dt>
<dd><p class="first last">Image re-centering parameter (blue channel)</p>
</dd>
<dt><strong>green_bias: float or dict()</strong></dt>
<dd><p class="first last">Image re-centering parameter (green channel)</p>
</dd>
<dt><strong>gray_bias: float or dict()</strong></dt>
<dd><p class="first last">Image re-centering parameter (for grayscale images)</p>
</dd>
<dt><strong>image_scale: float or dict()</strong></dt>
<dd><p class="first last">Value by which to scale the images.</p>
</dd>
<dt><strong>image_format: str</strong></dt>
<dd><p class="first last">Image format, either ‘NCHW’ / ‘NHWC’</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt>
<dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input">
<code class="descname">set_training_input</code><span class="sig-paren">(</span><em>self</em>, <em>training_input</em><span class="sig-paren">)</span><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>training_input: [tuple]</strong></dt>
<dd><p class="first last">The training input names and type of the network.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec training inputs to be 3 dimensional vector for &#39;input&#39; and</span>
<span class="c1"># Double for &#39;target&#39;.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_training_input</span><span class="p">([(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="coremltools.models.neural_network.flexible_shape_utils.html" class="btn btn-neutral float-right" title="coremltools.models.neural_network.flexible_shape_utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="coremltools.models.nearest_neighbors.builder.html" class="btn btn-neutral float-left" title="coremltools.models.nearest_neighbors.builder" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019, Apple Inc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>