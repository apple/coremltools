<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model APIs &mdash; coremltools API Reference 8.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/norightmargin.css?v=eea1f72d" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8cc1add8"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="coremltools.models.ml_program.html" />
    <link rel="prev" title="XGBoost" href="coremltools.converters.xgboost.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            coremltools API Reference
          </a>
              <div class="version">
                8.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.html">Converters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.model">MLModel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.model.MLModel"><code class="docutils literal notranslate"><span class="pre">MLModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.__init__"><code class="docutils literal notranslate"><span class="pre">MLModel.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.get_available_compute_devices"><code class="docutils literal notranslate"><span class="pre">MLModel.get_available_compute_devices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.get_compiled_model_path"><code class="docutils literal notranslate"><span class="pre">MLModel.get_compiled_model_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.get_spec"><code class="docutils literal notranslate"><span class="pre">MLModel.get_spec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.last_predict_duration_in_nano_seconds"><code class="docutils literal notranslate"><span class="pre">MLModel.last_predict_duration_in_nano_seconds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.load_duration_in_nano_seconds"><code class="docutils literal notranslate"><span class="pre">MLModel.load_duration_in_nano_seconds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.make_state"><code class="docutils literal notranslate"><span class="pre">MLModel.make_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.predict"><code class="docutils literal notranslate"><span class="pre">MLModel.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModel.save"><code class="docutils literal notranslate"><span class="pre">MLModel.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.model.MLModelAsset"><code class="docutils literal notranslate"><span class="pre">MLModelAsset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModelAsset.from_memory"><code class="docutils literal notranslate"><span class="pre">MLModelAsset.from_memory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.model.MLModelAsset.from_path"><code class="docutils literal notranslate"><span class="pre">MLModelAsset.from_path()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compiled-mlmodel">Compiled MLModel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.CompiledMLModel"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.__init__"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.from_asset"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.from_asset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.make_state"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.make_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict"><code class="docutils literal notranslate"><span class="pre">CompiledMLModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compression-utils">compression_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html"><code class="docutils literal notranslate"><span class="pre">affine_quantize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.palettize_weights"><code class="docutils literal notranslate"><span class="pre">palettize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.sparsify_weights"><code class="docutils literal notranslate"><span class="pre">sparsify_weights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.array_feature_extractor">array_feature_extractor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.array_feature_extractor.create_array_feature_extractor"><code class="docutils literal notranslate"><span class="pre">create_array_feature_extractor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.converters.mil.debugging_utils">extract_submodel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.converters.mil.debugging_utils.extract_submodel"><code class="docutils literal notranslate"><span class="pre">extract_submodel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.feature_vectorizer">feature_vectorizer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.feature_vectorizer.create_feature_vectorizer"><code class="docutils literal notranslate"><span class="pre">create_feature_vectorizer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.nearest_neighbors.builder">nearest_neighbors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.add_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.author</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.index_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.is_updatable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.leaf_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.license</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_dimensions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.set_index_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme"><code class="docutils literal notranslate"><span class="pre">KNearestNeighborsClassifierBuilder.weighting_scheme</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#neural-network">neural_network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html">neural_network.builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.pipeline">pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline"><code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.__init__"><code class="docutils literal notranslate"><span class="pre">Pipeline.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.add_model"><code class="docutils literal notranslate"><span class="pre">Pipeline.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.Pipeline.set_training_input"><code class="docutils literal notranslate"><span class="pre">Pipeline.set_training_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.add_model"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier.set_training_input"><code class="docutils literal notranslate"><span class="pre">PipelineClassifier.set_training_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.__init__"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.add_model"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor.set_training_input"><code class="docutils literal notranslate"><span class="pre">PipelineRegressor.set_training_input()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.tree_ensemble">tree_ensemble</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.add_branch_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.add_leaf_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.set_default_prediction_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleBase.set_post_evaluation_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleClassifier.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleRegressor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__"><code class="docutils literal notranslate"><span class="pre">TreeEnsembleRegressor.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.__init__"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.add_function"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.add_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.add_model"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor.remove_function"><code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor.remove_function()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.bisect_model"><code class="docutils literal notranslate"><span class="pre">bisect_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.change_input_output_tensor_type"><code class="docutils literal notranslate"><span class="pre">change_input_output_tensor_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.compile_model"><code class="docutils literal notranslate"><span class="pre">compile_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.convert_double_to_float_multiarray_type"><code class="docutils literal notranslate"><span class="pre">convert_double_to_float_multiarray_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier"><code class="docutils literal notranslate"><span class="pre">evaluate_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier_with_probabilities"><code class="docutils literal notranslate"><span class="pre">evaluate_classifier_with_probabilities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor"><code class="docutils literal notranslate"><span class="pre">evaluate_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.evaluate_transformer"><code class="docutils literal notranslate"><span class="pre">evaluate_transformer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.load_spec"><code class="docutils literal notranslate"><span class="pre">load_spec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.make_pipeline"><code class="docutils literal notranslate"><span class="pre">make_pipeline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.materialize_dynamic_shape_mlmodel"><code class="docutils literal notranslate"><span class="pre">materialize_dynamic_shape_mlmodel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.randomize_weights"><code class="docutils literal notranslate"><span class="pre">randomize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.rename_feature"><code class="docutils literal notranslate"><span class="pre">rename_feature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.save_multifunction"><code class="docutils literal notranslate"><span class="pre">save_multifunction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.utils.save_spec"><code class="docutils literal notranslate"><span class="pre">save_spec()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.compute_plan">compute_plan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan"><code class="docutils literal notranslate"><span class="pre">MLComputePlan</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_mlprogram_operation"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.get_compute_device_usage_for_mlprogram_operation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_neuralnetwork_layer"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.get_compute_device_usage_for_neuralnetwork_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.get_estimated_cost_for_mlprogram_operation"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.get_estimated_cost_for_mlprogram_operation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.load_from_path"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.load_from_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.load_from_path_on_device"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.load_from_path_on_device()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan.model_structure"><code class="docutils literal notranslate"><span class="pre">MLComputePlan.model_structure</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanCost"><code class="docutils literal notranslate"><span class="pre">MLComputePlanCost</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage"><code class="docutils literal notranslate"><span class="pre">MLComputePlanDeviceUsage</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructure"><code class="docutils literal notranslate"><span class="pre">MLModelStructure</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructure.load_from_path"><code class="docutils literal notranslate"><span class="pre">MLModelStructure.load_from_path()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetwork"><code class="docutils literal notranslate"><span class="pre">MLModelStructureNeuralNetwork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer"><code class="docutils literal notranslate"><span class="pre">MLModelStructureNeuralNetworkLayer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructurePipeline"><code class="docutils literal notranslate"><span class="pre">MLModelStructurePipeline</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgram"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgram</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramArgument"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramArgument</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramBinding"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramBinding</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramBlock"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramBlock</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramFunction"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramNamedValueType"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramNamedValueType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramOperation"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramOperation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramValue"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramValue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramValueType"><code class="docutils literal notranslate"><span class="pre">MLModelStructureProgramValueType</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-coremltools.models.compute_device">compute_device</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_device.MLCPUComputeDevice"><code class="docutils literal notranslate"><span class="pre">MLCPUComputeDevice</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice"><code class="docutils literal notranslate"><span class="pre">MLComputeDevice</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice.get_all_compute_devices"><code class="docutils literal notranslate"><span class="pre">MLComputeDevice.get_all_compute_devices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_device.MLGPUComputeDevice"><code class="docutils literal notranslate"><span class="pre">MLGPUComputeDevice</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coremltools.models.compute_device.MLNeuralEngineComputeDevice"><code class="docutils literal notranslate"><span class="pre">MLNeuralEngineComputeDevice</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.compute_device.MLNeuralEngineComputeDevice.total_core_count"><code class="docutils literal notranslate"><span class="pre">MLNeuralEngineComputeDevice.total_core_count</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#experimental">experimental</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#torch">torch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.torch.debugging_utils">debugging_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.torch.perf_utils">perf_utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.remote_device">remote_device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.AppSigningCredentials"><code class="docutils literal notranslate"><span class="pre">AppSigningCredentials</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan"><code class="docutils literal notranslate"><span class="pre">ComputePlan</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device"><code class="docutils literal notranslate"><span class="pre">Device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.DeviceState"><code class="docutils literal notranslate"><span class="pre">DeviceState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.DeviceType"><code class="docutils literal notranslate"><span class="pre">DeviceType</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">debugging_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator"><code class="docutils literal notranslate"><span class="pre">MLModelComparator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector"><code class="docutils literal notranslate"><span class="pre">MLModelInspector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator"><code class="docutils literal notranslate"><span class="pre">MLModelValidator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.debugging_utils.compute_snr_and_psnr"><code class="docutils literal notranslate"><span class="pre">compute_snr_and_psnr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.debugging_utils.skip_op_by_type"><code class="docutils literal notranslate"><span class="pre">skip_op_by_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">perf_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker"><code class="docutils literal notranslate"><span class="pre">MLModelBenchmarker</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.async_wrapper">async_wrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper"><code class="docutils literal notranslate"><span class="pre">LocalMLModelAsyncWrapper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper"><code class="docutils literal notranslate"><span class="pre">MLModelAsyncWrapper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper"><code class="docutils literal notranslate"><span class="pre">RemoteMLModelAsyncWrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.model_structure_path">model_structure_path</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath"><code class="docutils literal notranslate"><span class="pre">ModelStructurePath</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.ml_program.experimental.compute_plan_utils">compute_plan_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.compute_plan_utils.apply_compute_plan"><code class="docutils literal notranslate"><span class="pre">apply_compute_plan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.compute_plan_utils.load_compute_plan_from_path_on_device"><code class="docutils literal notranslate"><span class="pre">load_compute_plan_from_path_on_device()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.ml_program.experimental.compute_plan_utils.set_intended_backends"><code class="docutils literal notranslate"><span class="pre">set_intended_backends()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.html">MIL Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.input_types.html">MIL Input Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.ops.defs.html">MIL Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.passes.defs.html">MIL Graph Passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.optimize.html">Optimizers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/docs-guides/index.html">Guide and Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/mlmodel/index.html">Core ML Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-versions.html">Previous Versions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apple/coremltools">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coremltools API Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model APIs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/coremltools.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-apis">
<h1>Model APIs<a class="headerlink" href="#model-apis" title="Link to this heading"></a></h1>
<section id="module-coremltools.models.model">
<span id="mlmodel"></span><h2>MLModel<a class="headerlink" href="#module-coremltools.models.model" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.model.</span></span><span class="sig-name descname"><span class="pre">MLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_temp_package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mil_program</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_model_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel" title="Link to this definition"></a></dt>
<dd><p>This class defines the minimal interface to a Core ML object in Python.</p>
<p>At a high level, the protobuf specification consists of:</p>
<ul class="simple">
<li><p>Model description: Encodes names and type information of the inputs and outputs to the model.</p></li>
<li><p>Model parameters: The set of parameters required to represent a specific instance of the model.</p></li>
<li><p>Metadata: Information about the origin, license, and author of the model.</p></li>
</ul>
<p>With this class, you can inspect a Core ML model, modify metadata, and make
predictions for the purposes of testing (on select platforms).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.model.MLModel.predict" title="coremltools.models.model.MLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>

<span class="c1"># Set the model metadata</span>
<span class="n">model</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Author&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="s2">&quot;BSD&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s2">&quot;Predicts the price of a house in the Seattle area.&quot;</span>

<span class="c1"># Get the interface to the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span>
<span class="n">model</span><span class="o">.</span><span class="n">output_description</span>

<span class="c1"># Set feature descriptions manually</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;bedroom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Number of bedrooms&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;bathrooms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Number of bathrooms&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">input_description</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Size (in square feet)&quot;</span>

<span class="c1"># Set</span>
<span class="n">model</span><span class="o">.</span><span class="n">output_description</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Price of the house&quot;</span>

<span class="c1"># Make predictions</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">})</span>

<span class="c1"># Get the spec of the model</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>

<span class="c1"># Save the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>

<span class="c1"># Load the model from the spec object</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="c1"># modify spec (e.g. rename inputs/outputs etc)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="c1"># if model type is mlprogram, i.e. spec.WhichOneof(&#39;Type&#39;) == &quot;mlProgram&quot;, then:</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">weights_dir</span><span class="p">)</span>

<span class="c1"># Load a non-default function from a multifunction .mlpackage</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;MultifunctionModel.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;deep_features&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_temp_package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mil_program</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_model_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Construct an MLModel from an <code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>model: str or Model_pb2</strong></dt><dd><p>For an ML program (<code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>), the model can be a path string (<code class="docutils literal notranslate"><span class="pre">.mlpackage</span></code>) or <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>.
If it is a path string, it must point to a directory containing bundle
artifacts (such as <code class="docutils literal notranslate"><span class="pre">weights.bin</span></code>).
If it is of type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code> (spec), then you must also provide <code class="docutils literal notranslate"><span class="pre">weights_dir</span></code> if the model
has weights, because both the proto spec and the weights are
required to initialize and load the model.
The proto spec for an <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>, unlike a neural network (<code class="docutils literal notranslate"><span class="pre">neuralnetwork</span></code>),
does not contain the weights; they are stored separately.
If the model does not have weights, you can provide an empty <code class="docutils literal notranslate"><span class="pre">weights_dir</span></code>.</p>
<p>For non- <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code> model types, the model can be a path string (<code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>)
or type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>, such as a spec object.</p>
</dd>
<dt><strong>is_temp_package: bool</strong></dt><dd><p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the input model package dir is temporary and can be deleted upon interpreter termination.</p>
</dd>
<dt><strong>mil_program: coremltools.converters.mil.Program</strong></dt><dd><p>Set to the MIL program object, if available.
It is available whenever an MLModel object is constructed using
the unified converter API <a class="reference external" href="https://apple.github.io/coremltools/source/coremltools.converters.convert.html">coremltools.convert()</a>.</p>
</dd>
<dt><strong>skip_model_load: bool</strong></dt><dd><p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to prevent Core ML Tools from calling into the Core ML framework
to compile and load the model. In that case, the returned model object cannot
be used to make a prediction. This flag may be used to load a newer model
type on an older Mac, to inspect or load/save the spec.</p>
<p>Example: Loading an ML program model type on a macOS 11, since an ML program can be
compiled and loaded only from macOS12+.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>compute_units: coremltools.ComputeUnit</strong></dt><dd><p>The set of processing units the model can use to make predictions.</p>
<dl class="simple">
<dt>An enum with four possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU,
but not the neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>weights_dir: str</strong></dt><dd><p>Path to the weight directory, required when loading an MLModel of type <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>,
from a spec object, such as when the argument <code class="docutils literal notranslate"><span class="pre">model</span></code> is of type <code class="docutils literal notranslate"><span class="pre">Model_pb2</span></code>.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">str</span></dt><dd><p>The name of the function from <code class="docutils literal notranslate"><span class="pre">model</span></code> to load.
If not provided, <code class="docutils literal notranslate"><span class="pre">function_name</span></code> will be set to the <code class="docutils literal notranslate"><span class="pre">defaultFunctionName</span></code> in the proto.</p>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">dict or None</span></dt><dd><dl class="simple">
<dt>Keys are the names of the optimization hint: ‘allowLowPrecisionAccumulationOnGPU’, ‘reshapeFrequency’</dt><dd><p>or ‘specializationStrategy’.</p>
</dd>
</dl>
<ul class="simple">
<li><p>‘allowLowPrecisionAccumulationOnGPU’ value must have <code class="docutils literal notranslate"><span class="pre">bool</span></code> type.</p></li>
<li><p>‘reshapeFrequency’ value must have <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> type.</p></li>
<li><p>‘specializationStrategy’ must have``coremltools.SpecializationStrategy`` type.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Internally this maintains the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_MLModelProxy</span></code>: A pybind wrapper around
CoreML::Python::Model (see
<a class="reference external" href="https://github.com/apple/coremltools/blob/main/coremlpython/CoreMLPython.mm">coremltools/coremlpython/CoreMLPython.mm</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">package_path</span></code> (mlprogram only): Directory containing all artifacts (<code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code>,
weights, and so on).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights_dir</span></code> (mlprogram only): Directory containing weights inside the package_path.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlmodel&quot;</span><span class="p">)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.get_available_compute_devices">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_available_compute_devices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice" title="coremltools.models.compute_device.MLComputeDevice"><span class="pre">MLComputeDevice</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.get_available_compute_devices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.get_available_compute_devices" title="Link to this definition"></a></dt>
<dd><p>The list of available compute devices for CoreML.</p>
<p>Use the method to get the list of compute devices that MLModel’s predict method can use.</p>
<p>Some compute devices on the hardware are exclusive to the domain ML frameworks such as Vision and SoundAnalysis and
not available to Core ML framework. See also <code class="docutils literal notranslate"><span class="pre">MLComputeDevice.get_all_compute_devices()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The list of compute devices MLModel’s predict method can use.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">compute_devices</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">MLModel</span><span class="o">.</span><span class="n">get_available_compute_devices</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.get_compiled_model_path">
<span class="sig-name descname"><span class="pre">get_compiled_model_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.get_compiled_model_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.get_compiled_model_path" title="Link to this definition"></a></dt>
<dd><p>Returns the path for the underlying compiled ML Model.</p>
<p><strong>Important</strong>: This path is available only for the lifetime of this Python object. If you want
the compiled model to persist, you need to make a copy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.get_spec">
<span class="sig-name descname"><span class="pre">get_spec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.get_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.get_spec" title="Link to this definition"></a></dt>
<dd><p>Get a deep copy of the protobuf specification of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>model: Model_pb2</dt><dd><p>Protobuf specification of the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.last_predict_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_predict_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.model.MLModel.last_predict_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the last predict operation in nanoseconds.
This method returns the time taken for the most recent prediction made by
the model, measured in nanoseconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Optional[int]:</dt><dd><p>The duration of the last prediction operation in nanoseconds.
Returns None if no prediction has been made yet.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Calculates the time elapsed during the model predict call, specifically
measuring the execution time of <code class="docutils literal notranslate"><span class="pre">[MLModel</span> <span class="pre">predictionFromFeatures:error:]</span></code>
or <code class="docutils literal notranslate"><span class="pre">[MLModel</span> <span class="pre">predictionFromBatch:error:]</span></code> method of the Core ML framework.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.load_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.model.MLModel.load_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the model loading process in nanoseconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Optional[int]:</dt><dd><p>The duration of the model loading process in nanoseconds.
Returns None if duration is not available.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Calculates the time elapsed during the model loading process, specifically
measuring the execution time of <code class="docutils literal notranslate"><span class="pre">[MLModel</span> <span class="pre">loadContentsOfURL:configuration:error:]</span></code> method
of the Core ML framework.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.make_state">
<span class="sig-name descname"><span class="pre">make_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MLState</span></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.make_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.make_state" title="Link to this definition"></a></dt>
<dd><p>Returns a new state object, which can be passed to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>state</strong> (<em>MLState</em>) – Holds state for an MLModel.</p></li>
<li><p><em>State functionality is only supported on macOS 15+.</em></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.model.MLModel.predict" title="coremltools.models.model.MLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_state</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.predict" title="Link to this definition"></a></dt>
<dd><p>Return predictions for the model.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>data: dict[str, value] or list[dict[str, value]]</strong></dt><dd><p>Dictionary of data to use for predictions, where the keys are the names of the input features.
For batch predictons, use a list of such dictionaries.</p>
<p>The following dictionary values types are acceptable: list, array, numpy.ndarray, tensorflow.Tensor
and torch.Tensor.</p>
</dd>
<dt><strong>state</strong><span class="classifier">MLState</span></dt><dd><p>Optional state object as returned by <code class="docutils literal notranslate"><span class="pre">make_state()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict[str, value]</dt><dd><p>Predictions as a dictionary where each key is the output feature name.</p>
</dd>
<dt>list[dict[str, value]]</dt><dd><p>For batch prediction, returns a list of the above dictionaries.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">}</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2400</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModel.save" title="Link to this definition"></a></dt>
<dd><p>Save the model to an <code class="docutils literal notranslate"><span class="pre">.mlmodel</span></code> format. For an MIL program, the <code class="docutils literal notranslate"><span class="pre">save_path</span></code> is
a package directory containing the <code class="docutils literal notranslate"><span class="pre">mlmodel</span></code> and weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>save_path: Target file path / bundle directory for the model.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_model_file.mlmodel&quot;</span><span class="p">)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model_file.mlmodel&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.model.MLModelAsset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.model.</span></span><span class="sig-name descname"><span class="pre">MLModelAsset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModelAsset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModelAsset" title="Link to this definition"></a></dt>
<dd><p>A class representing a compiled model asset.</p>
<p>It supports two initialization methods:
- From a compiled model directory: The directory should have a ‘.mlmodelc’ extension.
- From memory: Allows direct initialization using in-memory model data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModelAsset.from_memory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blob_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModelAsset" title="coremltools.models.model.MLModelAsset"><span class="pre">MLModelAsset</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModelAsset.from_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModelAsset.from_memory" title="Link to this definition"></a></dt>
<dd><p>Create an MLModelAsset instance from in-memory data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec_data</strong><span class="classifier">bytes</span></dt><dd><p>The specification data of the model.</p>
</dd>
<dt><strong>blob_mapping</strong><span class="classifier">Dict[str, bytes])</span></dt><dd><p>A dictionary with blob path as the key and blob data as the value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelAsset</dt><dd><p>An instance of MLModelAsset created from the provided memory data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.model.MLModelAsset.from_path">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compiled_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModelAsset" title="coremltools.models.model.MLModelAsset"><span class="pre">MLModelAsset</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/model.html#MLModelAsset.from_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.model.MLModelAsset.from_path" title="Link to this definition"></a></dt>
<dd><p>Create an MLModelAsset instance from a compiled model path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>compiled_model_path</strong><span class="classifier">str</span></dt><dd><p>The file path to the compiled model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelAsset</dt><dd><p>An instance of MLModelAsset created from the specified path.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="compiled-mlmodel">
<h2>Compiled MLModel<a class="headerlink" href="#compiled-mlmodel" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.</span></span><span class="sig-name descname"><span class="pre">CompiledMLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModelAsset" title="coremltools.models.model.MLModelAsset"><span class="pre">MLModelAsset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModelAsset" title="coremltools.models.model.MLModelAsset"><span class="pre">MLModelAsset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Loads a compiled Core ML model.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to a compiled model directory, ending in <code class="docutils literal notranslate"><span class="pre">.mlmodelc</span></code>.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit</span></dt><dd><dl class="simple">
<dt>An enum with the following possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU, but not the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">dict or None</span></dt><dd><dl class="simple">
<dt>Keys are the names of the optimization hint: ‘allowLowPrecisionAccumulationOnGPU’, ‘reshapeFrequency’</dt><dd><p>or ‘specializationStrategy’.</p>
</dd>
</dl>
<ul class="simple">
<li><p>‘allowLowPrecisionAccumulationOnGPU’ value must have <code class="docutils literal notranslate"><span class="pre">bool</span></code> type.</p></li>
<li><p>‘reshapeFrequency’ value must have <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> type.</p></li>
<li><p>‘specializationStrategy’ must have``coremltools.SpecializationStrategy`` type.</p></li>
</ul>
</dd>
<dt><strong>asset</strong><span class="classifier">MLModelAsset or None</span></dt><dd><p>The model asset.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict" title="coremltools.models.CompiledMLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_compiled_model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">CompiledMLModel</span><span class="p">(</span><span class="s2">&quot;my_model_path.mlmodelc&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">my_compiled_model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.from_asset">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_asset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModelAsset" title="coremltools.models.model.MLModelAsset"><span class="pre">MLModelAsset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.CompiledMLModel" title="coremltools.models._compiled_model.CompiledMLModel"><span class="pre">CompiledMLModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.from_asset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.from_asset" title="Link to this definition"></a></dt>
<dd><p>Creates a CompiledModel instance from an asset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>asset: MLModelAsset</strong></dt><dd><p>The model asset to create the compiled model from.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit</span></dt><dd><dl class="simple">
<dt>An enum with the following possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU, but not the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">dict or None</span></dt><dd><p>Keys are the names of the optimization hint, either ‘reshapeFrequency’ or ‘specializationStrategy’.
Values are enumeration values of type <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.SpecializationStrategy</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>CompiledMLModel</dt><dd><p>An instance of <code class="docutils literal notranslate"><span class="pre">CompiledMLModel</span></code> loaded from the provided asset.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model_asset</span> <span class="o">=</span> <span class="n">MLModelAsset</span><span class="o">.</span><span class="n">from_memory</span><span class="p">(</span><span class="n">spec_data</span><span class="p">)</span>
<span class="n">my_compiled_model</span> <span class="o">=</span> <span class="n">CompiledMLModel</span><span class="o">.</span><span class="n">from_asset</span><span class="p">(</span><span class="n">my_model_asset</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">my_compiled_model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.make_state">
<span class="sig-name descname"><span class="pre">make_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MLState</span></span></span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.make_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.make_state" title="Link to this definition"></a></dt>
<dd><p>Returns a new state object, which can be passed to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel.predict" title="coremltools.models.CompiledMLModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_state</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.CompiledMLModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/_compiled_model.html#CompiledMLModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.CompiledMLModel.predict" title="Link to this definition"></a></dt>
<dd><p>Return predictions for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict[str, value] or list[dict[str, value]]</strong></dt><dd><p>Dictionary of data to use for predictions, where the keys are the names of the input features.
For batch predictons, use a list of such dictionaries.</p>
</dd>
<dt><strong>state</strong><span class="classifier">MLState</span></dt><dd><p>Optional state object as returned by <code class="docutils literal notranslate"><span class="pre">make_state()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict[str, value]</dt><dd><p>Predictions as a dictionary where each key is the output feature name.</p>
</dd>
<dt>list[dict[str, value]]</dt><dd><p>For batch prediction, returns a list of the above dictionaries.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">}</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1240</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;bedroom&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s2">&quot;bath&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2400</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="compression-utils">
<h2>compression_utils<a class="headerlink" href="#compression-utils" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html"><code class="docutils literal notranslate"><span class="pre">affine_quantize_weights()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.palettize_weights"><code class="docutils literal notranslate"><span class="pre">palettize_weights()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.ml_program.html#coremltools.models.ml_program.compression_utils.sparsify_weights"><code class="docutils literal notranslate"><span class="pre">sparsify_weights()</span></code></a></li>
</ul>
</div>
</section>
<section id="module-coremltools.models.array_feature_extractor">
<span id="array-feature-extractor"></span><h2>array_feature_extractor<a class="headerlink" href="#module-coremltools.models.array_feature_extractor" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.array_feature_extractor.create_array_feature_extractor">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.array_feature_extractor.</span></span><span class="sig-name descname"><span class="pre">create_array_feature_extractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/array_feature_extractor.html#create_array_feature_extractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.array_feature_extractor.create_array_feature_extractor" title="Link to this definition"></a></dt>
<dd><p>Creates a feature extractor from an input array <code class="docutils literal notranslate"><span class="pre">(feature,</span> <span class="pre">return)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features:</strong></dt><dd><p>A list of one <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">array)</span></code> tuple.</p>
</dd>
<dt><strong>extract_indices:</strong></dt><dd><p>Either an integer or a list.
If it’s an integer, the output type is by default a double (but may also be an integer).
If a list, the output type is an array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.converters.mil.debugging_utils">
<span id="extract-submodel"></span><h2>extract_submodel<a class="headerlink" href="#module-coremltools.converters.mil.debugging_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.converters.mil.debugging_utils.extract_submodel">
<span class="sig-prename descclassname"><span class="pre">coremltools.converters.mil.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">extract_submodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/converters/mil/debugging_utils.html#extract_submodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.converters.mil.debugging_utils.extract_submodel" title="Link to this definition"></a></dt>
<dd><p>This utility function lets you extract a submodel from a Core ML model.</p>
<p>For a neural network model, the function extracts only in-memory Core ML models.
You should always call this function for a model directly from <a class="reference internal" href="coremltools.converters.convert.html#coremltools.converters._converters_entry.convert" title="coremltools.converters._converters_entry.convert"><code class="xref py py-class docutils literal notranslate"><span class="pre">convert</span></code></a>. It is not
allowed to load the model from disk and then call this API.</p>
<p>For an ML program model, both cases (in-memory and from disk) are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: MLModel</strong></dt><dd><p>The Core ML model from which the submodel is extracted.</p>
</dd>
<dt><strong>outputs: list[str]</strong></dt><dd><p>A list of names of Vars, which are the outputs of the extracted submodel.</p>
</dd>
<dt><strong>inputs: list[str] (Optional)</strong></dt><dd><p>A list of names of Vars, which are the inputs of the extracted submodel.
If not provided, the inputs from the original model are used.</p>
</dd>
<dt><strong>function_name: str (Optional)</strong></dt><dd><p>Name of the function where the subgraph is extracted. Default is <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Neural network:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.converters.mil.debugging_utils</span> <span class="kn">import</span> <span class="n">extract_submodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;neuralnetwork&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;output_0&quot;</span><span class="p">,</span> <span class="s2">&quot;output_1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p>ML program:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.converters.mil.debugging_utils</span> <span class="kn">import</span> <span class="n">extract_submodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;mlprogram&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;output_0&quot;</span><span class="p">,</span> <span class="s2">&quot;output_1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Directly extract model in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract model loaded from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submodel</span> <span class="o">=</span> <span class="n">extract_submodel</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coremltools.models.feature_vectorizer">
<span id="feature-vectorizer"></span><h2>feature_vectorizer<a class="headerlink" href="#module-coremltools.models.feature_vectorizer" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.feature_vectorizer.create_feature_vectorizer">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.feature_vectorizer.</span></span><span class="sig-name descname"><span class="pre">create_feature_vectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_size_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/feature_vectorizer.html#create_feature_vectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.feature_vectorizer.create_feature_vectorizer" title="Link to this definition"></a></dt>
<dd><p>Create a feature vectorizer from input features. This returns a 2-tuple
<code class="docutils literal notranslate"><span class="pre">(spec,</span> <span class="pre">num_dimension)</span></code> for a feature vectorizer that puts everything into a
single array with a length equal to the total size of all the input features.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The datatypes entry is one of the data types defined in the
<code class="docutils literal notranslate"><span class="pre">datatypes</span></code> module.  Allowed <code class="docutils literal notranslate"><span class="pre">datatypes</span></code> are <code class="docutils literal notranslate"><span class="pre">datatype.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatype.Double</span></code>, <code class="docutils literal notranslate"><span class="pre">datatypes.Dictionary</span></code>, and <code class="docutils literal notranslate"><span class="pre">datatype.Array</span></code>.</p>
<p>If the feature is a dictionary type, then the dictionary must have integer
keys, and the number of dimensions to expand it into must be provided by
<code class="docutils literal notranslate"><span class="pre">known_size_map</span></code>.</p>
<p>Feature indices in the final array are counted sequentially from the
from 0 through the total number of features.</p>
</dd>
<dt><strong>output_feature_name: str</strong></dt><dd><p>The name of the output feature.  The type is an Array
List of the output features of the network.</p>
</dd>
<dt><strong>known_size_map:</strong></dt><dd><p>A dictionary mapping the feature name to the expanded size in the final
array.  This is most useful for specifying the size of sparse vectors
given as dictionaries of index to value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.models.nearest_neighbors.builder">
<span id="nearest-neighbors"></span><h2>nearest_neighbors<a class="headerlink" href="#module-coremltools.models.nearest_neighbors.builder" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.nearest_neighbors.builder.</span></span><span class="sig-name descname"><span class="pre">KNearestNeighborsClassifierBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder" title="Link to this definition"></a></dt>
<dd><p>Construct a CoreML KNearestNeighborsClassifier specification.</p>
<p>Please see the Core ML Nearest Neighbors protobuf message for more information
on KNearestNeighborsClassifier parameters.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.nearest_neighbors</span> <span class="kn">import</span> <span class="n">KNearestNeighborsClassifierBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a KNearestNeighborsClassifier model that takes 4-dimensional input data and outputs a string label.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">KNearestNeighborsClassifierBuilder</span><span class="p">(</span><span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">number_of_dimensions</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>                                              <span class="n">default_class_label</span><span class="o">=</span><span class="s1">&#39;default_label&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;knnclassifier.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_class_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a KNearestNeighborsClassifierBuilder object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_name</strong></dt><dd><p>Name of the model input.</p>
</dd>
<dt><strong>output_name</strong></dt><dd><p>Name of the output.</p>
</dd>
<dt><strong>number_of_dimensions</strong></dt><dd><p>Number of dimensions of the input data.</p>
</dd>
<dt><strong>default_class_label</strong></dt><dd><p>The default class label to use for predictions. Must be either an
int64 or a string.</p>
</dd>
<dt><strong>number_of_neighbors</strong></dt><dd><p>Number of neighbors to use for predictions. Default = 5 with allowed values
between 1-1000.</p>
</dd>
<dt><strong>weighting_scheme</strong></dt><dd><p>Weight function used in prediction. One of <code class="docutils literal notranslate"><span class="pre">'uniform'</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">'inverse_distance'</span></code>.</p>
</dd>
<dt><strong>index_type</strong></dt><dd><p>Algorithm to compute nearest neighbors. One of <code class="docutils literal notranslate"><span class="pre">'linear'</span></code> (default), or
<code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code>.</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>Leaf size for the kd-tree. Ignored if index type is <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>. Default = 30.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples">
<span class="sig-name descname"><span class="pre">add_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.add_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.add_samples" title="Link to this definition"></a></dt>
<dd><p>Add some samples to the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_points</strong></dt><dd><p>List of input data points.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>List of corresponding labels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">author</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.author" title="Link to this definition"></a></dt>
<dd><p>Get the author for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The author</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.description" title="Link to this definition"></a></dt>
<dd><p>Get the description for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The description.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_type</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.index_type" title="Link to this definition"></a></dt>
<dd><p>Get the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The index type.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_updatable</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.is_updatable" title="Link to this definition"></a></dt>
<dd><p>Check if the KNearestNeighborsClassifier is updatable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Is updatable.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">leaf_size</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.leaf_size" title="Link to this definition"></a></dt>
<dd><p>Get the leaf size for the KNearestNeighborsClassifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The leaf size.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">license</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.license" title="Link to this definition"></a></dt>
<dd><p>Get the license for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The license.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_dimensions</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_dimensions" title="Link to this definition"></a></dt>
<dd><p>Get the number of dimensions of the input data for the
KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Number of dimensions.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_neighbors</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors" title="Link to this definition"></a></dt>
<dd><p>Get the number of neighbors value for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The number of neighbors default value.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range">
<span class="sig-name descname"><span class="pre">number_of_neighbors_allowed_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_range" title="Link to this definition"></a></dt>
<dd><p>Get the range of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the range hasn’t been set.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set">
<span class="sig-name descname"><span class="pre">number_of_neighbors_allowed_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.number_of_neighbors_allowed_set" title="Link to this definition"></a></dt>
<dd><p>Get the set of allowed values for the numberOfNeighbors parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Set of allowed values or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the set of allowed values hasn’t been</dt><dd></dd>
<dt>populated.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type">
<span class="sig-name descname"><span class="pre">set_index_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.set_index_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_index_type" title="Link to this definition"></a></dt>
<dd><p>Set the index type for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index_type</strong></dt><dd><p>One of [ <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>, <code class="docutils literal notranslate"><span class="pre">'kd_tree'</span></code> ].</p>
</dd>
<dt><strong>leaf_size</strong></dt><dd><p>For kd_tree indexes, the leaf size to use (default = 30).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds">
<span class="sig-name descname"><span class="pre">set_number_of_neighbors_with_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/nearest_neighbors/builder.html#KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.set_number_of_neighbors_with_bounds" title="Link to this definition"></a></dt>
<dd><p>Set the numberOfNeighbors parameter for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>allowed_range</strong></dt><dd><p>Tuple of (<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>) defining the range of allowed values.</p>
</dd>
<dt><strong>allowed_values</strong></dt><dd><p>Set of allowed values for the number of neighbors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weighting_scheme</span></span><a class="headerlink" href="#coremltools.models.nearest_neighbors.builder.KNearestNeighborsClassifierBuilder.weighting_scheme" title="Link to this definition"></a></dt>
<dd><p>Get the weighting scheme for the KNearestNeighborsClassifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>The weighting scheme.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="neural-network">
<h2>neural_network<a class="headerlink" href="#neural-network" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html">neural_network.builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.models.neural_network.html#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a></li>
</ul>
</div>
</section>
<section id="module-coremltools.models.pipeline">
<span id="pipeline"></span><h2>pipeline<a class="headerlink" href="#module-coremltools.models.pipeline" title="Link to this heading"></a></h2>
<p>Pipeline utils for this package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.</p>
<p>This class is the base class for <a class="reference internal" href="#coremltools.models.pipeline.PipelineClassifier" title="coremltools.models.pipeline.PipelineClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineClassifier</span></code></a> and
<a class="reference internal" href="#coremltools.models.pipeline.PipelineRegressor" title="coremltools.models.pipeline.PipelineRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineRegressor</span></code></a>, which contain a sequence ending in a classifier
or regressor and themselves behave like a classifier or regressor.  This class
may be used directly for a sequence of feature transformer objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a pipeline of models to be executed sequentially.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.Pipeline.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#Pipeline.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.Pipeline.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">PipelineClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a classification model by designating
a discrete categorical output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The last
model in this list must be a classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
This list must match the class labels in the model outputting the categorical
predictedFeatureName</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <cite>output_features</cite>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <cite>“classProbability.”</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineClassifier.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineClassifier.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineClassifier.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.pipeline.</span></span><span class="sig-name descname"><span class="pre">PipelineRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor" title="Link to this definition"></a></dt>
<dd><p>A pipeline model that exposes a sequence of models as a single model,
It requires a set of inputs, a sequence of other models and a set of outputs.
In this case the pipeline itself behaves as a regression model by designating
a real valued output feature as its ‘predicted feature’.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a set of pipeline models given a set of model specs.  The final
output model must be a regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features: [list of 2-tuples]</strong></dt><dd><p>Name(s) of the input features, given as a list of <cite>(‘name’, datatype)</cite>
tuples.  The datatypes entry can be any of the data types defined in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.</p>
</dd>
<dt><strong>output_features: [list of features]</strong></dt><dd><p>Name(s) of the output features, given as a list of
<cite>(‘name’,datatype)</cite> tuples.  The datatypes entry can be any of the
data types defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">models.datatypes</span></code> module.  All features
must be either defined in the inputs or be produced by one of the
contained models.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.add_model" title="Link to this definition"></a></dt>
<dd><p>Add a protobuf spec or <code class="xref py py-class docutils literal notranslate"><span class="pre">models.MLModel</span></code> instance to the pipeline.</p>
<p>All input features of this model must either match the input_features
of the pipeline, or match the outputs of a previous model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: [MLModel, Model_pb2]</strong></dt><dd><p>A protobuf spec or MLModel instance containing a model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.pipeline.PipelineRegressor.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/pipeline.html#PipelineRegressor.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.pipeline.PipelineRegressor.set_training_input" title="Link to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>List of training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.tree_ensemble">
<span id="tree-ensemble"></span><h2>tree_ensemble<a class="headerlink" href="#module-coremltools.models.tree_ensemble" title="Link to this heading"></a></h2>
<p>Tree ensemble builder class to construct CoreML models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleBase</span></span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase" title="Link to this definition"></a></dt>
<dd><p>Base class for the tree ensemble builder class.  This should be instantiated
either through the <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="coremltools.models.tree_ensemble.TreeEnsembleRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleRegressor</span></code></a> or
<a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="coremltools.models.tree_ensemble.TreeEnsembleClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeEnsembleClassifier</span></code></a> classes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.__init__" title="Link to this definition"></a></dt>
<dd><p>High level Python API to build a tree ensemble model for Core ML.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node">
<span class="sig-name descname"><span class="pre">add_branch_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_child_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value_tracks_true_child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.add_branch_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_branch_node" title="Link to this definition"></a></dt>
<dd><p>Add a branch node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>feature_index: int</strong></dt><dd><p>Index of the feature in the input being split on.</p>
</dd>
<dt><strong>feature_value: double or int</strong></dt><dd><p>The value used in the feature comparison determining the traversal
direction from this node.</p>
</dd>
<dt><strong>branch_mode: str</strong></dt><dd><p>Branch mode of the node, specifying the condition under which the node
referenced by <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code> is called next.</p>
<p>Must be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueLessThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&lt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThanEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueGreaterThan&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">&gt;</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">==</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BranchOnValueNotEqual&quot;</span></code>. Traverse to node <code class="docutils literal notranslate"><span class="pre">true_child_id</span></code>
if <code class="docutils literal notranslate"><span class="pre">input[feature_index]</span> <span class="pre">!=</span> <span class="pre">feature_value</span></code>, and <code class="docutils literal notranslate"><span class="pre">false_child_id</span></code>
otherwise.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>true_child_id: int</strong></dt><dd><p>ID of the child under the true condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>false_child_id: int</strong></dt><dd><p>ID of the child under the false condition of the split.  An error will
be raised at model validation if this does not match the <code class="docutils literal notranslate"><span class="pre">node_id</span></code>
of a node instantiated by <code class="docutils literal notranslate"><span class="pre">add_branch_node</span></code> or <code class="docutils literal notranslate"><span class="pre">add_leaf_node</span></code> within
this <code class="docutils literal notranslate"><span class="pre">tree_id</span></code>.</p>
</dd>
<dt><strong>relative_hit_rate: float [optional]</strong></dt><dd><p>When the model is converted compiled by CoreML, this gives hints to
Core ML about which node is more likely to be hit on evaluation,
allowing for additional optimizations. The values can be on any scale,
with the values between child nodes being compared relative to each
other.</p>
</dd>
<dt><strong>missing_value_tracks_true_child: bool [optional]</strong></dt><dd><p>If the training data contains NaN values or missing values, then this
flag determines which direction a NaN value traverses.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node">
<span class="sig-name descname"><span class="pre">add_leaf_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_hit_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.add_leaf_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.add_leaf_node" title="Link to this definition"></a></dt>
<dd><p>Add a leaf node to the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tree_id: int</strong></dt><dd><p>ID of the tree to add the node to.</p>
</dd>
<dt><strong>node_id: int</strong></dt><dd><p>ID of the node within the tree.</p>
</dd>
<dt><strong>values: [float | int | list | dict]</strong></dt><dd><p>Value(s) at the leaf node to add to the prediction when this node is
activated.  If the prediction dimension of the tree is 1, then the
value is specified as a float or integer value.</p>
<p>For multidimensional predictions, the values can be a list of numbers
with length matching the dimension of the predictions or a dictionary
mapping index to value added to that dimension.</p>
<p>Note that the dimension of any tree must match the dimension given
when <a class="reference internal" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_prediction_value()</span></code></a> is called.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value">
<span class="sig-name descname"><span class="pre">set_default_prediction_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.set_default_prediction_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_default_prediction_value" title="Link to this definition"></a></dt>
<dd><p>Set the default prediction value(s).</p>
<p>The values given here form the base prediction value that the values
at activated leaves are added to.  If values is a scalar, then
the output of the tree must also be 1 dimensional; otherwise, values
must be a list with length matching the dimension of values in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>values: [int | double | list[double]]</strong></dt><dd><p>Default values for predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform">
<span class="sig-name descname"><span class="pre">set_post_evaluation_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleBase.set_post_evaluation_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleBase.set_post_evaluation_transform" title="Link to this definition"></a></dt>
<dd><p>Set the post processing transform applied after the prediction value
from the tree ensemble.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>value: str</strong></dt><dd><p>A value denoting the transform applied.  Possible values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;NoTransform&quot;</span></code> (default).  Do not apply a transform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Classification_SoftMax&quot;</span></code>.</p>
<p>Apply a softmax function to the outcome to produce normalized,
non-negative scores that sum to 1.  The transformation applied to
dimension <cite>i</cite> is equivalent to:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{e^{x_i}}{\sum_j e^{x_j}}\]</div>
</div></blockquote>
<p>Note: This is the output transformation applied by the XGBoost package
with multiclass classification.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Regression_Logistic&quot;</span></code>.</p>
<p>Applies a logistic transform the predicted value, specifically:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[(1 + e^{-v})^{-1}\]</div>
</div></blockquote>
<p>This is the transformation used in binary classification.</p>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier" title="Link to this definition"></a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble classification model.</p>
<p>The TreeEnsembleClassifier class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<p>In the following example, the code saves the model to disk, which is a
recommended practice but not required.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleClassifier</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">                                output_features = &quot;predicted_class&quot;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Put in a softmax transform to translate these into probabilities.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_post_evaluation_transform</span><span class="p">(</span><span class="s2">&quot;Classification_SoftMax&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleClassifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleClassifier.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a tree ensemble classifier model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>class_labels: [list]</strong></dt><dd><p>A list of string or integer class labels to use in making predictions.
The length of this must match the dimension of the tree model.</p>
</dd>
<dt><strong>output_features: [list]</strong></dt><dd><p>A string or a list of two strings specifying the names of the two
output features, the first being a class label corresponding
to the class with the highest predicted score, and the second being
a dictionary mapping each class to its score. If <code class="docutils literal notranslate"><span class="pre">output_features</span></code>
is a string, it specifies the predicted class label and the class
scores is set to the default value of <code class="docutils literal notranslate"><span class="pre">&quot;classProbability&quot;</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.tree_ensemble.</span></span><span class="sig-name descname"><span class="pre">TreeEnsembleRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor" title="Link to this definition"></a></dt>
<dd><p>Tree Ensemble builder class to construct a Tree Ensemble regression model.</p>
<p>The TreeEnsembleRegressor class constructs a Tree Ensemble model incrementally
using methods to add branch and leaf nodes specifying the behavior of the model.</p>
<p class="rubric">Examples</p>
<p>In the following example, the code saves the model to disk, which is a
recommended practice but not required.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Required inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">datatypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.tree_ensemble</span> <span class="kn">import</span> <span class="n">TreeEnsembleRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define input features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">()))]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define output_features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;predicted_values&quot;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Double</span><span class="p">())]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span> <span class="o">=</span> <span class="n">TreeEnsembleRegressor</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">output_features</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Split on a[2] &lt;= 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueLessThanEqual&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 0 that subtracts 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add split on b == 0 to the false branch of node 0, which is index 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_branch_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;BranchOnValueEqual&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the true branch of node 2 that adds 1 to the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add leaf to the false branch of node 2 that subtracts 1 from the result.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">add_leaf_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tm</span><span class="o">.</span><span class="n">set_default_prediction_value</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save the model to a .mlmodel file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./tree.mlmodel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load the .mlmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_input</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/tree_ensemble.html#TreeEnsembleRegressor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.tree_ensemble.TreeEnsembleRegressor.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a Tree Ensemble regression model that takes one or more input
features and maps them to an output feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>features: [list of features]</strong></dt><dd><p>Name(s) of the input features, given as a list of <code class="docutils literal notranslate"><span class="pre">('name',</span> <span class="pre">datatype)</span></code>
tuples.  The features are one of <code class="docutils literal notranslate"><span class="pre">models.datatypes.Int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatypes.Double</span></code>, or <code class="docutils literal notranslate"><span class="pre">models.datatypes.Array</span></code>.
Feature indices in the nodes are counted sequentially from 0 through
the features.</p>
</dd>
<dt><strong>target:  (default = None)</strong></dt><dd><p>Name of the target feature predicted.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-coremltools.models.utils" title="Link to this heading"></a></h2>
<p>Utilities for the entire package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">MultiFunctionDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor" title="Link to this definition"></a></dt>
<dd><p>This data class defines how to construct a multifunction model from different model sources.
Use the <code class="docutils literal notranslate"><span class="pre">add_function</span></code> method to specify the path to the source <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>,
along with the source and target function names.</p>
<p>After setting the <code class="docutils literal notranslate"><span class="pre">default_function_name</span></code> to the <code class="docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code> instance,
you can export a multifunction model using the <code class="docutils literal notranslate"><span class="pre">save_multifunction</span></code> method.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.save_multifunction" title="coremltools.models.utils.save_multifunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_multifunction</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">MultiFunctionDescriptor</span><span class="p">,</span> <span class="n">save_multifunction</span>

<span class="c1"># Initialize a MultiFunctionDescriptor instance with functions in an existing mlpackage.</span>
<span class="c1"># desc will contain all functions in &quot;my_model.mlpackage&quot;</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>

<span class="c1"># Construct a MultiFunctionDescriptor instance from scratch.</span>
<span class="c1"># The below code inserts the &quot;main&quot; function from &quot;my_model.mlpackage&quot; as &quot;main_1&quot;,</span>
<span class="c1"># and inserts the &quot;main&quot; function from &quot;my_model_2.mlpackage&quot; as &quot;main_2&quot;.</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">()</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">,</span>
    <span class="n">source_function_name</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">target_function_name</span><span class="o">=</span><span class="s2">&quot;main_1&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;my_model_2.mlpackage&quot;</span><span class="p">,</span>
    <span class="n">source_function_name</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">target_function_name</span><span class="o">=</span><span class="s2">&quot;main_2&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Each MultiFunctionDescriptor instance must have a default function name</span>
<span class="c1"># so it can be saved as a multifunction mlpackage on disk.</span>
<span class="n">desc</span><span class="o">.</span><span class="n">default_function_name</span> <span class="o">=</span> <span class="s2">&quot;main_1&quot;</span>
<span class="n">save_multifunction</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="s2">&quot;my_multifunction_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.__init__" title="Link to this definition"></a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">model_path</span></code> is passed to the constructor, it must be a <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code> pointing to an
existing <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code> on disk. The <a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a> instance will be initiated
with the functions in <code class="docutils literal notranslate"><span class="pre">model_path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.add_function">
<span class="sig-name descname"><span class="pre">add_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.add_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.add_function" title="Link to this definition"></a></dt>
<dd><p>Insert a <code class="docutils literal notranslate"><span class="pre">src_function_name</span></code> function from <code class="docutils literal notranslate"><span class="pre">model_path</span></code> as the
<code class="docutils literal notranslate"><span class="pre">target_function_name</span></code> function in the multifunction descriptor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.add_model">
<span class="sig-name descname"><span class="pre">add_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.add_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.add_model" title="Link to this definition"></a></dt>
<dd><p>Insert all functions from the model in <code class="docutils literal notranslate"><span class="pre">model_path</span></code> into the multifunction descriptor.
The function names will remain the same as in the original model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.utils.MultiFunctionDescriptor.remove_function">
<span class="sig-name descname"><span class="pre">remove_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#MultiFunctionDescriptor.remove_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.MultiFunctionDescriptor.remove_function" title="Link to this definition"></a></dt>
<dd><p>Remove a function <code class="docutils literal notranslate"><span class="pre">function_name</span></code> from the multifunction descriptor.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.bisect_model">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">bisect_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_chunks_to_pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_output_correctness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#bisect_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.bisect_model" title="Link to this definition"></a></dt>
<dd><p>Utility function to split a mlpackage model into two mlpackages of approximately same file size.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>model: str or MLModel</strong></dt><dd><p>Path to the mlpackage file, or a Core ML model, to be split into two mlpackages of approximately same file size.</p>
</dd>
<dt><strong>output_dir: str</strong></dt><dd><p>Path to output directory where the two model chunks / pipeline model would be saved.</p>
<p>If the <cite>model</cite> is <cite>{path}/{model_name}.mlpackage</cite>, the chunk models are going to be saved as:
1. first chunk model: <cite>{output_dir}/{model_name}_chunk1.mlpackage</cite>
2. second chunk model: <cite>{output_dir}/{model_name}_chunk2.mlpackage</cite>
3. chunked pipeline model: <cite>{output_dir}/{model_name}_chunked_pipeline.mlpackage</cite></p>
<p>If the <cite>model</cite> is type of <cite>MLModel</cite>, the chunk models are saved as:
1. first chunk model: <cite>{output_dir}/chunk1.mlpackage</cite>
2. second chunk model: <cite>{output_dir}/chunk2.mlpackage</cite>
3. chunked pipeline model: <cite>{output_dir}/chunked_pipeline.mlpackage</cite></p>
</dd>
<dt><strong>merge_chunks_to_pipeline: bool</strong></dt><dd><p>If True, model chunks are managed inside a single pipeline model for easier asset maintenance.</p>
</dd>
<dt><strong>check_output_correctness: bool</strong></dt><dd><ul class="simple">
<li><p>If True, compares the outputs of original Core ML model with that of pipelined CoreML model chunks and reports PSNR in dB.</p></li>
<li><p>Enabling this feature uses more memory. Disable it if your machine runs out of memory.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">coremltools</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="s2">&quot;my_model.mlpackage&quot;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;./output/&quot;</span>

<span class="c1"># The following code will produce two smaller models:</span>
<span class="c1"># `./output/my_model_chunk1.mlpackage` and `./output/my_model_chunk2.mlpackage`</span>
<span class="c1"># It also compares the output numerical of the original Core ML model with the chunked models.</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The following code will produce a single pipeline model `./output/my_model_chunked_pipeline.mlpackage`</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">merge_chunks_to_pipeline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># You can also pass the MLModel object directly</span>
<span class="n">mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">bisect_model</span><span class="p">(</span>
    <span class="n">mlmodel</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">merge_chunks_to_pipeline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.change_input_output_tensor_type">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">change_input_output_tensor_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ml_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayFeatureType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayFeatureType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#change_input_output_tensor_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.change_input_output_tensor_type" title="Link to this definition"></a></dt>
<dd><p>Change the tensor data types of Core ML model inputs / outputs. Supported types are FLOAT16, FLOAT32.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ml_model: MLModel</strong></dt><dd><p>A Core ML model that needs to change its input/output type.
Note:
- the original model is not modified, the model with updated types is returned as a new instance.
- only an mlProgram is supported (not pipelines, not neural networks).</p>
</dd>
<dt><strong>from_type:</strong></dt><dd><p>The type that should be changed from.</p>
</dd>
<dt><strong>to_type:</strong></dt><dd><p>The type that will be used instead of all the <cite>from_type</cite> type.</p>
</dd>
<dt><strong>function_names:</strong></dt><dd><p>Optional list of function names where the input/output needs to be changed. If not specified, only the “main”
function will be updated.</p>
</dd>
<dt><strong>input_names:</strong></dt><dd><p>Optional list of input names that should be updated (by default none of the inputs will be updated).</p>
</dd>
<dt><strong>output_names:</strong></dt><dd><p>Optional list of output names that should be updated (by default all the outputs that match the <cite>from_type</cite>
type will be updated).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.model</span> <span class="kn">import</span> <span class="n">MLModel</span>
<span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">change_input_output_tensor_type</span>
<span class="kn">from</span> <span class="nn">coremltools.proto.FeatureTypes_pb2</span> <span class="kn">import</span> <span class="n">ArrayFeatureType</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>
<span class="n">updated_model</span> <span class="o">=</span> <span class="n">change_input_output_tensor_type</span><span class="p">(</span>
    <span class="n">ml_model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">from_type</span><span class="o">=</span><span class="n">ArrayFeatureType</span><span class="o">.</span><span class="n">FLOAT32</span><span class="p">,</span>
    <span class="n">to_type</span><span class="o">=</span><span class="n">ArrayFeatureType</span><span class="o">.</span><span class="n">FLOAT16</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">updated_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_updated_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.compile_model">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">compile_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#compile_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.compile_model" title="Link to this definition"></a></dt>
<dd><p>Compiles a Core ML model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: Model_pb2 | str</strong></dt><dd><p>Either a Core ML model specification (protobuf object) or a path to a saved model (.mlmodel or .mlpackage) file.</p>
</dd>
<dt><strong>destination_path: str</strong></dt><dd><p>Path where the compiled model will be saved.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>str</strong><span class="classifier">Path to compiled model directory</span></dt><dd><p>If the <code class="docutils literal notranslate"><span class="pre">destination_path</span></code> is specified, that is the value that will be returned.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.CompiledMLModel" title="coremltools.models.CompiledMLModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coremltools.models.CompiledMLModel</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models</span> <span class="kn">import</span> <span class="n">CompiledMLModel</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">compile_model</span>
<span class="kn">from</span> <span class="nn">coremltools.proto</span> <span class="kn">import</span> <span class="n">Model_pb2</span>

<span class="n">spec</span> <span class="o">=</span> <span class="n">Model_pb2</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
<span class="n">spec</span><span class="o">.</span><span class="n">specificationVersion</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">input_</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">input_</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="n">input_</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">doubleType</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">output_</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">output_</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="n">output_</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">doubleType</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">predictedFeatureName</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">glmRegressor</span>
<span class="n">lr</span><span class="o">.</span><span class="n">offset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
<span class="n">weights</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">compiled_model_path</span> <span class="o">=</span> <span class="n">compile_model</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">CompiledMLModel</span><span class="p">(</span><span class="n">compiled_model_path</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.convert_double_to_float_multiarray_type">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">convert_double_to_float_multiarray_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#convert_double_to_float_multiarray_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.convert_double_to_float_multiarray_type" title="Link to this definition"></a></dt>
<dd><p>Convert all double multiarrays feature descriptions (input, output, training input)
to float multiarrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the multiarrays types to convert.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place convert multiarray type of spec</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_double_to_float_multiarray_type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_classifier">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier" title="Link to this definition"></a></dt>
<dd><p>Evaluate a Core ML classifier model and compare against predictions
from the original framework (for testing correctness of conversion).
Use this evaluation for models that don’t deal with probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: list of str or list of MLModel</strong></dt><dd><p>File to load the model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: list of str or list of Dataframe</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a CSV file).</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Column to interpret as the target column.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="coremltools.models.utils.evaluate_classifier_with_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier_with_probabilities</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_classifier</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;data_and_predictions.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="p">{</span><span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num_errors</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_classifier_with_probabilities">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_classifier_with_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'probabilities'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_classifier_with_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_classifier_with_probabilities" title="Link to this definition"></a></dt>
<dd><p>Evaluate a classifier specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: [str | Model]</strong></dt><dd><p>File to load the model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>data: [str | Dataframe]</strong></dt><dd><p>Test data on which to evaluate the models (dataframe,
or path to a CSV file).</p>
</dd>
<dt><strong>probabilities: str</strong></dt><dd><p>Column to interpret as the probabilities column.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_regressor">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_regressor" title="Link to this definition"></a></dt>
<dd><p>Evaluate a Core ML regression model and compare against predictions
from the original framework (for testing correctness of conversion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: MLModel or str</strong></dt><dd><p>A loaded MLModel or a path to a saved MLModel.</p>
</dd>
<dt><strong>data: Dataframe</strong></dt><dd><p>Test data on which to evaluate the models.</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Name of the column in the dataframe to be compared against the prediction.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Set to true for a more verbose output.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_regressor</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;data_and_predictions.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="p">{</span><span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;rmse&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">max_error</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.evaluate_transformer">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#evaluate_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.evaluate_transformer" title="Link to this definition"></a></dt>
<dd><p>Evaluate a transformer specification for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model: list of str or list of MLModel</strong></dt><dd><p>File to load the Model from, or a loaded
version of the MLModel.</p>
</dd>
<dt><strong>input_data: list of dict</strong></dt><dd><p>Test data on which to evaluate the models.</p>
</dd>
<dt><strong>reference_output: list of dict</strong></dt><dd><p>Expected results for the model.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Verbosity levels of the predictions.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.evaluate_regressor" title="coremltools.models.utils.evaluate_regressor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_regressor</span></code></a>, <a class="reference internal" href="#coremltools.models.utils.evaluate_classifier" title="coremltools.models.utils.evaluate_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_classifier</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_data</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}]</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s2">&quot;input_2&quot;</span><span class="p">:</span> <span class="mf">2.3</span><span class="p">}]</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">evaluate_transformer</span><span class="p">(</span>
    <span class="n">scaler_spec</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">expected_output</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.load_spec">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">load_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_proto.Model_pb2</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#load_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.load_spec" title="Link to this definition"></a></dt>
<dd><p>Load a protobuf model specification from file (<code class="docutils literal notranslate"><span class="pre">mlmodel</span></code>) or directory (<code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_path: Path to the model from which the protobuf spec is loaded.</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>model_spec: Model_pb</dt><dd><p>Protobuf representation of the model.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.save_spec" title="coremltools.models.utils.save_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.make_pipeline">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">make_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#make_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.make_pipeline" title="Link to this definition"></a></dt>
<dd><p>Makes a pipeline with the given models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*models</strong></dt><dd><p>Two or more instances of <code class="docutils literal notranslate"><span class="pre">ct.models.MLModel</span></code>.</p>
</dd>
<dt><strong>compute_units</strong></dt><dd><p>The set of processing units that all models in the pipeline can use to make predictions.
Can be <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit</span></code>.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> will be inferred from the <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> values of the models.
If all models do not have the same <code class="docutils literal notranslate"><span class="pre">compute_unit</span></code> values, this parameter must be specified.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit</span></code> is an enum with four possible values:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.ALL</span></code>: Use all compute units available, including the
neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_ONLY</span></code>: Limit the model to only use the CPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_GPU</span></code>: Use both the CPU and GPU,
but not the neural engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coremltools.ComputeUnit.CPU_AND_NE</span></code>: Use both the CPU and neural engine, but
not the GPU. Available only for macOS &gt;= 13.0.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ct.models.MLModel</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/m1.mlpackage&quot;</span><span class="p">)</span>
<span class="n">my_model2</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/m2.mlmodel&quot;</span><span class="p">)</span>

<span class="n">my_pipeline_model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_pipeline</span><span class="p">(</span><span class="n">my_model1</span><span class="p">,</span> <span class="n">my_model2</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_pipeline_model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>

<span class="n">my_pipeline_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/tmp/my_pipeline.mlpackage&quot;</span><span class="p">)</span>
<span class="n">new_my_pipeline</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;/tmp/my_pipeline.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.materialize_dynamic_shape_mlmodel">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">materialize_dynamic_shape_mlmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_shape_mlmodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name_to_materialization_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/utils.html#materialize_dynamic_shape_mlmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.materialize_dynamic_shape_mlmodel" title="Link to this definition"></a></dt>
<dd><p>Given a dynamic-shape mlmodel, materialize symbols to create fixed-shape functions,
then save as an .mlpackage to destination path.
To save memory, the pymil program of input dynamic-shape mlmodel is re-used.
Constant deduplication across functions is performed to allow weight sharing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dynamic_shape_mlmodel</strong><span class="classifier">ct.models.MLModel</span></dt><dd><p>A dynamic-shape mlmodel to be materialized</p>
</dd>
<dt><strong>function_name_to_materialization_map: Dict[str, Dict[str, Tuple[int]]]</strong></dt><dd><p>A dictionary specifying the name of new functions to be created,
and for each new function what is the new fixed shapes for inputs.
If a new function has the same name as an old function,
then the old function will be overridden</p>
</dd>
<dt><strong>destination_path</strong><span class="classifier">str</span></dt><dd><p>The saved .mlpackage model path</p>
</dd>
<dt><strong>source_function_name: str</strong></dt><dd><p>The name of the source symbolic-shape function to be materialized, default = main</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">coremltools.converters.mil.mil.passes.defs.experiment.materialize_symbolic_shape_program</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">materialize_dynamic_shape_mlmodel</span>

<span class="c1"># A dynamic-shape mlmodel you have converted</span>
<span class="n">dynamic_shape_mlmodel</span><span class="p">:</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span>

<span class="c1"># As an example, let us assume the inputs are</span>
<span class="c1"># 1. ``input_ids (1, query_length)``</span>
<span class="c1"># 2. ``mask (query_length, context_length)``</span>
<span class="n">function_name_to_materialization_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;function_name_to_materialization_map&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;materialization_2_3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)},</span>
        <span class="s2">&quot;materialization_4_5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)},</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">materialize_dynamic_shape_mlmodel</span><span class="p">(</span>
    <span class="n">dynamic_shape_mlmodel</span><span class="p">,</span>
    <span class="n">function_name_to_materialization_map</span><span class="p">,</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To make prediction from the materialized mlmodel, load the desired materialized function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">materialization_2_3</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;materialization_2_3&quot;</span>
<span class="p">)</span>
<span class="n">materialization_4_5</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;materialized_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;materialization_4_5&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.randomize_weights">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">randomize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlmodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#randomize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.randomize_weights" title="Link to this definition"></a></dt>
<dd><p>Utility function to randomize weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mlmodel: MLModel</strong></dt><dd><p>Model which will be randomized.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>model: MLModel</dt><dd><p>The MLModel with randomized weights.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">coremltools</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;my_model.mlpackage&quot;</span><span class="p">)</span>
<span class="n">randomized_mlmodel</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">randomize_weights</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.rename_feature">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">rename_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#rename_feature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.rename_feature" title="Link to this definition"></a></dt>
<dd><p>Rename a feature in the specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>The specification containing the feature to rename.</p>
</dd>
<dt><strong>current_name: str</strong></dt><dd><p>Current name of the feature. If this feature doesn’t exist, the rename
is a no-op.</p>
</dd>
<dt><strong>new_name: str</strong></dt><dd><p>New name of the feature.</p>
</dd>
<dt><strong>rename_inputs: bool</strong></dt><dd><p>Search for <code class="docutils literal notranslate"><span class="pre">current_name</span></code> only in the input features (that is, ignore output
features).</p>
</dd>
<dt><strong>rename_outputs: bool</strong></dt><dd><p>Search for <code class="docutils literal notranslate"><span class="pre">current_name</span></code> only in the output features (that is, ignore input
features).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-place rename of spec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="s2">&quot;model.mlmodel&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_feature</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;old_feature&quot;</span><span class="p">,</span> <span class="s2">&quot;new_feature_name&quot;</span><span class="p">)</span>
<span class="c1"># re-initialize model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlmodel&quot;</span><span class="p">)</span>

<span class="c1"># Rename a spec when the model is an mlprogram, in that case, weights are stored outside of the spec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">torch_model</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s2">&quot;mlprogram&quot;</span><span class="p">)</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_spec</span><span class="p">()</span>
<span class="c1"># print info about inputs and outputs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_feature</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;old_feature&quot;</span><span class="p">,</span> <span class="s2">&quot;new_feature_name&quot;</span><span class="p">)</span>
<span class="c1"># re-initialize model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLModel</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">weights_dir</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.save_multifunction">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">save_multifunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><span class="pre">MultiFunctionDescriptor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#save_multifunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.save_multifunction" title="Link to this definition"></a></dt>
<dd><p>Save a <a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a> instance into a multifunction <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>.
This function also performs constant deduplication across functions to allow for weight sharing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>desc: MultiFunctionDescriptor</strong></dt><dd><p>Multifunction descriptor to save on the disk.</p>
</dd>
<dt><strong>destination_path: str</strong></dt><dd><p>The path where the new <code class="docutils literal notranslate"><span class="pre">mlpackage</span></code> will be saved.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.MultiFunctionDescriptor" title="coremltools.models.utils.MultiFunctionDescriptor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiFunctionDescriptor</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.utils</span> <span class="kn">import</span> <span class="n">MultiFunctionDescriptor</span><span class="p">,</span> <span class="n">save_multifunction</span>

<span class="n">desc</span> <span class="o">=</span> <span class="n">MultiFunctionDescriptor</span><span class="p">(</span><span class="s2">&quot;my_model_1.mlpackage&quot;</span><span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">add_function</span><span class="p">(</span><span class="s2">&quot;my_model_2.mlpackage&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="s2">&quot;main_2&quot;</span><span class="p">)</span>
<span class="n">desc</span><span class="o">.</span><span class="n">default_function_name</span> <span class="o">=</span> <span class="s2">&quot;main_2&quot;</span>

<span class="n">save_multifunction</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="s2">&quot;multifunction_model.mlpackage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.utils.save_spec">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.utils.</span></span><span class="sig-name descname"><span class="pre">save_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_set_specification_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/utils.html#save_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.utils.save_spec" title="Link to this definition"></a></dt>
<dd><p>Save a protobuf model specification to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec: Model_pb</strong></dt><dd><p>Protobuf representation of the model.</p>
</dd>
<dt><strong>filename: str</strong></dt><dd><p>File path where the spec is saved.</p>
</dd>
<dt><strong>auto_set_specification_version: bool</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will always try to set specification version automatically.</p>
</dd>
<dt><strong>weights_dir: str</strong></dt><dd><p>Path to the directory containing the weights.bin file. This is required
when the spec has model type <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code>. If the <code class="docutils literal notranslate"><span class="pre">mlprogram</span></code> does not contain
any weights, this path can be an empty directory.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.utils.load_spec" title="coremltools.models.utils.load_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spec</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;HousePricer.mlmodel&quot;</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;HousePricer.mlpackage&quot;</span><span class="p">)</span>
<span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">save_spec</span><span class="p">(</span>
    <span class="n">spec</span><span class="p">,</span> <span class="s2">&quot;mlprogram_model.mlpackage&quot;</span><span class="p">,</span> <span class="n">weights_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/weights/directory&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coremltools.models.compute_plan">
<span id="compute-plan"></span><h2>compute_plan<a class="headerlink" href="#module-coremltools.models.compute_plan" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLComputePlan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan" title="Link to this definition"></a></dt>
<dd><p>Represents the plan for executing a model.</p>
<p>The application can use the plan to estimate the necessary cost and
resources of the model before running the predictions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_mlprogram_operation">
<span class="sig-name descname"><span class="pre">get_compute_device_usage_for_mlprogram_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramOperation" title="coremltools.models.compute_plan.MLModelStructureProgramOperation"><span class="pre">MLModelStructureProgramOperation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage" title="coremltools.models.compute_plan.MLComputePlanDeviceUsage"><span class="pre">MLComputePlanDeviceUsage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlan.get_compute_device_usage_for_mlprogram_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_mlprogram_operation" title="Link to this definition"></a></dt>
<dd><p>Returns the estimated cost of executing an ML Program operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>operation</strong><span class="classifier">MLModelStructureProgramOperation</span></dt><dd><p>An ML Program operation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Optional[MLComputePlanDeviceUsage]</dt><dd><p>The anticipated compute devices that would be used for executing the operation or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the usage couldn’t be determined.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_neuralnetwork_layer">
<span class="sig-name descname"><span class="pre">get_compute_device_usage_for_neuralnetwork_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer" title="coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer"><span class="pre">MLModelStructureNeuralNetworkLayer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage" title="coremltools.models.compute_plan.MLComputePlanDeviceUsage"><span class="pre">MLComputePlanDeviceUsage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlan.get_compute_device_usage_for_neuralnetwork_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.get_compute_device_usage_for_neuralnetwork_layer" title="Link to this definition"></a></dt>
<dd><p>Returns the estimated cost of executing a NeuralNetwork layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>operation</strong><span class="classifier">MLModelStructureProgramOperation</span></dt><dd><p>A NeuralNetwork layer.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Optional[MLComputePlanDeviceUsage]</dt><dd><p>The anticipated compute devices that would be used for executing the layer or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the usage couldn’t be determined.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.get_estimated_cost_for_mlprogram_operation">
<span class="sig-name descname"><span class="pre">get_estimated_cost_for_mlprogram_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramOperation" title="coremltools.models.compute_plan.MLModelStructureProgramOperation"><span class="pre">MLModelStructureProgramOperation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanCost" title="coremltools.models.compute_plan.MLComputePlanCost"><span class="pre">MLComputePlanCost</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlan.get_estimated_cost_for_mlprogram_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.get_estimated_cost_for_mlprogram_operation" title="Link to this definition"></a></dt>
<dd><p>Returns the estimated cost of executing an ML Program operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>operation</strong><span class="classifier">MLModelStructureProgramOperation</span></dt><dd><p>An ML Program operation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Optional[MLComputePlanCost]</dt><dd><p>The estimated cost of executing the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.load_from_path">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlan.load_from_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.load_from_path" title="Link to this definition"></a></dt>
<dd><p>Loads the compute plan of a compiled model.</p>
<p>The path must be the location of the <code class="docutils literal notranslate"><span class="pre">mlmodelc</span></code> directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>compiled_model_path</strong><span class="classifier">str</span></dt><dd><p>The path to the compiled model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>The plan for executing the model.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">compute_plan</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">compute_plan</span><span class="o">.</span><span class="n">MLComputePlan</span><span class="o">.</span><span class="n">load_from_path</span><span class="p">(</span>
    <span class="n">model</span><span class="o">.</span><span class="n">get_compiled_path</span><span class="p">()</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected model type.&quot;</span><span class="p">)</span>

<span class="n">program</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span>
<span class="n">mainFunction</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">mainFunction</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
    <span class="c1"># Get the compute device usage for the operation.</span>
    <span class="n">compute_device_usage</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_compute_device_usage_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Get the estimated cost of executing the operation.</span>
    <span class="n">estimated_cost</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_estimated_cost_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.load_from_path_on_device">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_path_on_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.load_from_path_on_device" title="Link to this definition"></a></dt>
<dd><p>Loads the compute plan of a compiled model on a remote or local device.</p>
<p>The path must be the location of the <code class="docutils literal notranslate"><span class="pre">mlmodelc</span></code> directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the compiled model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>The plan for executing the model.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve a development device.</span>
<span class="n">devices</span> <span class="o">=</span> <span class="n">Device</span><span class="o">.</span><span class="n">get_connected_development_devices</span><span class="p">(</span><span class="n">device_type</span><span class="o">=</span><span class="n">DeviceType</span><span class="o">.</span><span class="n">IPHONE</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Prepare device for model debugging.</span>
<span class="n">device</span> <span class="o">=</span> <span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">prepare_for_model_debugging</span><span class="p">()</span>
<span class="n">compute_plan</span> <span class="o">=</span> <span class="k">await</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">compute_plan_utils</span><span class="o">.</span><span class="n">load_compute_plan_from_path_on_device</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">get_compiled_path</span><span class="p">(),</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected model type.&quot;</span><span class="p">)</span>

<span class="n">program</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span>
<span class="n">mainFunction</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">mainFunction</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
    <span class="c1"># Get the compute device usage for the operation.</span>
    <span class="n">compute_device_usage</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_compute_device_usage_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Get the estimated cost of executing the operation.</span>
    <span class="n">estimated_cost</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_estimated_cost_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlan.model_structure">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_structure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructure" title="coremltools.models.compute_plan.MLModelStructure"><span class="pre">MLModelStructure</span></a></em><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlan.model_structure" title="Link to this definition"></a></dt>
<dd><p>Returns the model structure.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlanCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLComputePlanCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlanCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlanCost" title="Link to this definition"></a></dt>
<dd><p>Represents the estimated cost of executing a layer/operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weight</strong><span class="classifier">float</span></dt><dd><p>The estimated workload of executing the operation over the total model execution. The value is between [0.0, 1.0].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLComputePlanDeviceUsage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLComputePlanDeviceUsage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preferred_compute_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice" title="coremltools.models.compute_device.MLComputeDevice"><span class="pre">MLComputeDevice</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">supported_compute_devices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice" title="coremltools.models.compute_device.MLComputeDevice"><span class="pre">MLComputeDevice</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLComputePlanDeviceUsage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage" title="Link to this definition"></a></dt>
<dd><p>Represents the anticipated compute devices that would be used for executing a layer/operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>preferred_compute_device</strong><span class="classifier">MLComputeDevice</span></dt><dd><p>The compute device that the framework prefers to execute the layer/operation.</p>
</dd>
<dt><strong>supported_compute_devices</strong><span class="classifier">List[MLComputeDevice]</span></dt><dd><p>The compute device that the framework prefers to execute the layer/operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructure">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuralnetwork</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetwork" title="coremltools.models.compute_plan.MLModelStructureNeuralNetwork"><span class="pre">MLModelStructureNeuralNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgram" title="coremltools.models.compute_plan.MLModelStructureProgram"><span class="pre">MLModelStructureProgram</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructurePipeline" title="coremltools.models.compute_plan.MLModelStructurePipeline"><span class="pre">MLModelStructurePipeline</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructure" title="Link to this definition"></a></dt>
<dd><p>Represents the structure of a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>neuralnetwork</strong><span class="classifier">Optional[MLModelStructureNeuralNetwork]</span></dt><dd><p>The structure of a NeuralNetwork model, if the model is a NeuralNetwork; otherwise None.</p>
</dd>
<dt><strong>program</strong><span class="classifier">Optional[MLModelStructureProgram]</span></dt><dd><p>The structure of an ML Program model, if the model is an ML Program; otherwise, None.</p>
</dd>
<dt><strong>pipeline</strong><span class="classifier">Optional[MLModelStructurePipeline]</span></dt><dd><p>The structure of a Pipeline model. if the model is a Pipeline; otherwise None.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructure.load_from_path">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compiled_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructure" title="coremltools.models.compute_plan.MLModelStructure"><span class="pre">MLModelStructure</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructure.load_from_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructure.load_from_path" title="Link to this definition"></a></dt>
<dd><p>Loads the structure of a compiled model.</p>
<p>The path must be the location of the <code class="docutils literal notranslate"><span class="pre">mlmodelc</span></code> directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>compiled_model_path (str): The path to the compiled model.</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelStructure</dt><dd><p>An instance of MLModelStructure.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_structure</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">compute_plan</span><span class="o">.</span><span class="n">MLModelStructure</span><span class="o">.</span><span class="n">load_from_path</span><span class="p">(</span>
    <span class="n">model</span><span class="o">.</span><span class="n">get_compiled_path</span><span class="p">()</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">model_structure</span><span class="o">.</span><span class="n">neuralNetwork</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Examine Neural network model.</span>
    <span class="k">pass</span>
<span class="k">elif</span> <span class="n">model_structure</span><span class="o">.</span><span class="n">program</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Examine ML Program model.</span>
    <span class="k">pass</span>
<span class="k">elif</span> <span class="n">model_structure</span><span class="o">.</span><span class="n">pipeline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Examine Pipeline model.</span>
    <span class="k">pass</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># The model type is something else.</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureNeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureNeuralNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer" title="coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer"><span class="pre">MLModelStructureNeuralNetworkLayer</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureNeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetwork" title="Link to this definition"></a></dt>
<dd><p>Represents the structure of a neural network model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>layers</strong><span class="classifier">List[MLModelStructureNeuralNetworkLayer]</span></dt><dd><p>The list of layers in the neural network.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureNeuralNetworkLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__proxy__</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureNeuralNetworkLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureNeuralNetworkLayer" title="Link to this definition"></a></dt>
<dd><p>Represents a layer in a neural network model structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the neural network layer.</p>
</dd>
<dt><strong>type</strong><span class="classifier">str</span></dt><dd><p>The type of the layer (e.g., ‘Dense’, ‘Convolutional’, etc.).</p>
</dd>
<dt><strong>input_names</strong><span class="classifier">List[str]</span></dt><dd><p>A list of names representing the inputs to this layer.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">List[str]</span></dt><dd><p>A list of names representing the outputs from this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructurePipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructurePipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructure" title="coremltools.models.compute_plan.MLModelStructure"><span class="pre">MLModelStructure</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructurePipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructurePipeline" title="Link to this definition"></a></dt>
<dd><p>Represents the structure of a pipeline model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sub_models</strong><span class="classifier">Tuple[str, MLModelStructure]</span></dt><dd><p>The list of sub-models in the pipeline.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramFunction" title="coremltools.models.compute_plan.MLModelStructureProgramFunction"><span class="pre">MLModelStructureProgramFunction</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgram" title="Link to this definition"></a></dt>
<dd><p>Represents the structure of an ML Program model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>functions</strong><span class="classifier">Dict[str, MLModelStructureProgramFunction]</span></dt><dd><p>The functions in the program.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramArgument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramArgument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bindings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramBinding" title="coremltools.models.compute_plan.MLModelStructureProgramBinding"><span class="pre">MLModelStructureProgramBinding</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramArgument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramArgument" title="Link to this definition"></a></dt>
<dd><p>Represents an argument in an ML Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>bindings</strong><span class="classifier">List[MLModelStructureProgramBinding]</span></dt><dd><p>The list of bindings.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramBinding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramBinding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramValue" title="coremltools.models.compute_plan.MLModelStructureProgramValue"><span class="pre">MLModelStructureProgramValue</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramBinding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramBinding" title="Link to this definition"></a></dt>
<dd><p>Represents a binding between a name and a program value in an ML Program.
This is either a previously defined name of a variable or a constant value in the Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">Optional[str]</span></dt><dd><p>The name of the variable, it can be None.</p>
</dd>
<dt><strong>value</strong><span class="classifier">Optional[MLModelStructureProgramValue]</span></dt><dd><p>The constant value, it can be None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramNamedValueType" title="coremltools.models.compute_plan.MLModelStructureProgramNamedValueType"><span class="pre">MLModelStructureProgramNamedValueType</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramOperation" title="coremltools.models.compute_plan.MLModelStructureProgramOperation"><span class="pre">MLModelStructureProgramOperation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramBlock" title="Link to this definition"></a></dt>
<dd><p>Represents a block in an ML Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">List[MLModelStructureProgramNamedValueType]</span></dt><dd><p>The named inputs to the block.</p>
</dd>
<dt><strong>operator_name</strong><span class="classifier">str</span></dt><dd><p>The name of the operator, e.g., “conv”, “pool”, “softmax”, etc.</p>
</dd>
<dt><strong>outputs</strong><span class="classifier">List[MLModelStructureProgramNamedValueType]</span></dt><dd><p>The outputs of the Operation.</p>
</dd>
<dt><strong>blocks: List[MLModelStructureProgramBlock]</strong></dt><dd><p>The list of nested blocks for loops and conditionals, e.g., a conditional block will have two entries here.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramNamedValueType" title="coremltools.models.compute_plan.MLModelStructureProgramNamedValueType"><span class="pre">MLModelStructureProgramNamedValueType</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramBlock" title="coremltools.models.compute_plan.MLModelStructureProgramBlock"><span class="pre">MLModelStructureProgramBlock</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramFunction" title="Link to this definition"></a></dt>
<dd><p>Represents a function in an ML Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">List[MLModelStructureProgramNamedValueType]</span></dt><dd><p>The named inputs to the function.</p>
</dd>
<dt><strong>block</strong><span class="classifier">MLModelStructureProgramBlock</span></dt><dd><p>The active block in the function.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramNamedValueType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramNamedValueType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramValueType" title="coremltools.models.compute_plan.MLModelStructureProgramValueType"><span class="pre">MLModelStructureProgramValueType</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramNamedValueType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramNamedValueType" title="Link to this definition"></a></dt>
<dd><p>Represents a parameter’s name and type in an ML Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the parameter.</p>
</dd>
<dt><strong>type</strong><span class="classifier">MLModelStructureProgramValueType</span></dt><dd><p>The type of the parameter.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramOperation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramOperation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramArgument" title="coremltools.models.compute_plan.MLModelStructureProgramArgument"><span class="pre">MLModelStructureProgramArgument</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramNamedValueType" title="coremltools.models.compute_plan.MLModelStructureProgramNamedValueType"><span class="pre">MLModelStructureProgramNamedValueType</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_plan.MLModelStructureProgramBlock" title="coremltools.models.compute_plan.MLModelStructureProgramBlock"><span class="pre">MLModelStructureProgramBlock</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__proxy__</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramOperation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramOperation" title="Link to this definition"></a></dt>
<dd><p>Represents an operation in an ML Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Dict[str, MLModelStructureProgramArgument]</span></dt><dd><p>The arguments to the Operation.</p>
</dd>
<dt><strong>operator_name</strong><span class="classifier">str</span></dt><dd><p>The name of the operator, e.g., “conv”, “pool”, “softmax”, etc.</p>
</dd>
<dt><strong>outputs</strong><span class="classifier">List[MLModelStructureProgramNamedValueType]</span></dt><dd><p>The outputs of the Operation.</p>
</dd>
<dt><strong>blocks</strong><span class="classifier">List[MLModelStructureProgramBlock]</span></dt><dd><p>The list of nested blocks for loops and conditionals, e.g., a conditional block will have two entries here.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramValue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramValue</span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramValue" title="Link to this definition"></a></dt>
<dd><p>Represents the value of a constant in an ML Program.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_plan.MLModelStructureProgramValueType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_plan.</span></span><span class="sig-name descname"><span class="pre">MLModelStructureProgramValueType</span></span><a class="reference internal" href="../_modules/coremltools/models/compute_plan.html#MLModelStructureProgramValueType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_plan.MLModelStructureProgramValueType" title="Link to this definition"></a></dt>
<dd><p>Represents the type of a value or a variable in an ML Program.</p>
</dd></dl>

</section>
<section id="module-coremltools.models.compute_device">
<span id="compute-device"></span><h2>compute_device<a class="headerlink" href="#module-coremltools.models.compute_device" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLCPUComputeDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_device.</span></span><span class="sig-name descname"><span class="pre">MLCPUComputeDevice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_device.html#MLCPUComputeDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_device.MLCPUComputeDevice" title="Link to this definition"></a></dt>
<dd><p>Represents a CPU compute device.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLComputeDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_device.</span></span><span class="sig-name descname"><span class="pre">MLComputeDevice</span></span><a class="reference internal" href="../_modules/coremltools/models/compute_device.html#MLComputeDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_device.MLComputeDevice" title="Link to this definition"></a></dt>
<dd><p>Represents a compute device.</p>
<p>The represented device is capable of running machine learning computations and other tasks like
analysis and processing of images, sound, etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLComputeDevice.get_all_compute_devices">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_all_compute_devices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.compute_device.MLComputeDevice" title="coremltools.models.compute_device.MLComputeDevice"><span class="pre">MLComputeDevice</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/compute_device.html#MLComputeDevice.get_all_compute_devices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_device.MLComputeDevice.get_all_compute_devices" title="Link to this definition"></a></dt>
<dd><p>Returns the list of all of the compute devices that are accessible.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[MLComputeDevice]</dt><dd><p>The accessible compute devices.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">compute_devices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">compute_device</span><span class="o">.</span><span class="n">MLComputeDevice</span><span class="o">.</span><span class="n">get_all_compute_devices</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLGPUComputeDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_device.</span></span><span class="sig-name descname"><span class="pre">MLGPUComputeDevice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_device.html#MLGPUComputeDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_device.MLGPUComputeDevice" title="Link to this definition"></a></dt>
<dd><p>Represents a GPU compute device.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLNeuralEngineComputeDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.compute_device.</span></span><span class="sig-name descname"><span class="pre">MLNeuralEngineComputeDevice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/compute_device.html#MLNeuralEngineComputeDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.compute_device.MLNeuralEngineComputeDevice" title="Link to this definition"></a></dt>
<dd><p>Represents a Neural Engine compute device.</p>
<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.compute_device.MLNeuralEngineComputeDevice.total_core_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_core_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#coremltools.models.compute_device.MLNeuralEngineComputeDevice.total_core_count" title="Link to this definition"></a></dt>
<dd><p>Get the total number of cores in the Neural Engine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd><p>The total number of cores in the Neural Engine.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">compute_devices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">compute_device</span><span class="o">.</span><span class="n">MLComputeDevice</span><span class="o">.</span><span class="n">get_all_compute_devices</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">compute_devices</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">compute_device</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">compute_device</span><span class="p">,</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">compute_device</span><span class="o">.</span><span class="n">MLNeuralEngineComputeDevice</span>
    <span class="p">),</span>
    <span class="n">compute_devices</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">neural_engine_compute_device</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">compute_devices</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">neural_engine_core_count</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">neural_engine_compute_device</span><span class="o">.</span><span class="n">total_core_count</span>
    <span class="k">if</span> <span class="n">neural_engine_compute_device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">else</span> <span class="mi">0</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="experimental">
<h2>experimental<a class="headerlink" href="#experimental" title="Link to this heading"></a></h2>
<section id="torch">
<h3>torch<a class="headerlink" href="#torch" title="Link to this heading"></a></h3>
<section id="module-coremltools.models.ml_program.experimental.torch.debugging_utils">
<span id="debugging-utils"></span><h4>debugging_utils<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.torch.debugging_utils" title="Link to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.FrameInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">FrameInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#FrameInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.FrameInfo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchExportMLModelComparator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExportedProgram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchExportMLModelComparator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator" title="Link to this definition"></a></dt>
<dd><p>Compares intermediate outputs between a PyTorch ExportedProgram and its converted Core ML model.</p>
<p>This class facilitates the comparison of intermediate outputs from a PyTorch model
and its corresponding Core ML conversion. It helps identify specific PyTorch operations
that may produce divergent results in the converted model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExportedProgram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchExportMLModelComparator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the TorchExportMLModelComparator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">torch.export.ExportedProgram</span></dt><dd><p>The ExportedProgram to be compared.</p>
</dd>
<dt><strong>num_predict_intermediate_outputs</strong><span class="classifier">int</span></dt><dd><p>The number of intermediate outputs to retrieve in each <code class="docutils literal notranslate"><span class="pre">MLModel</span></code> prediction call. Defaults to 20.</p>
</dd>
<dt><strong>target_device</strong><span class="classifier">Optional[Device]</span></dt><dd><p>The target device on which to run the Core ML model. If None, the current default device will be used.</p>
</dd>
<dt><strong>**converter_kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments to be passed to the Core ML converter. These can include
options like ‘minimum_deployment_target’, ‘compute_units’, etc., allowing for fine-tuning
of the conversion process.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator.find_failing_ops">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Node</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Node</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchExportMLModelComparator.find_failing_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchExportMLModelComparator.find_failing_ops" title="Link to this definition"></a></dt>
<dd><p>Identifies operations that produce different outputs in the reference and target models.</p>
<p>This method compares the outputs of the source and target models for specified operations,
identifying those that fail the comparison criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs: Tuple[torch.tensor]</strong></dt><dd><p>Input data for the model.</p>
</dd>
<dt><strong>compare_outputs</strong><span class="classifier">Callable[[proto.MIL_pb2.Operation, np.array, np.array], bool])</span></dt><dd><p>A function to compare outputs of an operation between the two models.</p>
</dd>
<dt><strong>outputs: Optional[List[torch.fx.Node]]</strong></dt><dd><p>Specific outputs to compare. If None, all model outputs are compared. Defaults to None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[proto.MIL_pb2.Operation]</dt><dd><p>A list of operations that failed the comparison.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method uses a breadth-first search strategy to traverse the operation graph.</p></li>
<li><p>An operation is considered a failure source if it fails comparison while its direct inputs do not.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">input1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">input2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
<span class="n">exported_program</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

<span class="n">comparator</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">TorchExportMLModelComparator</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">exported_program</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
            <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span>
            <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="n">minimum_deployment_target</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">iOS16</span><span class="p">,</span>
        <span class="n">compute_units</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">compare_outputs</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">comparator</span><span class="o">.</span><span class="n">find_failing_ops</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">compare_outputs</span><span class="o">=</span><span class="n">compare_outputs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchNodeToMILOperationMapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_to_operations_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Node</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation_output_name_to_node_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Node</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchNodeToMILOperationMapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping" title="Link to this definition"></a></dt>
<dd><p>A class that represents the mapping between PyTorch nodes and MIL operations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping.get_source_nodes_for_operation">
<span class="sig-name descname"><span class="pre">get_source_nodes_for_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Operation</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Node</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchNodeToMILOperationMapping.get_source_nodes_for_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping.get_source_nodes_for_operation" title="Link to this definition"></a></dt>
<dd><p>Retrieves the source node for a given MIL operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>operation</strong><span class="classifier">proto.MIL_pb2.Operation</span></dt><dd><p>The MIL operation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Optional[TorchNode]</dt><dd><p>The corresponding TorchNode if found, None otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping.get_source_nodes_for_output_name">
<span class="sig-name descname"><span class="pre">get_source_nodes_for_output_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Node</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchNodeToMILOperationMapping.get_source_nodes_for_output_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping.get_source_nodes_for_output_name" title="Link to this definition"></a></dt>
<dd><p>Retrieves the source node for a given MIL operation’s output name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output_name</strong><span class="classifier">str</span></dt><dd><p>The name of the output.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Optional[TorchNode]</dt><dd><p>The corresponding TorchNode if found, None otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchScriptMLModelComparator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptMLModelComparator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator" title="Link to this definition"></a></dt>
<dd><p>A class for comparing the the intermediate outputs of a torch model with its converted Core ML model.</p>
<p>This class provides functionality to compare the intermediate outputs of a torch model and
the converted Core ML model, helping to identify the torch modules that produce different results.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptMLModelComparator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the TorchScriptMLModelComparator.</p>
<p>This constructor sets up the comparator by preparing both the PyTorch model and its Core ML counterpart
for comparison. It traces the PyTorch model, converts it to a Core ML model, and initializes necessary attributes
for the comparison process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator.find_failing_modules">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_module_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo"><span class="pre">TorchScriptModuleMappingInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptMLModelComparator.find_failing_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptMLModelComparator.find_failing_modules" title="Link to this definition"></a></dt>
<dd><p>Asynchronously finds failing operations in the converted model.</p>
<p>This method compares the outputs of the source PyTorch model with the
converted Core ML model to identify operations that produce different results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Tuple[torch.tensor]</span></dt><dd><p>Input data for the models.</p>
</dd>
<dt><strong>compare_outputs</strong><span class="classifier">CompareOutputs</span></dt><dd><p>Function to compare outputs between models.</p>
</dd>
<dt><strong>source_module_keys</strong><span class="classifier">Optional[List[TorchScriptModuleInfo.Key]]</span></dt><dd><p>Specific module keys to check. Defaults to None (checks all modules).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[TorchModuleMLModelMappingInfo]</dt><dd><p>A list of failing modules.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">input1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">input2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">example_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
<span class="n">comparator</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">TorchScriptMLModelComparator</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">example_inputs</span><span class="o">=</span><span class="n">example_inputs</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
            <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
            <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="n">minimum_deployment_target</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">iOS16</span><span class="p">,</span>
        <span class="n">compute_units</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">compare_outputs</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">modules</span> <span class="o">=</span> <span class="k">await</span> <span class="n">comparator</span><span class="o">.</span><span class="n">find_failing_modules</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">example_inputs</span><span class="p">,</span> <span class="n">compare_outputs</span><span class="o">=</span><span class="n">compare_outputs</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchScriptModuleAnnotator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleAnnotator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator" title="Link to this definition"></a></dt>
<dd><p>A class for annotating the module graph.</p>
<p>This class provides methods to annotate torch modules, track their call sequences,
and analyze node dependencies within the graph.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.annotate_module">
<span class="sig-name descname"><span class="pre">annotate_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ScriptModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hierarchy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ContextManager</span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleAnnotator.annotate_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.annotate_module" title="Link to this definition"></a></dt>
<dd><p>Creates a context manager for annotating a module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hierarchy</strong><span class="classifier">Tuple[str]</span></dt><dd><p>The hierarchical path of the module.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the module.</p>
</dd>
<dt><strong>graph</strong><span class="classifier">_TorchGraph</span></dt><dd><p>The module graph.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ContextManager</dt><dd><p>A context manager for module annotation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.enter_module">
<span class="sig-name descname"><span class="pre">enter_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ScriptModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hierarchy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleAnnotator.enter_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.enter_module" title="Link to this definition"></a></dt>
<dd><p>Enters a module context and annotates its graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hierarchy</strong><span class="classifier">List[str]</span></dt><dd><p>The hierarchical path of the module.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the module.</p>
</dd>
<dt><strong>graph</strong><span class="classifier">_TorchGraph</span></dt><dd><p>The module graph.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.exit_module">
<span class="sig-name descname"><span class="pre">exit_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleAnnotator.exit_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.exit_module" title="Link to this definition"></a></dt>
<dd><p>Exits a module context and finalizes annotations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.module_call_stack">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">module_call_stack</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OrderedDict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleInfo"><span class="pre">TorchScriptModuleInfo</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.module_call_stack" title="Link to this definition"></a></dt>
<dd><p>Returns a copy of the module call stack.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.node_infos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_infos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OrderedDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator.node_infos" title="Link to this definition"></a></dt>
<dd><p>Returns a copy of the node information dictionary.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchScriptModuleInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hierarchy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submodules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleInfo" title="Link to this definition"></a></dt>
<dd><p>Represents information about a torch module.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd></dd>
<dt><strong>The name of the module.</strong></dt><dd></dd>
<dt><strong>call_sequence</strong></dt><dd></dd>
<dt><strong>The sequence number of this module call.</strong></dt><dd></dd>
<dt><strong>hierarchy</strong><span class="classifier">List[str]</span></dt><dd></dd>
<dt><strong>The hierarchical path of the module.</strong></dt><dd></dd>
<dt><strong>output_names</strong><span class="classifier">List[str]</span></dt><dd></dd>
<dt><strong>Names of the module’s outputs.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchScriptModuleMappingInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">source:</span> <span class="pre">~coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleInfo,</span> <span class="pre">source_to_target_ops_mapping:</span> <span class="pre">~collections.OrderedDict[slice(&lt;class</span> <span class="pre">'coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo'&gt;,</span> <span class="pre">typing.List[MIL_pb2.Operation],</span> <span class="pre">None)],</span> <span class="pre">deps:</span> <span class="pre">~typing.Dict[~typing.Tuple[str,</span> <span class="pre">int],</span> <span class="pre">~typing.Iterable[~coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo]],</span> <span class="pre">outputs:</span> <span class="pre">~typing.List[~MIL_pb2.Operation],</span> <span class="pre">submodules:</span> <span class="pre">~typing.List[~coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptModuleMappingInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleMappingInfo" title="Link to this definition"></a></dt>
<dd><p>A class that holds mapping information for a TorchScript module
and its corresponding operations in the converted Core ML model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source</strong><span class="classifier">TorchScriptModuleInfo</span></dt><dd><p>An instance representing the source module that is being mapped.</p>
</dd>
<dt><strong>source_to_target_mapping</strong><span class="classifier">OrderedDict[TorchScriptNodeInfo, List[proto.MIL_pb2.Operation]]</span></dt><dd><p>An ordered mapping from nodes in the source TorchScript module to
a list of corresponding operations in Core ML. Each key represents
a node in the module, while each value is a list of
operations that correspond to that node in the target model.</p>
</dd>
<dt><strong>deps</strong><span class="classifier">Dict[TorchScriptModuleInfo.Key, Iterable[TorchScriptModuleInfo.Key]]:</span></dt><dd><p>A dictionary mapping each module to its immediate dependencies.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">TorchScriptNodeInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#TorchScriptNodeInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="Link to this definition"></a></dt>
<dd><p>Represents information about a node in a torch graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_range</strong><span class="classifier">str</span></dt><dd></dd>
<dt><strong>The node’s source range.</strong></dt><dd></dd>
<dt><strong>modules</strong><span class="classifier">Iterable[“TorchScriptModuleInfo.Key”]</span></dt><dd></dd>
<dt><strong>The modules to which this node belongs.</strong></dt><dd></dd>
<dt><strong>input_names</strong><span class="classifier">List[str]</span></dt><dd></dd>
<dt><strong>The input names.</strong></dt><dd></dd>
<dt><strong>output_names</strong><span class="classifier">List[str]</span></dt><dd></dd>
<dt><strong>The output names.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.convert_and_retrieve_op_mapping">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">convert_and_retrieve_op_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExportedProgram</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ScriptModule</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchNodeToMILOperationMapping"><span class="pre">TorchNodeToMILOperationMapping</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#convert_and_retrieve_op_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.convert_and_retrieve_op_mapping" title="Link to this definition"></a></dt>
<dd><p>Converts a TorchScript model to a Core ML model and returns the
mapping information mapping between the source TorchScript operations and their
corresponding operations in the converted Core ML model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">ScriptModule or ExportedProgram</span></dt><dd><p>The source model.</p>
</dd>
<dt><strong>**converter_kwargs:</strong></dt><dd><p>Additional keyword arguments to be passed to the Core ML conversion process.
These can include options for optimization, input/output specifications, etc.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[MLModel, TorchNodeToMILOperationMapping]</dt><dd><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>The converted Core ML model.</p></li>
<li><p>A dictionary-like object mapping each TorchScript node from the original model
to a list of corresponding MIL operations in the Core ML model.
This mapping helps trace the origin of operations in the converted
model back to the source model for debugging and analysis</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">target_model</span><span class="p">,</span>
    <span class="n">mapping_info</span><span class="p">,</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">convert_and_retrieve_op_mapping</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">traced_model</span><span class="p">,</span>  <span class="c1"># ScriptModule or ExportedProgram</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">example_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span>
        <span class="p">),</span>
        <span class="n">coremltools</span><span class="o">.</span><span class="n">TensorType</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">example_inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">minimum_deployment_target</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">iOS16</span><span class="p">,</span>
    <span class="n">compute_units</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">CPU_ONLY</span><span class="p">,</span>
    <span class="n">skip_model_load</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.get_stack_frame_infos">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">get_stack_frame_infos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Node</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.FrameInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.FrameInfo"><span class="pre">FrameInfo</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#get_stack_frame_infos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.get_stack_frame_infos" title="Link to this definition"></a></dt>
<dd><p>Extracts frame infos from the node’s source range.</p>
<p>This method parses the stack trace of the node, attempts to extract the filename and line number
using a regular expression.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.debugging_utils.inline_and_annotate_module">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">inline_and_annotate_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ScriptModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptModuleAnnotator"><span class="pre">TorchScriptModuleAnnotator</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/debugging_utils.html#inline_and_annotate_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.inline_and_annotate_module" title="Link to this definition"></a></dt>
<dd><p>Inlines and annotates a TorchScript module.</p>
<dl>
<dt>This function takes a TorchScript module and performs two operations:</dt><dd><p>1. Inlining: It inlines the module, which means it replaces calls to submodules
with the actual operations performed by those submodules.</p>
<p>2. Annotation: It adds annotations to the module, providing additional
information about the module’s structure and operations.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">ScriptModule</span></dt><dd><p>The TorchScript module to be inlined and annotated. This should be an
instance of ScriptModule, which is a subclass of torch.nn.Module
that has been scripted using torch.jit.script().</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>TorchScriptModuleAnnotator</dt><dd><p>An annotator object that contains the inlined and annotated version of
the input module.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.models.ml_program.experimental.torch.perf_utils">
<span id="perf-utils"></span><h4>perf_utils<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.torch.perf_utils" title="Link to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.torch.perf_utils.</span></span><span class="sig-name descname"><span class="pre">TorchMLModelBenchmarker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExportedProgram</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ScriptModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">converter_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/perf_utils.html#TorchMLModelBenchmarker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker" title="Link to this definition"></a></dt>
<dd><p>A specialized benchmarker for PyTorch models.</p>
<p>This class extends the <code class="docutils literal notranslate"><span class="pre">MLModelBenchmarker</span></code> to provide benchmarking capabilities
specifically tailored for PyTorch model. It inherits all the functionality
of <code class="docutils literal notranslate"><span class="pre">MLModelBenchmarker</span></code> and includes methods to provide estimated execution times
for torch nodes and submodules.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.ModuleExecutionInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ModuleExecutionInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'TorchMLModelBenchmarker.NodeExecutionInfo'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'MLModelBenchmarker.Measurement'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/perf_utils.html#TorchMLModelBenchmarker.ModuleExecutionInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.ModuleExecutionInfo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.NodeExecutionInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NodeExecutionInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo" title="coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo"><span class="pre">coremltools.models.ml_program.experimental.torch.debugging_utils.TorchScriptNodeInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.fx.node.Node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo" title="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo"><span class="pre">coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'MLModelBenchmarker.Measurement'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/perf_utils.html#TorchMLModelBenchmarker.NodeExecutionInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.NodeExecutionInfo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.benchmark_module_execution">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">benchmark_module_execution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.ModuleExecutionInfo" title="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.ModuleExecutionInfo"><span class="pre">ModuleExecutionInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/perf_utils.html#TorchMLModelBenchmarker.benchmark_module_execution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.benchmark_module_execution" title="Link to this definition"></a></dt>
<dd><p>Measures the execution time of modules in the PyTorch model.</p>
<p>This method loads the converted model, runs predictions, and retrieves the execution time
of each operation within the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>The input data for the model prediction. If None, random input data will be generated.</p>
</dd>
<dt><strong>iterations: int</strong></dt><dd><p>The number of prediction iterations to run. Defaults to 1.</p>
</dd>
<dt><strong>warmup: bool</strong></dt><dd><p>Whether to perform a warmup iteration. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[TorchModuleExecutionInfo]</dt><dd><p>A list of <code class="docutils literal notranslate"><span class="pre">TorchModuleExecutionInfo</span></code> objects, each containing
details about an modules’s execution, sorted by execution time in descending order.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The returned list is sorted by execution time, with the most time-consuming operations first.</p></li>
<li><p>Execution times are estimated based on the overall prediction time and the converted model’s compute plan.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.benchmark_node_execution">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">benchmark_node_execution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.NodeExecutionInfo" title="coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.NodeExecutionInfo"><span class="pre">NodeExecutionInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/torch/perf_utils.html#TorchMLModelBenchmarker.benchmark_node_execution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.torch.perf_utils.TorchMLModelBenchmarker.benchmark_node_execution" title="Link to this definition"></a></dt>
<dd><p>Measures the execution time of individual nodes in the PyTorch model.</p>
<p>This method loads the converted model, runs predictions, and retrieves the execution time
of each operation within the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>The input data for the model prediction. If None, random input data will be generated.</p>
</dd>
<dt><strong>iterations: int</strong></dt><dd><p>The number of prediction iterations to run. Defaults to 1.</p>
</dd>
<dt><strong>warmup: bool</strong></dt><dd><p>Whether to perform a warmup iteration. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[TorchNodeExecutionInfo]</dt><dd><p>A list of TorchNodeExecutionInfo objects, each containing
details about an node’s execution, sorted by execution time in descending order.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The returned list is sorted by execution time, with the most time-consuming operations first.</p></li>
<li><p>Execution times are estimated based on the overall prediction time and the converted model’s compute plan.</p></li>
</ul>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-coremltools.models.ml_program.experimental.remote_device">
<span id="remote-device"></span><h3>remote_device<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.remote_device" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.AppSigningCredentials">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.remote_device.</span></span><span class="sig-name descname"><span class="pre">AppSigningCredentials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">development_team</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provisioning_profile_uuid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle_identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#AppSigningCredentials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.AppSigningCredentials" title="Link to this definition"></a></dt>
<dd><p>Represents the credentials required for signing an iOS application.</p>
<p>This class encapsulates the essential information needed for code signing an iOS app,
including the development team identifier and optionally the bundle identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>development_team</strong><span class="classifier">Optional[str]</span></dt><dd><p>The development team identifier associated with the Apple Developer account.</p>
</dd>
<dt><strong>provisioning_profile_uuid</strong><span class="classifier">Optional[str]</span></dt><dd><p>The UUID of the provisioning profile. This is used to specify which provisioning
profile should be applied during the code-signing process.</p>
</dd>
<dt><strong>bundle_identifier</strong><span class="classifier">Optional[str]</span></dt><dd><p>The bundle identifier for the application. This is an optional parameter that, if provided,
should be in the format of a reverse domain name (e.g., “com.example.app”). If None, the
bundle identifier from the project’s settings will be used.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Either <code class="docutils literal notranslate"><span class="pre">provisioning_profile_uuid</span></code> or <code class="docutils literal notranslate"><span class="pre">development_team</span></code> must be provided:</dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">provisioning_profile_uuid</span></code> is provided, then <code class="docutils literal notranslate"><span class="pre">bundle_identifier</span></code> must match
the one defined in the provisioning profile.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">development_team</span></code> is provided, Xcode will automatically create and manage
a provisioning profile during the build process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.remote_device.</span></span><span class="sig-name descname"><span class="pre">ComputePlan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath"><span class="pre">coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'ComputePlan.OperationOrLayerInfo'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan" title="Link to this definition"></a></dt>
<dd><dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan.CPUDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CPUDevice</span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan.CPUDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan.CPUDevice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan.DeviceUsage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DeviceUsage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preferred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'ComputePlan.Device'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supported</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'ComputePlan.Device'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan.DeviceUsage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan.DeviceUsage" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan.GPUDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GPUDevice</span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan.GPUDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan.GPUDevice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan.NeuralEngineDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NeuralEngineDevice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_core_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan.NeuralEngineDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan.NeuralEngineDevice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.ComputePlan.OperationOrLayerInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OperationOrLayerInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device_usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'ComputePlan.DeviceUsage'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath"><span class="pre">coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#ComputePlan.OperationOrLayerInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.ComputePlan.OperationOrLayerInfo" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.Device">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.remote_device.</span></span><span class="sig-name descname"><span class="pre">Device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.DeviceType" title="coremltools.models.ml_program.experimental.remote_device.DeviceType"><span class="pre">DeviceType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_build_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">developer_mode_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.DeviceState" title="coremltools.models.ml_program.experimental.remote_device.DeviceState"><span class="pre">DeviceState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_AppSession</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#Device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="Link to this definition"></a></dt>
<dd><p>Represents a device.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the device.</p>
</dd>
<dt><strong>type</strong><span class="classifier">DeviceType</span></dt><dd><p>The type of the device.</p>
</dd>
<dt><strong>identifier</strong><span class="classifier">str</span></dt><dd><p>A unique identifier for the device.</p>
</dd>
<dt><strong>udid</strong><span class="classifier">str</span></dt><dd><p>The device identifier.</p>
</dd>
<dt><strong>os_version</strong><span class="classifier">str</span></dt><dd><p>The operating system version of the device.</p>
</dd>
<dt><strong>os_build_number</strong><span class="classifier">str</span></dt><dd><p>The build number of the os.</p>
</dd>
<dt><strong>developer_mode_state</strong><span class="classifier">str</span></dt><dd><p>The state of developer mode on the device.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.Device.get_connected_devices">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_connected_devices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.DeviceType" title="coremltools.models.ml_program.experimental.remote_device.DeviceType"><span class="pre">DeviceType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#Device.get_connected_devices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.Device.get_connected_devices" title="Link to this definition"></a></dt>
<dd><p>Retrieve a list of connected devices of a specified type.</p>
<p>This function uses the DeviceCtl utility to fetch all accessible devices and filters them
based on the following criteria:
1. The device is in a connected state
2. The device matches the specified device_type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>device_type</strong><span class="classifier">DeviceType</span></dt><dd><p>The type of device to filter for (e.g., iPhone, iPad, Apple TV).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[Device]</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.Device.get_devices">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_devices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#Device.get_devices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.Device.get_devices" title="Link to this definition"></a></dt>
<dd><p>Retrieve a list of available devices.</p>
<p>This method fetches and returns a list of all accessible devices
using the DeviceCtl utility.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[Device]</dt><dd><p>A list of Device objects representing the available devices.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.Device.prepare_for_model_debugging">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prepare_for_model_debugging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">credentials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.AppSigningCredentials" title="coremltools.models.ml_program.experimental.remote_device.AppSigningCredentials"><span class="pre">AppSigningCredentials</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#Device.prepare_for_model_debugging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.Device.prepare_for_model_debugging" title="Link to this definition"></a></dt>
<dd><p>Prepares the device for model debugging by building and launching the model runner app.</p>
<p>This method checks if the device is in the correct state for debugging, sets up the working
directory, builds the <code class="docutils literal notranslate"><span class="pre">modelrunner</span></code> application, and launches it on the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>credentials</strong><span class="classifier">Optional[AppSigningCredentials</span></dt><dd><p>The credentials required for signing <code class="docutils literal notranslate"><span class="pre">modelrunner</span></code> application.</p>
</dd>
<dt><strong>working_directory: Optional[Path]</strong></dt><dd><p>The directory utilized for storing files required for building and communicating
with the <code class="docutils literal notranslate"><span class="pre">modelrunner</span></code> application. If None, a temporary director will be created.
Defaults to None.</p>
</dd>
<dt><strong>clean</strong><span class="classifier">bool</span></dt><dd><p>If True, performs a clean build. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Device</dt><dd><p>A new Device instance with the prepared session.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.DeviceState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.remote_device.</span></span><span class="sig-name descname"><span class="pre">DeviceState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#DeviceState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.DeviceState" title="Link to this definition"></a></dt>
<dd><p>Enumeration of device states.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>CONNECTING</strong><span class="classifier">str</span></dt><dd><p>The device is connecting.</p>
</dd>
<dt><strong>CONNECTED</strong><span class="classifier">str</span></dt><dd><p>The device is connected.</p>
</dd>
<dt><strong>AVAILABLE</strong><span class="classifier">str</span></dt><dd><p>The device is available for use.</p>
</dd>
<dt><strong>UNAVAILABLE</strong><span class="classifier">str</span></dt><dd><p>The device is not available for use.</p>
</dd>
<dt><strong>DISCONNECTED :str</strong></dt><dd><p>The device is disconnected.</p>
</dd>
<dt><strong>UNKNOWN</strong><span class="classifier">str</span></dt><dd><p>Represents an unknown device state.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.remote_device.DeviceType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.remote_device.</span></span><span class="sig-name descname"><span class="pre">DeviceType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/remote_device.html#DeviceType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.remote_device.DeviceType" title="Link to this definition"></a></dt>
<dd><p>Enumeration of device types.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>MAC</strong><span class="classifier">str</span></dt><dd><p>Represents a Mac device.</p>
</dd>
<dt><strong>IPHONE</strong><span class="classifier">str</span></dt><dd><p>Represents an iPhone device.</p>
</dd>
<dt><strong>IPAD</strong><span class="classifier">str</span></dt><dd><p>Represents an iPad device</p>
</dd>
<dt><strong>APPLETV</strong><span class="classifier">str</span></dt><dd><p>Represents an Apple TV device.</p>
</dd>
<dt><strong>WATCH</strong><span class="classifier">str</span></dt><dd><p>Represents an Apple Watch device.</p>
</dd>
<dt><strong>HOMEPOD</strong><span class="classifier">str</span></dt><dd><p>Represents a HomePod device.</p>
</dd>
<dt><strong>UNKNOWN</strong><span class="classifier">str</span></dt><dd><p>Represents an unknown device type.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="id1">
<h3>debugging_utils<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<span class="target" id="module-coremltools.models.ml_program.experimental.debugging_utils"></span><dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">MLModelComparator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelComparator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator" title="Link to this definition"></a></dt>
<dd><p>A class for comparing two MLModel objects and identifying discrepancies in their outputs.</p>
<p>This class provides functionality to compare the outputs of a reference model and a target model,
helping to identify operations that produce different results.</p>
<p>The ModelComparator is designed to compare models derived from the same source.
Using it with reference and target models originating from different sources may
lead to unreliable or meaningless results.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the reference and target models</span>
<span class="n">reference_model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;model.mlpackage&quot;</span><span class="p">,</span> <span class="n">compute_unit</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">CPU_ONLY</span>
<span class="p">)</span>
<span class="n">target_model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;model.mlpackage&quot;</span><span class="p">,</span> <span class="n">compute_unit</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">CPU_AND_GPU</span>
<span class="p">)</span>
<span class="c1"># Create an instance of MLModelComparator</span>
<span class="n">comparator</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelComparator</span><span class="p">(</span>
        <span class="n">reference_model</span><span class="p">,</span> <span class="n">target_model</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="c1"># Prepare input data</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>
<span class="c1"># Find failing operations with a PSNR of less than 40.</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">comparator</span><span class="o">.</span><span class="n">find_failing_ops</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">compare_output</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">compute_snr_and_psnr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">40.0</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelComparator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the MLModelComparator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reference_model</strong><span class="classifier">MLModel</span></dt><dd><p>The reference MLModel.</p>
</dd>
<dt><strong>target_model</strong><span class="classifier">MLModel</span></dt><dd><p>The target MLModel to compare against the reference.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">Optional[str]</span></dt><dd><p>The function name. Defaults to the model’s function name.</p>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>Keys are the names of the optimization hint, either ‘reshapeFrequency’ or ‘specializationStrategy’.
Values are enumeration values of type <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.SpecializationStrategy</span></code>.</p>
</dd>
<dt><strong>num_predict_intermediate_outputs</strong><span class="classifier">int</span></dt><dd><p>The number of intermediate outputs to retrieve in each <code class="docutils literal notranslate"><span class="pre">MLModel</span></code> prediction call. Defaults to 20.</p>
</dd>
<dt><strong>reference_device: Device</strong></dt><dd><p>The device on which the reference model will execute.</p>
</dd>
<dt><strong>target_device: Device</strong></dt><dd><p>The device on which the target model will execute.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator.find_failing_ops">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inputs:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~numpy.array],</span> <span class="pre">compare_outputs:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation,</span> <span class="pre">~numpy.array,</span> <span class="pre">~numpy.array],</span> <span class="pre">bool],</span> <span class="pre">output_names:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">skip_op:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">skip_op_by_type&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelComparator.find_failing_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelComparator.find_failing_ops" title="Link to this definition"></a></dt>
<dd><p>Identifies operations that produce different outputs in the reference and target models.</p>
<p>This method compares the outputs of the reference and target models for specified operations,
identifying those that fail the comparison criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Dict[str, np.array]</span></dt><dd><p>Input data for the models.</p>
</dd>
<dt><strong>compare_outputs</strong><span class="classifier">Callable[[proto.MIL_pb2.Operation, np.array, np.array], bool])</span></dt><dd><p>A function to compare outputs of an operation between the two models.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">Optional[List[str]], optional)</span></dt><dd><p>Names of specific outputs to compare. If None, all model outputs are compared. Defaults to None.</p>
</dd>
<dt><strong>skip_op: Callable[[proto.MIL_pb2.Operation], bool]</strong></dt><dd><p>A function that determines if an operation should be skipped.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[proto.MIL_pb2.Operation]</dt><dd><p>A list of operations that failed the comparison.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method uses a breadth-first search strategy to traverse the operation graph.</p></li>
<li><p>An operation is considered a failure source if it fails comparison while its direct inputs do not.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the reference and target models</span>
<span class="n">reference_model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;model.mlpackage&quot;</span><span class="p">,</span> <span class="n">compute_unit</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">CPU_ONLY</span>
<span class="p">)</span>
<span class="n">target_model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span>
    <span class="s2">&quot;model.mlpackage&quot;</span><span class="p">,</span> <span class="n">compute_unit</span><span class="o">=</span><span class="n">coremltools</span><span class="o">.</span><span class="n">ComputeUnit</span><span class="o">.</span><span class="n">CPU_AND_GPU</span>
<span class="p">)</span>
<span class="c1"># Create an instance of MLModelComparator</span>
<span class="n">comparator</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelComparator</span><span class="p">(</span>
        <span class="n">reference_model</span><span class="p">,</span> <span class="n">target_model</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="c1"># Prepare input data</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>

<span class="c1"># Define a custom comparison function</span>
<span class="k">def</span> <span class="nf">compare_outputs</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">reference_output</span><span class="p">,</span> <span class="n">target_output</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="c1"># Find failing operations</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">comparator</span><span class="o">.</span><span class="n">find_failing_ops</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">compare_outputs</span><span class="o">=</span><span class="n">compare_outputs</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">MLModelInspector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelInspector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector" title="Link to this definition"></a></dt>
<dd><p>A class for inspecting an ML model.</p>
<p>This class provides functionality to retrieve intermediate outputs of an ML model.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">coremltools_internal</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelInspector</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>
<span class="c1"># The intermediate outputs we want to inspect</span>
<span class="n">output_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;conv1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;relu1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;pool1_output&quot;</span><span class="p">]</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">output_value</span> <span class="ow">in</span> <span class="n">inspector</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">output_names</span>
<span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output: </span><span class="si">{</span><span class="n">output_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelInspector.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the MLModelInspector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">MLModel</span></dt><dd><p>The MLModel to inspect.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit</span></dt><dd><p>The compute units to use. Defaults to the model’s compute unit.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">Optional[str]</span></dt><dd><p>The function name. Defaults to the model’s function name.</p>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>Keys are the names of the optimization hint, either ‘reshapeFrequency’ or ‘specializationStrategy’.
Values are enumeration values of type <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.SpecializationStrategy</span></code>.</p>
</dd>
<dt><strong>device: Device</strong></dt><dd><p>The device on which the model will execute.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.clear_cached_models">
<span class="sig-name descname"><span class="pre">clear_cached_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelInspector.clear_cached_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.clear_cached_models" title="Link to this definition"></a></dt>
<dd><p>Clears the cache of generated models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.inspect">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_const_ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelInspector.inspect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.inspect" title="Link to this definition"></a></dt>
<dd><p>Retrieves intermediate outputs from the model for given inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Dict[str, np.array]</span></dt><dd><p>Input data for the model.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">List[str]</span></dt><dd><p>Names of outputs to retrieve. Defaults to all outputs.</p>
</dd>
<dt><strong>num_predict_intermediate_outputs</strong><span class="classifier">Optional[int]</span></dt><dd><p>The number of intermediate outputs to retrieve in each <code class="docutils literal notranslate"><span class="pre">MLModel</span></code> prediction call. Defaults to None.</p>
</dd>
<dt><strong>ignore_const_ops</strong><span class="classifier">bool</span></dt><dd><p>Whether to ignore constant operations. Defaults to True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>AsyncIterator[Tuple[str, Optional[np.array]]]</dt><dd><p>An iterator of tuples containing output names and their values.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Tuple[str, Optional[np.array]]</dt><dd><p>A tuple of (output_name, output_value) for each requested output.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelInspector</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>
<span class="c1"># The intermediate outputs we want to inspect</span>
<span class="n">output_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;conv1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;relu1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;pool1_output&quot;</span><span class="p">]</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">output_value</span> <span class="ow">in</span> <span class="n">inspector</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">output_names</span>
<span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output: </span><span class="si">{</span><span class="n">output_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.output_name_to_op_map">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_name_to_op_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OrderedDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.output_name_to_op_map" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary mapping output names to their corresponding operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Dict[str, proto.MIL_pb2.Operation]</dt><dd><p>A dictionary of output names to operations.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.output_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.output_names" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all output names in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>List[str]</dt><dd><p>A list of output names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.retrieve_outputs">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_const_ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelInspector.retrieve_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelInspector.retrieve_outputs" title="Link to this definition"></a></dt>
<dd><p>Asynchronously retrieve intermediate outputs for the specified output names and inputs.</p>
<p>This method inspects the model with given inputs and collects the intermediate outputs
for the specified output names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output_names</strong><span class="classifier">List[str]</span></dt><dd><p>Names of intermediate outputs to retrieve.</p>
</dd>
<dt><strong>inputs</strong><span class="classifier">Dict[str, np.ndarray])</span></dt><dd><p>Input data for the model.</p>
</dd>
<dt><strong>num_predict_intermediate_outputs</strong><span class="classifier">Optional[int]</span></dt><dd><p>The number of intermediate outputs to retrieve in each <code class="docutils literal notranslate"><span class="pre">MLModel</span></code> prediction call. Defaults to None.</p>
</dd>
<dt><strong>ignore_const_ops</strong><span class="classifier">bool</span></dt><dd><p>Whether to ignore constant operations. Defaults to True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dict[str, Optional[np.array]]</dt><dd><p>A dictionary mapping output names to their corresponding numpy array values.
If an output is not available, its value will be None.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelInspector</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>
<span class="c1"># The intermediate outputs we want to retrieve</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">inspector</span><span class="o">.</span><span class="n">retrieve_outputs</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;conv1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;relu1_output&quot;</span><span class="p">,</span> <span class="s2">&quot;pool1_output&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">output_value</span> <span class="ow">in</span> <span class="n">outputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output: </span><span class="si">{</span><span class="n">output_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">MLModelValidator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelValidator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator" title="Link to this definition"></a></dt>
<dd><p>A validator class for diagnosing numerical issues in an ML model.</p>
<p>This class provides methods to traverse and validate operations within an ML model,
specifically focusing on detecting issues such as NaN (Not a Number) or infinite outputs.
It uses a graph traversal approach to identify the source of numerical instabilities.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">validator</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelValidator</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">find_failing_ops</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])},</span>
    <span class="n">validate_output</span><span class="o">=</span><span class="k">lambda</span> <span class="n">op</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(),</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">,</span> <span class="s2">&quot;output2&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predict_intermediate_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelValidator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the MLModelValidator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">MLModel</span></dt><dd><p>The model to be validated.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">Optional[str]</span></dt><dd><p>The function name. Defaults to the model’s function name.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit:</span></dt><dd><p>The compute units to use. Defaults to the model’s compute unit.</p>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>Keys are the names of the optimization hint, either ‘reshapeFrequency’ or ‘specializationStrategy’.
Values are enumeration values of type <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.SpecializationStrategy</span></code>.</p>
</dd>
<dt><strong>num_predict_intermediate_outputs</strong><span class="classifier">int</span></dt><dd><p>The number of intermediate outputs to retrieve in each <code class="docutils literal notranslate"><span class="pre">MLModel</span></code> prediction call. Defaults to 20.</p>
</dd>
<dt><strong>device: Device</strong></dt><dd><p>The device on which the model will execute.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inputs:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~numpy.array],</span> <span class="pre">validate_output:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation,</span> <span class="pre">~numpy.array],</span> <span class="pre">bool],</span> <span class="pre">output_names:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">skip_op:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">skip_op_by_type&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelValidator.find_failing_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops" title="Link to this definition"></a></dt>
<dd><p>Identify operations in the model that fail the specified validation criteria.</p>
<p>This method traverses the model’s operation graph, starting from the specified
output operations, and applies the given validation function to each operation’s
output. It returns a list of operations that are likely the source of failures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Dict[str, np.array]</span></dt><dd><p>A dictionary of input tensors for the model. Keys are input names, and values are numpy arrays.</p>
</dd>
<dt><strong>validate_output</strong><span class="classifier">Callable[[proto.MIL_pb2.Operation, np.array], bool]</span></dt><dd><p>A function that takes an operation and its output array, and returns False if the output
fails the validation criteria, True otherwise.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">Optional[List[str]]</span></dt><dd><p>A list of specific output names to start the traversal from. If None, all model outputs are used.</p>
</dd>
<dt><strong>skip_op: Callable[[proto.MIL_pb2.Operation], bool]</strong></dt><dd><p>A function that determines if an operation should be skipped.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[proto.MIL_pb2.Operation]:</dt><dd><p>A list of operations that are identified as likely sources of failure based on the validation criteria.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method uses a breadth-first search strategy to traverse the operation graph.</p></li>
<li><p>An operation is considered a failure source if it fails validation, but its direct inputs pass.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">validator</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelValidator</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">validator</span><span class="o">.</span><span class="n">find_failing_ops</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])},</span>
    <span class="n">validate_output</span><span class="o">=</span><span class="k">lambda</span> <span class="n">op</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(),</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">,</span> <span class="s2">&quot;output2&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops_with_infinite_output">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_ops_with_infinite_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inputs:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~numpy.array],</span> <span class="pre">output_names:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">skip_op:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">skip_op_by_type&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelValidator.find_failing_ops_with_infinite_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops_with_infinite_output" title="Link to this definition"></a></dt>
<dd><p>Identify operations in the model that produce infinite outputs.</p>
<p>This method traverses the model’s operation graph and checks for infinite values
in the output of each operation. It returns a list of operations that are likely the
source of failures. It’s useful for debugging numerical instability issues in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">dict[str, np.array]</span></dt><dd><p>A dictionary of input tensors for the model. Keys are input names, and values are numpy arrays.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">Optional[List[str]]</span></dt><dd><p>A list of specific output names to start the traversal from. If None, all model outputs are used.</p>
</dd>
<dt><strong>skip_op: Callable[[proto.MIL_pb2.Operation], bool]</strong></dt><dd><p>A function that determines if an operation should be skipped.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[proto.MIL_pb2.Operation]</dt><dd><p>A list of operations that are identified as likely sources of failure.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method uses a breadth-first search strategy to traverse the operation graph.</p></li>
<li><p>An operation is considered a failure source if it outputs infinite values while its direct inputs do not.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">validator</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelValidator</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">validator</span><span class="o">.</span><span class="n">find_failing_ops_with_infinite_output</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])},</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">,</span> <span class="s2">&quot;output2&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops_with_nan_output">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_failing_ops_with_nan_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inputs:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~numpy.array],</span> <span class="pre">output_names:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">skip_op:</span> <span class="pre">~typing.Callable[[~MIL_pb2.Operation],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">skip_op_by_type&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#MLModelValidator.find_failing_ops_with_nan_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.MLModelValidator.find_failing_ops_with_nan_output" title="Link to this definition"></a></dt>
<dd><p>Identify operations in the model that produce NaN (Not a Number) outputs.</p>
<p>This method traverses the model’s operation graph and checks for NaN values
in the output of each operation. It returns a list of operations that are likely
the source of failures. It’s useful for debugging numerical instability issues in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Dict[str, np.array]</span></dt><dd><p>A dictionary of input tensors for the model. Keys are input names, and values are numpy arrays.</p>
</dd>
<dt><strong>output_names</strong><span class="classifier">Optional[List[str]]</span></dt><dd><p>A list of specific output names to start the traversal from. If None, all model outputs are used.</p>
</dd>
<dt><strong>skip_op: Callable[[proto.MIL_pb2.Operation], bool]</strong></dt><dd><p>A function that determines if an operation should be skipped.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[proto.MIL_pb2.Operation]</dt><dd><p>A list of operations that are identified as likely sources of failure.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method uses a breadth-first search strategy to traverse the operation graph.</p></li>
<li><p>An operation is considered a failure source if it outputs NaN while its direct inputs do not.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">validator</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">debugging_utils</span><span class="o">.</span><span class="n">MLModelValidator</span><span class="p">(</span>
    <span class="n">model</span>
<span class="p">)</span>
<span class="n">failing_ops</span> <span class="o">=</span> <span class="k">await</span> <span class="n">validator</span><span class="o">.</span><span class="n">find_failing_ops_with_nan_output</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])},</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">,</span> <span class="s2">&quot;output2&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.compute_snr_and_psnr">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">compute_snr_and_psnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#compute_snr_and_psnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.compute_snr_and_psnr" title="Link to this definition"></a></dt>
<dd><p>Compute the Signal-to-Noise Ratio (SNR) and Peak Signal-to-Noise Ratio (PSNR) between two signals.</p>
<p>This function calculates the SNR and PSNR between two input signals, typically used to compare
an original signal (y) with a processed or noisy version of that signal (x).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">np.array</span></dt><dd><p>The processed or noisy signal.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.array</span></dt><dd><p>The original or reference signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple[float, float]</dt><dd><dl class="simple">
<dt>A tuple containing two float values:</dt><dd><ul class="simple">
<li><p>snr (float): The Signal-to-Noise Ratio in decibels (dB).</p></li>
<li><p>psnr (float): The Peak Signal-to-Noise Ratio in decibels (dB).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>AssertionError: If the lengths of x and y are not equal.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">])</span>
<span class="n">snr</span><span class="p">,</span> <span class="n">psnr</span> <span class="o">=</span> <span class="n">compute_snr_and_psnr</span><span class="p">(</span><span class="n">noisy</span><span class="p">,</span> <span class="n">original</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SNR: </span><span class="si">{</span><span class="n">snr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> dB, PSNR: </span><span class="si">{</span><span class="n">psnr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> dB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.debugging_utils.skip_op_by_type">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.debugging_utils.</span></span><span class="sig-name descname"><span class="pre">skip_op_by_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Operation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'cast',</span> <span class="pre">'compression.constexpr_blockwise_shift_scale',</span> <span class="pre">'concat',</span> <span class="pre">'const',</span> <span class="pre">'constexpr_affine_dequantize',</span> <span class="pre">'constexpr_cast',</span> <span class="pre">'constexpr_lut_to_dense',</span> <span class="pre">'constexpr_lut_to_sparse',</span> <span class="pre">'constexpr_sparse_to_dense',</span> <span class="pre">'expand_dims',</span> <span class="pre">'fill',</span> <span class="pre">'reshape',</span> <span class="pre">'reshape_like',</span> <span class="pre">'shape',</span> <span class="pre">'slice_by_index',</span> <span class="pre">'slice_by_size',</span> <span class="pre">'split',</span> <span class="pre">'squeeze',</span> <span class="pre">'stack',</span> <span class="pre">'transpose'}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/debugging_utils.html#skip_op_by_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.debugging_utils.skip_op_by_type" title="Link to this definition"></a></dt>
<dd><p>Determines if an operation should be skipped based on its type.</p>
</dd></dl>

</section>
<section id="id2">
<h3>perf_utils<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<span class="target" id="module-coremltools.models.ml_program.experimental.perf_utils"></span><dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.perf_utils.</span></span><span class="sig-name descname"><span class="pre">MLModelBenchmarker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker" title="Link to this definition"></a></dt>
<dd><p>A class for benchmarking an MLModel.</p>
<p>This class provides functionality to measure and analyze the performance of an MLModel,
including loading time, prediction time, and individual operation execution times.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Measurement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'MLModelBenchmarker.Statistics'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.Measurement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OperationExecutionInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MIL_pb2.Operation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath"><span class="pre">coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_device_usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage" title="coremltools.models.compute_plan.MLComputePlanDeviceUsage"><span class="pre">coremltools.models.compute_plan.MLComputePlanDeviceUsage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'MLModelBenchmarker.Measurement'</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.OperationExecutionInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Statistics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_dev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.Statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Statistics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_load">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">benchmark_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement" title="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement"><span class="pre">Measurement</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.benchmark_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_load" title="Link to this definition"></a></dt>
<dd><p>Measures the loading time of the model.</p>
<p>This method creates and loads the model multiple times, measuring the duration
of each load operation. It then unloads the model and performs garbage collection
after each iteration to ensure consistent measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iterations: int</strong></dt><dd><p>The number of times to load the model. Defaults to 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelBenchmarker.Measurement</dt><dd><p>A Measurement object containing statistics and samples of the load durations in milliseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_operation_execution">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">benchmark_operation_execution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo" title="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.OperationExecutionInfo"><span class="pre">OperationExecutionInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.benchmark_operation_execution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_operation_execution" title="Link to this definition"></a></dt>
<dd><p>Measures the execution time of individual operations in the model.</p>
<p>This method loads the model, runs predictions, and retrieves the execution time
of each operation within the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>The input data for the model prediction. If None, random input data will be generated.</p>
</dd>
<dt><strong>iterations: int</strong></dt><dd><p>The number of prediction iterations to run. Defaults to 1.</p>
</dd>
<dt><strong>warmup: bool</strong></dt><dd><p>Whether to perform a warmup iteration. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List[OperationExecutionInfo]</dt><dd><p>A list of OperationExecutionInfo objects, each containing
details about an operation’s execution, sorted by execution time in descending order.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The returned list is sorted by execution time, with the most time-consuming operations first.</p></li>
<li><p>Execution times are estimated based on the overall prediction time and the model’s compute plan.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_predict">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">benchmark_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement" title="coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.Measurement"><span class="pre">Measurement</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/perf_utils.html#MLModelBenchmarker.benchmark_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.perf_utils.MLModelBenchmarker.benchmark_predict" title="Link to this definition"></a></dt>
<dd><p>Measures the prediction time of the model.</p>
<p>This method loads the model, then runs predictions multiple times, measuring
the duration of each prediction. It supports an optional warmup iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inputs</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>The input data for the model prediction. If None, random input data will be generated.</p>
</dd>
<dt><strong>iterations: int</strong></dt><dd><p>The number of prediction iterations to run. Defaults to 1.</p>
</dd>
<dt><strong>warmup: bool</strong></dt><dd><p>Whether to perform a warmup iteration. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelBenchmarker.Measurement</dt><dd><p>A Measurement object containing statistics and
samples of the prediction durations in milliseconds.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the number of iterations is less than 1.</p>
</dd>
<dt>Note:</dt><dd><p>This method is asynchronous and should be awaited when called.
The warmup iteration, if enabled, is not included in the returned measurements.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.ml_program.experimental.async_wrapper">
<span id="async-wrapper"></span><h3>async_wrapper<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.async_wrapper" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.async_wrapper.</span></span><span class="sig-name descname"><span class="pre">LocalMLModelAsyncWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_or_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#LocalMLModelAsyncWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper" title="Link to this definition"></a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.last_predict_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_predict_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.last_predict_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the last predict operation in nanoseconds.
This method returns the time taken for the most recent prediction made by
the model, measured in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.load">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#LocalMLModelAsyncWrapper.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.load" title="Link to this definition"></a></dt>
<dd><p>Asynchronously loads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.load_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.load_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the model loading process in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.predict">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#LocalMLModelAsyncWrapper.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.predict" title="Link to this definition"></a></dt>
<dd><p>Asynchronously performs predictions using the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.retrieve_compute_plan">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_compute_plan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#LocalMLModelAsyncWrapper.retrieve_compute_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.retrieve_compute_plan" title="Link to this definition"></a></dt>
<dd><p>Asynchronously retrieves the compute plan for the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.unload">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#LocalMLModelAsyncWrapper.unload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.LocalMLModelAsyncWrapper.unload" title="Link to this definition"></a></dt>
<dd><p>Asynchronously unloads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.async_wrapper.</span></span><span class="sig-name descname"><span class="pre">MLModelAsyncWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_or_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.from_spec_or_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_spec_or_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_or_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper" title="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper"><span class="pre">MLModelAsyncWrapper</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper.from_spec_or_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.from_spec_or_path" title="Link to this definition"></a></dt>
<dd><p>Creates an MLModelAsyncWrapper instance from a model specification or model path.</p>
<p>This static method constructs an <code class="docutils literal notranslate"><span class="pre">MLModelAsyncWrapper</span></code> object based on the provided
model specification and additional parameters.</p>
<p>If the device parameter is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the model is loaded on the local system. Otherwise, it
is loaded on the specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec_or_path</strong><span class="classifier">Union[“proto.Model_pb2.Model”, str]</span></dt><dd><p>Either a protobuf specification of the model (<code class="docutils literal notranslate"><span class="pre">proto.Model_pb2.Model</span></code>) or a string
representing the file path to the model (<code class="docutils literal notranslate"><span class="pre">mlpackage</span></code>).</p>
</dd>
<dt><strong>weights_dir: str</strong></dt><dd><p>The model weights directory.</p>
</dd>
<dt><strong>function_name</strong><span class="classifier">Optional[str]</span></dt><dd><p>The function name. Defaults to the model’s function name.</p>
</dd>
<dt><strong>compute_units</strong><span class="classifier">coremltools.ComputeUnit:</span></dt><dd><p>The compute units to use. Defaults to the model’s compute unit.</p>
</dd>
<dt><strong>optimization_hints</strong><span class="classifier">Optional[Dict[str, Any]]</span></dt><dd><p>Keys are the names of the optimization hint, either ‘reshapeFrequency’ or ‘specializationStrategy’.
Values are enumeration values of type <code class="docutils literal notranslate"><span class="pre">coremltools.ReshapeFrequency</span></code> or <code class="docutils literal notranslate"><span class="pre">coremltools.SpecializationStrategy</span></code>.</p>
</dd>
<dt><strong>device: Device</strong></dt><dd><p>The device on which the model will execute.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModelAsyncWrapper</dt><dd><p>An instance of MLModelAsyncWrapper.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.last_predict_duration_in_nano_seconds">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_predict_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.last_predict_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the last predict operation in nanoseconds.
This method returns the time taken for the most recent prediction made by
the model, measured in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.load">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.load" title="Link to this definition"></a></dt>
<dd><p>Asynchronously loads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.load_duration_in_nano_seconds">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.load_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the model loading process in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.predict" title="Link to this definition"></a></dt>
<dd><p>Asynchronously performs predictions using the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.retrieve_compute_plan">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_compute_plan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper.retrieve_compute_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.retrieve_compute_plan" title="Link to this definition"></a></dt>
<dd><p>Asynchronously retrieves the compute plan for the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.unload">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#MLModelAsyncWrapper.unload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.MLModelAsyncWrapper.unload" title="Link to this definition"></a></dt>
<dd><p>Asynchronously unloads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.async_wrapper.</span></span><span class="sig-name descname"><span class="pre">RemoteMLModelAsyncWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_or_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_hints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#RemoteMLModelAsyncWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper" title="Link to this definition"></a></dt>
<dd><p>A concrete implementation of the <code class="docutils literal notranslate"><span class="pre">MLModelAsyncWrapper</span></code> for a remote <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.last_predict_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_predict_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.last_predict_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the last predict operation in nanoseconds.
This method returns the time taken for the most recent prediction made by
the model, measured in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.load">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#RemoteMLModelAsyncWrapper.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.load" title="Link to this definition"></a></dt>
<dd><p>Asynchronously loads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.load_duration_in_nano_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_duration_in_nano_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.load_duration_in_nano_seconds" title="Link to this definition"></a></dt>
<dd><p>Retrieves the duration of the model loading process in nanoseconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.predict">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MLState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#RemoteMLModelAsyncWrapper.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.predict" title="Link to this definition"></a></dt>
<dd><p>Asynchronously performs predictions using the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.retrieve_compute_plan">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_compute_plan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#RemoteMLModelAsyncWrapper.retrieve_compute_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.retrieve_compute_plan" title="Link to this definition"></a></dt>
<dd><p>Asynchronously retrieves the compute plan for the loaded <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.unload">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/async_wrapper.html#RemoteMLModelAsyncWrapper.unload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.async_wrapper.RemoteMLModelAsyncWrapper.unload" title="Link to this definition"></a></dt>
<dd><p>Asynchronously unloads the <code class="docutils literal notranslate"><span class="pre">MLModel</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.ml_program.experimental.model_structure_path">
<span id="model-structure-path"></span><h3>model_structure_path<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.model_structure_path" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.model_structure_path.</span></span><span class="sig-name descname"><span class="pre">ModelStructurePath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program"><span class="pre">Program</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Function" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Function"><span class="pre">Function</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Block" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Block"><span class="pre">Block</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Operation" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Operation"><span class="pre">Operation</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork"><span class="pre">NeuralNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork.Layer" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork.Layer"><span class="pre">Layer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline"><span class="pre">Pipeline</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline.Model" title="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline.Model"><span class="pre">Model</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath" title="Link to this definition"></a></dt>
<dd><p>This class represents a hierarchical path within a model structure,
allowing for the representation of various components in a program,
neural network, or pipeline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NeuralNetwork</span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.NeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork" title="Link to this definition"></a></dt>
<dd><p>Represents a neural network in the model structure.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork.Layer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.NeuralNetwork.Layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.NeuralNetwork.Layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pipeline</span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline" title="Link to this definition"></a></dt>
<dd><p>Represents a pipeline in the model structure.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Pipeline.Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Pipeline.Model" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Program</span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Program"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program" title="Link to this definition"></a></dt>
<dd><p>Represents a program in the model structure.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Program.Block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Block" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Program.Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Function" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Operation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/model_structure_path.html#ModelStructurePath.Program.Operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.model_structure_path.ModelStructurePath.Program.Operation" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.ml_program.experimental.compute_plan_utils">
<span id="compute-plan-utils"></span><h3>compute_plan_utils<a class="headerlink" href="#module-coremltools.models.ml_program.experimental.compute_plan_utils" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.compute_plan_utils.apply_compute_plan">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.compute_plan_utils.</span></span><span class="sig-name descname"><span class="pre">apply_compute_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_plan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend_assignment_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlanDeviceUsage" title="coremltools.models.compute_plan.MLComputePlanDeviceUsage"><span class="pre">MLComputePlanDeviceUsage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/compute_plan_utils.html#apply_compute_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.compute_plan_utils.apply_compute_plan" title="Link to this definition"></a></dt>
<dd><p>This function takes an MLModel and sets the intended backend attribute
of each operation in the model as determined by the model’s compute plan.</p>
<p>It updates the ‘IntendedBackend’ attribute of each operation,
ensuring the same dispatch even if the model is modified.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.compute_plan_utils.load_compute_plan_from_path_on_device">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.compute_plan_utils.</span></span><span class="sig-name descname"><span class="pre">load_compute_plan_from_path_on_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ComputeUnit</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ComputeUnit.ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.ml_program.experimental.remote_device.Device" title="coremltools.models.ml_program.experimental.remote_device.Device"><span class="pre">Device</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.compute_plan.MLComputePlan" title="coremltools.models.compute_plan.MLComputePlan"><span class="pre">MLComputePlan</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/compute_plan_utils.html#load_compute_plan_from_path_on_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.compute_plan_utils.load_compute_plan_from_path_on_device" title="Link to this definition"></a></dt>
<dd><p>Loads the compute plan of a compiled model on a remote or local device.</p>
<p>The path must be the location of the <code class="docutils literal notranslate"><span class="pre">mlmodelc</span></code> directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the compiled model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>The plan for executing the model.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve a development device.</span>
<span class="n">devices</span> <span class="o">=</span> <span class="n">Device</span><span class="o">.</span><span class="n">get_connected_development_devices</span><span class="p">(</span><span class="n">device_type</span><span class="o">=</span><span class="n">DeviceType</span><span class="o">.</span><span class="n">IPHONE</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Prepare device for model debugging.</span>
<span class="n">device</span> <span class="o">=</span> <span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">prepare_for_model_debugging</span><span class="p">()</span>
<span class="n">compute_plan</span> <span class="o">=</span> <span class="k">await</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ml_program</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">compute_plan_utils</span><span class="o">.</span><span class="n">load_compute_plan_from_path_on_device</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">get_compiled_path</span><span class="p">(),</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected model type.&quot;</span><span class="p">)</span>

<span class="n">program</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">model_structure</span><span class="o">.</span><span class="n">program</span>
<span class="n">mainFunction</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">mainFunction</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
    <span class="c1"># Get the compute device usage for the operation.</span>
    <span class="n">compute_device_usage</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_compute_device_usage_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Get the estimated cost of executing the operation.</span>
    <span class="n">estimated_cost</span> <span class="o">=</span> <span class="n">compute_plan</span><span class="o">.</span><span class="n">get_estimated_cost_for_mlprogram_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.ml_program.experimental.compute_plan_utils.set_intended_backends">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.ml_program.experimental.compute_plan_utils.</span></span><span class="sig-name descname"><span class="pre">set_intended_backends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend_assignment_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Operation</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#coremltools.models.model.MLModel" title="coremltools.models.model.MLModel"><span class="pre">MLModel</span></a></span></span><a class="reference internal" href="../_modules/coremltools/models/ml_program/experimental/compute_plan_utils.html#set_intended_backends"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.ml_program.experimental.compute_plan_utils.set_intended_backends" title="Link to this definition"></a></dt>
<dd><p>Assigns intended backends to operations in the given model.</p>
<p>This function creates a new MLModel with updated backend assignments for each operation.
It traverses the entire model structure, applying the provided backend assignment function
to determine the intended backends for each operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">MLModel</span></dt><dd><p>The input model to be processed.</p>
</dd>
<dt><strong>backend_assignment_fn</strong><span class="classifier">Callable[[proto.MIL_pb2.Operation], Optional[List[str]]]</span></dt><dd><p>A function that takes an operation and returns a list of intended backend names.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MLModel</dt><dd><p>A new model instance with updated backend assignments.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coremltools.converters.xgboost.html" class="btn btn-neutral float-left" title="XGBoost" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coremltools.models.ml_program.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Apple Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>