<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>neural_network.builder &mdash; coremltools API Reference  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/norightmargin.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MIL Builder" href="coremltools.converters.mil.html" />
    <link rel="prev" title="affine_quantize_weights" href="coremltools.models.ml_program.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> coremltools API Reference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.html">Converters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="coremltools.models.html">Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.model">MLModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#compression-utils">compression_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.array_feature_extractor">array_feature_extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.feature_vectorizer">feature_vectorizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.nearest_neighbors.builder">nearest_neighbors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="coremltools.models.html#neural-network">neural_network</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">neural_network.builder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder"><code class="docutils literal notranslate"><span class="pre">NeuralNetworkBuilder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.neural_network.flexible_shape_utils">neural_network.flexible_shape_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSize"><code class="docutils literal notranslate"><span class="pre">NeuralNetworkImageSize</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSizeRange"><code class="docutils literal notranslate"><span class="pre">NeuralNetworkImageSizeRange</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShape"><code class="docutils literal notranslate"><span class="pre">NeuralNetworkMultiArrayShape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange"><code class="docutils literal notranslate"><span class="pre">NeuralNetworkMultiArrayShapeRange</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_image_sizes"><code class="docutils literal notranslate"><span class="pre">add_enumerated_image_sizes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_multiarray_shapes"><code class="docutils literal notranslate"><span class="pre">add_enumerated_multiarray_shapes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.add_multiarray_ndshape_enumeration"><code class="docutils literal notranslate"><span class="pre">add_multiarray_ndshape_enumeration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.set_multiarray_ndshape_range"><code class="docutils literal notranslate"><span class="pre">set_multiarray_ndshape_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.update_image_size_range"><code class="docutils literal notranslate"><span class="pre">update_image_size_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.flexible_shape_utils.update_multiarray_shape_range"><code class="docutils literal notranslate"><span class="pre">update_multiarray_shape_range()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.neural_network.quantization_utils">neural_network.quantization_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector"><code class="docutils literal notranslate"><span class="pre">AdvancedQuantizedLayerSelector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector"><code class="docutils literal notranslate"><span class="pre">MatrixMultiplyLayerSelector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.ModelMetrics"><code class="docutils literal notranslate"><span class="pre">ModelMetrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.OutputMetric"><code class="docutils literal notranslate"><span class="pre">OutputMetric</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.QuantizedLayerSelector"><code class="docutils literal notranslate"><span class="pre">QuantizedLayerSelector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.activate_int8_int8_matrix_multiplications"><code class="docutils literal notranslate"><span class="pre">activate_int8_int8_matrix_multiplications()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.compare_models"><code class="docutils literal notranslate"><span class="pre">compare_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.quantization_utils.quantize_weights"><code class="docutils literal notranslate"><span class="pre">quantize_weights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-coremltools.models.neural_network.update_optimizer_utils">neural_network.update_optimizer_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.update_optimizer_utils.AdamParams"><code class="docutils literal notranslate"><span class="pre">AdamParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.update_optimizer_utils.Batch"><code class="docutils literal notranslate"><span class="pre">Batch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.update_optimizer_utils.RangeParam"><code class="docutils literal notranslate"><span class="pre">RangeParam</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#coremltools.models.neural_network.update_optimizer_utils.SgdParams"><code class="docutils literal notranslate"><span class="pre">SgdParams</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.pipeline">pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.tree_ensemble">tree_ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="coremltools.models.html#module-coremltools.models.utils">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.html">MIL Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.input_types.html">MIL Input Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="coremltools.converters.mil.mil.ops.defs.html">MIL Ops</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coremltools.readme.io/docs">Guides and examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apple.github.io/coremltools/mlmodel/index.html">Core ML Format Specification</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apple/coremltools">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coremltools API Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="coremltools.models.html">Models</a> &raquo;</li>
      <li>neural_network.builder</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/coremltools.models.neural_network.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-coremltools.models.neural_network.builder">
<span id="neural-network-builder"></span><h1>neural_network.builder<a class="headerlink" href="#module-coremltools.models.neural_network.builder" title="Permalink to this heading"></a></h1>
<p>Neural network builder class to construct Core ML models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.builder.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_rank5_shape_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_float_arraytype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder" title="Permalink to this definition"></a></dt>
<dd><p>Neural network builder class to construct Core ML models.</p>
<p>The NeuralNetworkBuilder constructs a Core ML neural network specification
layer by layer. The layers should be added in such an order that the inputs
to each layer (referred to as blobs of each layer) have been previously
defined. The builder can also set preprocessing steps to handle
specialized input formats (such as images), and set class labels for neural
network classifiers.</p>
<p>Refer to the protobuf messages in the specification (NeuralNetwork.proto)
for more details.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">datatypes</span><span class="p">,</span> <span class="n">NeuralNetworkBuilder</span>
<span class="kn">from</span> <span class="nn">coremltools.models.utils</span> <span class="kn">import</span> <span class="n">save_spec</span>

<span class="c1"># Create a neural network binary classifier that classifies</span>
<span class="c1"># 3-dimensional data points</span>
<span class="c1"># Specify input and output dimensions</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>

<span class="c1"># Specify input and output features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">input_dim</span><span class="p">))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="o">*</span><span class="n">output_dim</span><span class="p">))]</span>

<span class="c1"># Build a simple neural network with 1 inner product layer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_inner_product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ip_layer&#39;</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">input_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;probs&#39;</span><span class="p">)</span>

<span class="c1"># save the spec by the builder</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">save_spec</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;network.mlmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_rank5_shape_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_float_arraytype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct a NeuralNetworkBuilder object to build an MLModel specification with a
model interface, or a NeuralNetwork protobuf message, either from scratch or using an
existing specification.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>input_features: [(str, datatypes.Array)] or None</strong></dt><dd><p>List of input feature of the network.
Each feature is a <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">array)</span></code> tuple, where <code class="docutils literal notranslate"><span class="pre">name</span></code> is the
name of the feature, and <code class="docutils literal notranslate"><span class="pre">array</span></code> is a <code class="docutils literal notranslate"><span class="pre">datatype.Array</span></code> object
describing the feature type.</p>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">spec</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> (building from scratch), <code class="docutils literal notranslate"><span class="pre">input_features</span></code> must not be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt><strong>output_features: [(str, datatypes.Array or None)] or None</strong></dt><dd><p>List of output feature of the network. Each feature is a
<code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">array)</span></code> tuple, where <code class="docutils literal notranslate"><span class="pre">name</span></code> is the name of the feature,
and <code class="docutils literal notranslate"><span class="pre">array</span></code> is a <code class="docutils literal notranslate"><span class="pre">datatypes.Array</span></code> object describing the feature type.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">array</span></code> can be <code class="docutils literal notranslate"><span class="pre">None</span></code> if not known.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">spec</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> (building from scratch), <code class="docutils literal notranslate"><span class="pre">output_features</span></code> must not be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt><strong>mode: str (‘classifier’, ‘regressor’ or None)</strong></dt><dd><p>Mode (one of <code class="docutils literal notranslate"><span class="pre">'classifier'</span></code>, <code class="docutils literal notranslate"><span class="pre">'regressor'</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<p>When <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span> <span class="pre">'classifier'</span></code>, a NeuralNetworkClassifier spec will be
constructed.  When <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span> <span class="pre">'regressor'</span></code>, a NeuralNetworkRegressor
spec will be constructed.</p>
</dd>
<dt><strong>disable_rank5_shape_mapping: bool</strong></dt><dd><p>Only applicable for neural networks.</p>
<p>If True, inputs are no longer forced to map to rank 5 tensors
(rank is equal to the length of the shape of the tensor).
Instead, for multi-array inputs <code class="docutils literal notranslate"><span class="pre">&quot;EXACT_ARRAY_MAPPING&quot;</span></code> mapping is used, whereas
for image inputs <code class="docutils literal notranslate"><span class="pre">&quot;RANK4_IMAGE_MAPPING&quot;</span></code> is used. For details,
see description of enums <code class="docutils literal notranslate"><span class="pre">NeuralNetworkMultiArrayShapeMapping</span></code>
and <code class="docutils literal notranslate"><span class="pre">NeuralNetworkImageShapeMapping</span></code> in NeuralNetwork.proto.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">spec</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, this argument will be ignored.</p>
</dd>
<dt><strong>spec: None or coremltools.proto.Model_pb2</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a new MLModel spec will be created by the builder with
input and output features.</p>
<p>Otherwise, the builder will continue to build on <code class="docutils literal notranslate"><span class="pre">spec</span></code>.
This is useful when the MLModel is built incrementally.</p>
</dd>
<dt><strong>nn_spec: None or coremltools.proto.NeuralNetwork_pb2</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a new, empty NeuralNetwork proto will be created for spec.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nn_spec</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">spec</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the builder will
build a NeuralNetwork spec without wrapping it within an MLModel.
This is useful to create nested NeuralNetworks for models
with control flow operations.</p>
</dd>
<dt><strong>use_float_arraytype: bool</strong></dt><dd><p>If true, the datatype of input/output multiarrays is set to Float32 instead
of double.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct a builder that builds a neural network classifier with a 299 x 299 x 3</span>
<span class="c1"># dimensional input and 1000 dimensional output</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">input_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">299</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">output_features</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;probs&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">1000</span><span class="p">,)))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">NeuralNetworkBuilder</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;classifier&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos">
<span class="sig-name descname"><span class="pre">add_acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_acos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="Permalink to this definition"></a></dt>
<dd><p>Add an acos layer to the model that computes element-wise arc-cosine
for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AcosLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh">
<span class="sig-name descname"><span class="pre">add_acosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_acosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="Permalink to this definition"></a></dt>
<dd><p>Add an acosh layer to the model that computes element-wise inverse
hyperbolic cosine for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AcoshLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation">
<span class="sig-name descname"><span class="pre">add_activation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_linearity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_activation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="Permalink to this definition"></a></dt>
<dd><p>Add an activation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>non_linearity: str</strong></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> (activation) function of this layer.
It can be one of the following:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>: Rectified Linear Unit (ReLU) function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>: sigmoid function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>: tanh function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>: scaled tanh function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">tanh(beta</span> <span class="pre">*</span> <span class="pre">x)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> are constant scalars.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SOFTPLUS'</span></code>: softplus function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SOFTSIGN'</span></code>: softsign function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>: hard sigmoid function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">min(max(alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta,</span> <span class="pre">-1),</span> <span class="pre">1)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> are constant scalars.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LEAKYRELU'</span></code>: leaky relu function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is a constant scalar.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'PRELU'</span></code>: Parametric ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is a multi-dimensional array of same size as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ELU'</span></code>: Exponential linear unit function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">0)</span> <span class="pre">*</span> <span class="pre">(alpha</span> <span class="pre">*</span> <span class="pre">exp(x)</span> <span class="pre">-</span> <span class="pre">1)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is a constant scalar.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'PARAMETRICSOFTPLUS'</span></code>: Parametric softplus function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">log(1</span> <span class="pre">+</span> <span class="pre">exp(beta</span> <span class="pre">*</span> <span class="pre">x))</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> are two multi-dimensional arrays
of same size as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'THRESHOLDEDRELU'</span></code>: Thresholded ReLU function, defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">&gt;=</span> <span class="pre">alpha)</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is a constant scalar.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>: linear function.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>params: list of float or numpy.array</strong></dt><dd><p>Parameters for the activation, depending on non_linearity.</p>
<blockquote>
<div><ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> is one of [<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SOFTPLUS'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SOFTSIGN'</span></code>],
params is ignored.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> is one of [<code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>],
param is a list of 2 floats <code class="docutils literal notranslate"><span class="pre">[alpha,</span> <span class="pre">beta]</span></code>.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> is one of [<code class="docutils literal notranslate"><span class="pre">'LEAKYRELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'THRESHOLDEDRELU'</span></code>],
param is a list of 1 float <code class="docutils literal notranslate"><span class="pre">[alpha]</span></code>.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> is <code class="docutils literal notranslate"><span class="pre">'PRELU'</span></code>, param is a list of 1 numpy array <code class="docutils literal notranslate"><span class="pre">[alpha]</span></code>.
The shape of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is <code class="docutils literal notranslate"><span class="pre">(C,)</span></code>, where <code class="docutils literal notranslate"><span class="pre">C</span></code> is either the number of input channels or
1. When <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">=</span> <span class="pre">1</span></code>, same <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is applied to all channels.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">non_linearity</span></code> is <code class="docutils literal notranslate"><span class="pre">'PARAMETRICSOFTPLUS'</span></code>, param is a
list of 2 numpy arrays <code class="docutils literal notranslate"><span class="pre">[alpha,</span> <span class="pre">beta]</span></code>. The shape of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and
<cite>beta</cite> is <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">)</span></code>, where <code class="docutils literal notranslate"><span class="pre">C</span></code> is either
the number of input channels or 1. When <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">=</span> <span class="pre">1</span></code>, same <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and
<code class="docutils literal notranslate"><span class="pre">beta</span></code> are applied to all channels.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_softmax</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable">
<span class="sig-name descname"><span class="pre">add_add_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_add_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_add_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add an add_broadcastable layer to the model that performs element-wise
addition operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">AddBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax">
<span class="sig-name descname"><span class="pre">add_argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_argmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="Permalink to this definition"></a></dt>
<dd><p>Add an argmax layer to the model that returns the indices of the maximum
value along a specified axis in the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ArgMaxLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which the argmax is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmin</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin">
<span class="sig-name descname"><span class="pre">add_argmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_argmin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmin" title="Permalink to this definition"></a></dt>
<dd><p>Add an argmin layer to the model that returns the indices of the minimum
value along a specified axis in the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ArgMinLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which the argmin is computed. Negative indexing is supported.</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>if true, output rank is same as input rank, default: true.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argmax</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argsort">
<span class="sig-name descname"><span class="pre">add_argsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_argsort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_argsort" title="Permalink to this definition"></a></dt>
<dd><p>Add an argsort layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">ArgsortLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>axis along which to compute the sorting indices</p>
</dd>
<dt><strong>descending: bool, optional</strong></dt><dd><p>order of sorting</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_topk</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin">
<span class="sig-name descname"><span class="pre">add_asin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_asin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="Permalink to this definition"></a></dt>
<dd><p>Add an asin layer to the model that computes element-wise arc-sine for
the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AsinLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh">
<span class="sig-name descname"><span class="pre">add_asinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_asinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="Permalink to this definition"></a></dt>
<dd><p>Add an asinh layer to the model that computes element-wise inverse
hyperbolic sine for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AsinhLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan">
<span class="sig-name descname"><span class="pre">add_atan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_atan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="Permalink to this definition"></a></dt>
<dd><p>Add an atan layer to the model that computes element-wise arc-tangent
for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AtanLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh">
<span class="sig-name descname"><span class="pre">add_atanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_atanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="Permalink to this definition"></a></dt>
<dd><p>Add an atanh layer to the model that computes element-wise inverse
hyperbolic tangent for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">AtanhLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul">
<span class="sig-name descname"><span class="pre">add_batched_mat_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_8_dynamic_quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_batched_mat_mul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul" title="Permalink to this definition"></a></dt>
<dd><p>Add a N-D Batched Matrix Multiplication layer with NumPy-like broadcasting.
Refer to the <code class="docutils literal notranslate"><span class="pre">BatchedMatMulLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>transpose_a: bool, optional</strong></dt><dd><p>Whether or not to transpose A, default: false.</p>
</dd>
<dt><strong>transpose_b: bool, optional</strong></dt><dd><p>Whether or not to transpose B, default: false.</p>
</dd>
<dt><strong>weight_matrix_rows: int, optional</strong></dt><dd><p>Must be equal to the last dimension of the input, default: 0.</p>
</dd>
<dt><strong>weight_matrix_columns: int, optional</strong></dt><dd><p>Must be equal to the last dimension of the output, default: 0.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes(), optional</strong></dt><dd><p>Weight matrix of shape <code class="docutils literal notranslate"><span class="pre">(weight_matrix_rows,</span> <span class="pre">weight_matrix_columns)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code> (quantized to 1-8 bits), other
quantization-related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>bias: float32 numpy.array, optional</strong></dt><dd><p>Bias vector of shape (weight_matrix_columns,).</p>
</dd>
<dt><strong>Quantization</strong></dt><dd><p>Quantization arguments, used when <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>:</p>
<blockquote>
<div><dl class="simple">
<dt>is_quantized_weight: bool, optional</dt><dd><p>Set it to true when <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>, representing
quantized weights, default: false.</p>
</dd>
<dt>quantization_type: str, optional</dt><dd><p>When weights are quantized (that is, <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>),
this should be either <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lut&quot;</span></code>, default: <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>.</p>
</dd>
<dt>nbits: int, optional</dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value, default: 8.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32), optional</dt><dd><p>Scale vector to be used with linear quantization.
Must be of length either 1 or <code class="docutils literal notranslate"><span class="pre">weight_matrix_columns</span></code>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32), optional</dt><dd><p>Bias vector to be used with linear quantization.
Must be of length either 1 or <code class="docutils literal notranslate"><span class="pre">weight_matrix_columns</span></code>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32), optional</dt><dd><p>The LUT (look up table) to be used with LUT quantization.
Must be of length 2^n bits, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>int_8_dynamic_quantize: bool</dt><dd><p>Whether to quantize and dequantize before and after
batched matmul, respectively.
Expects byte weights, representing int8 values, if True.
See NeuralNetwork.proto for other validation conditions.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm">
<span class="sig-name descname"><span class="pre">add_batchnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_mean_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance_normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_batchnorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="Permalink to this definition"></a></dt>
<dd><p>Add a batch normalization layer. Batch normalization operation is
defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">gamma</span> <span class="pre">*</span> <span class="pre">(x</span> <span class="pre">-</span> <span class="pre">mean)</span> <span class="pre">/</span> <span class="pre">sqrt(variance</span> <span class="pre">+</span> <span class="pre">epsilon)</span> <span class="pre">+</span> <span class="pre">beta</span></code></p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">BatchnormLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>channels: int</strong></dt><dd><p>Number of channels of the input blob.</p>
</dd>
<dt><strong>gamma: numpy.array</strong></dt><dd><p>Values of gamma. Must be numpy array of shape <code class="docutils literal notranslate"><span class="pre">(channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>beta: numpy.array</strong></dt><dd><p>Values of beta. Must be numpy array of shape <code class="docutils literal notranslate"><span class="pre">(channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>mean: numpy.array</strong></dt><dd><p>Means of the input blob on each channel. Must be numpy array of shape <code class="docutils literal notranslate"><span class="pre">(channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>variance:</strong></dt><dd><p>Variances of the input blob on each channel. Must be numpy array of shape <code class="docutils literal notranslate"><span class="pre">(channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>compute_mean_var: bool</strong></dt><dd><p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if mean and variance is to be computed from the input data.</p>
</dd>
<dt><strong>instance_normalization: bool</strong></dt><dd><p>Set compute_mean_var and this to <code class="docutils literal notranslate"><span class="pre">True</span></code> to perform
instance normalization. That is, mean and variance are computed
from the single input instance.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>Value of epsilon. Defaults to <code class="docutils literal notranslate"><span class="pre">1e-5</span></code> if not specified.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias">
<span class="sig-name descname"><span class="pre">add_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="Permalink to this definition"></a></dt>
<dd><p>Add a bias layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">BiasLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt><dd><p>Bias to add to the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt><dd><p>List of ints that specifies the shape of the bias parameter
(if present). Can be <code class="docutils literal notranslate"><span class="pre">[1]</span></code>, <code class="docutils literal notranslate"><span class="pre">[C]</span></code>, <code class="docutils literal notranslate"><span class="pre">[1,H,W]</span></code>, or <code class="docutils literal notranslate"><span class="pre">[C,H,W]</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scale</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm">
<span class="sig-name descname"><span class="pre">add_bidirlstm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_state_update_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_input_forget_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_bidirlstm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="Permalink to this definition"></a></dt>
<dd><p>Add a Bi-directional LSTM layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">BiDirectionalLSTMLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices for the forward layer.
The ordering is <code class="docutils literal notranslate"><span class="pre">[R_i,</span> <span class="pre">R_f,</span> <span class="pre">R_o,</span> <span class="pre">R_z]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">R_i</span></code>, <code class="docutils literal notranslate"><span class="pre">R_f</span></code>, <code class="docutils literal notranslate"><span class="pre">R_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">R_z</span></code> are weight matrices at
input gate, forget gate, output gate and cell gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">hidden_size)</span></code>.</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices for the forward layer. The ordering
is <code class="docutils literal notranslate"><span class="pre">[W_i,</span> <span class="pre">W_f,</span> <span class="pre">W_o,</span> <span class="pre">W_z]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">W_i</span></code>, <code class="docutils literal notranslate"><span class="pre">W_f</span></code>, <code class="docutils literal notranslate"><span class="pre">W_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">W_z</span></code> are weight matrices at
input gate, forget gate, output gate and cell gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">input_size)</span></code>.</p>
</dd>
<dt><strong>b: [numpy.array]</strong></dt><dd><p>List of biases for the forward layer. The ordering is
<code class="docutils literal notranslate"><span class="pre">[b_i,</span> <span class="pre">b_f,</span> <span class="pre">b_o,</span> <span class="pre">b_z]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">b_i</span></code>, <code class="docutils literal notranslate"><span class="pre">b_f</span></code>, <code class="docutils literal notranslate"><span class="pre">b_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">b_z</span></code> are biases at input
gate, forget gate, output gate and cell gate.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, biases are ignored. Otherwise the shapes of the biases
are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>W_h_back: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices for the backward layer. The
ordering is <code class="docutils literal notranslate"><span class="pre">[R_i,</span> <span class="pre">R_f,</span> <span class="pre">R_o,</span> <span class="pre">R_z]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">R_i</span></code>, <code class="docutils literal notranslate"><span class="pre">R_f</span></code>, <code class="docutils literal notranslate"><span class="pre">R_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">R_z</span></code> are weight matrices
at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">hidden_size)</span></code>.</p>
</dd>
<dt><strong>W_x_back: [numpy.array]</strong></dt><dd><p>List of input weight matrices for the backward layer. The ordering
is <cite>[W_i, W_f, W_o, W_z]`</cite>,
where <code class="docutils literal notranslate"><span class="pre">W_i</span></code>, <code class="docutils literal notranslate"><span class="pre">W_f</span></code>, <code class="docutils literal notranslate"><span class="pre">W_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">W_z</span></code> are weight matrices
at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">input_size)</span></code>.</p>
</dd>
<dt><strong>b_back: [numpy.array]</strong></dt><dd><p>List of biases for the backward layer. The ordering is <code class="docutils literal notranslate"><span class="pre">[b_i,</span> <span class="pre">b_f,</span> <span class="pre">b_o,</span> <span class="pre">b_z]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">b_i</span></code>, <code class="docutils literal notranslate"><span class="pre">b_f</span></code>, <code class="docutils literal notranslate"><span class="pre">b_o</span></code>, and <code class="docutils literal notranslate"><span class="pre">b_z</span></code> are biases at input
gate, forget gate, output gate and cell gate.
The shapes of the biases <code class="docutils literal notranslate"><span class="pre">(hidden_size)</span></code>.</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer, in the order of
<code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">h_input,</span> <span class="pre">c_input,</span> <span class="pre">h_reverse_input,</span> <span class="pre">c_reverse_input]</span></code>.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer, in the order of
<code class="docutils literal notranslate"><span class="pre">[y,</span> <span class="pre">h_output,</span> <span class="pre">c_output,</span> <span class="pre">h_reverse_output,</span> <span class="pre">c_reverse_output]</span></code>.</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at input and forget gate. Can be one
of the following options:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
Defaults to <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>.</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt><dd><p>Cell state update activation function used at the cell state update gate.
Can be one of the following options:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
Defaults to <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>.</p>
</dd>
<dt><strong>output_activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following options:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
Defaults to <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>.</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors for the forward layer. The ordering
is <code class="docutils literal notranslate"><span class="pre">[p_i,</span> <span class="pre">p_f,</span> <span class="pre">p_o]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">p_i</span></code>, <code class="docutils literal notranslate"><span class="pre">p_f</span></code>, and <code class="docutils literal notranslate"><span class="pre">p_o</span></code> are peephole vectors at input
gate, forget gate, and output gate.
The shapes of the peephole vectors are <code class="docutils literal notranslate"><span class="pre">(hidden_size,)</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>peep_back: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors for the backward layer. The ordering
is <code class="docutils literal notranslate"><span class="pre">[p_i,</span> <span class="pre">p_f,</span> <span class="pre">p_o]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">p_i</span></code>, <code class="docutils literal notranslate"><span class="pre">p_f</span></code>, and <code class="docutils literal notranslate"><span class="pre">p_o</span></code> are peephole vectors at input
gate, forget gate, and output gate.
The shapes of the peephole vectors are <code class="docutils literal notranslate"><span class="pre">(hidden_size,)</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the LSTM layer should output at every time step. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the output is the result after the final state update.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a vector of 1s is added to forget gate bias. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the input gate and forget gate is coupled. That is, the
forget gate is not used.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt><dd><p>The limit on the maximum and minimum values on the cell state.
Defaults to 50.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch">
<span class="sig-name descname"><span class="pre">add_branch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">else_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_branch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="Permalink to this definition"></a></dt>
<dd><p>Add a branch layer to the model that provides the functionality of
branching or an <code class="docutils literal notranslate"><span class="pre">if-else</span></code> block.
Refer to the <code class="docutils literal notranslate"><span class="pre">BranchLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>if_branch: NeuralNetwork</strong></dt><dd><p>Neural network to execute if the absolute value of the input tensor is greater than 1e-6.</p>
</dd>
<dt><strong>else_branch: NeuralNetwork, optional</strong></dt><dd><p>Neural network to execute if the absolute value of the input tensor is less than 1e-6.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic">
<span class="sig-name descname"><span class="pre">add_broadcast_to_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_broadcast_to_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a broadcast_to_dynamic layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <code class="docutils literal notranslate"><span class="pre">BroadcastToDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like">
<span class="sig-name descname"><span class="pre">add_broadcast_to_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_broadcast_to_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a broadcast_to_like layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <code class="docutils literal notranslate"><span class="pre">BroadcastToLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static">
<span class="sig-name descname"><span class="pre">add_broadcast_to_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_broadcast_to_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a broadcast_to_static layer to the model that broadcasts a tensor
to a compatible shape.
Refer to the <code class="docutils literal notranslate"><span class="pre">BroadcastToStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>The target shape of the output tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_broadcast_to_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_broadcast_to_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution">
<span class="sig-name descname"><span class="pre">add_categorical_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_categorical_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_categorical_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Add a categorical_distribution layer to the model that fills the output
tensor with random values from categorical distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">CategoricalDistributionLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>num_samples: int</strong></dt><dd><p>List of dimensions for the reduce operations.</p>
</dd>
<dt><strong>is_logits: bool, optional</strong></dt><dd><p>If true, the input is log probabilities. If false, the input is
probabilities, default: True</p>
</dd>
<dt><strong>eps: float, optional</strong></dt><dd><p>Epsilon parameter for categorical distribution, default 1e-10.</p>
</dd>
<dt><strong>temperature: float, optional</strong></dt><dd><p>Temperature parameter for categorical distribution, default 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil">
<span class="sig-name descname"><span class="pre">add_ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_ceil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="Permalink to this definition"></a></dt>
<dd><p>Add a ceil layer to the model that performs element-wise ceil operation
on the input tensor that rounds the value to the smallest integer not
less than x.
Refer to the <code class="docutils literal notranslate"><span class="pre">CeilLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clamped_relu">
<span class="sig-name descname"><span class="pre">add_clamped_relu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_clamped_relu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clamped_relu" title="Permalink to this definition"></a></dt>
<dd><p>Add a clamped relu layer to the model.
Clamped relu formula is f(x) = min((x &gt;= 0 ? x : alpha * x), beta)
Refer to the <code class="docutils literal notranslate"><span class="pre">ClampedReluLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>slope of the output when input is negative, default: 0.0.</p>
</dd>
<dt><strong>beta: float, optional</strong></dt><dd><p>Upper bound on the output value, default: 6.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip">
<span class="sig-name descname"><span class="pre">add_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="Permalink to this definition"></a></dt>
<dd><p>Add a clip layer to the model that performs element-wise clip operation.
Clip the values in the input tensor to the range [min_value, max_value].
Refer to the <code class="docutils literal notranslate"><span class="pre">ClipLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>min_value: float, optional</strong></dt><dd><p>Lower bound / minimum value for clip, default: 0.0.</p>
</dd>
<dt><strong>max_value: float, optional</strong></dt><dd><p>Upper bound / maximum value for clip, default: 1.0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_floor</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd">
<span class="sig-name descname"><span class="pre">add_concat_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_concat_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a concat_nd layer to the model that performs concatenation along the
given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">ConcatNDLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the concat operation on.</p>
</dd>
<dt><strong>interleave</strong><span class="classifier">bool</span></dt><dd><p>(Only available in Core ML Specification &gt;= 5 (iOS &gt;= 14, macOS &gt;= 11.0)
If true, concatenate by interleaving the inputs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad">
<span class="sig-name descname"><span class="pre">add_constant_pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_to_given_output_size_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_amounts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_constant_pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="Permalink to this definition"></a></dt>
<dd><p>Add a constant pad layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">ConstantPaddingLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float</strong></dt><dd><p>value to be used for padding.</p>
</dd>
<dt><strong>pad_to_given_output_size_mode: bool</strong></dt><dd><p>if true, pad_amounts are interpreted as output shapes (see example in NeuralNetwork.proto)</p>
</dd>
<dt><strong>pad_amounts: [int], optional</strong></dt><dd><p>must be non negative. Amount to pad in each dimension. Length of the list must be twice the input/output rank.
Not required if second input is present.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution">
<span class="sig-name descname"><span class="pre">add_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_deconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_padding_asymmetry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="Permalink to this definition"></a></dt>
<dd><p>Add a convolution layer to the network.
Refer to the <code class="docutils literal notranslate"><span class="pre">ConvolutionLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>kernel_channels: int</strong></dt><dd><p>Number of channels for the convolution kernels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of filter kernels. This is equal to the number of channels in the output blob.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of each kernel.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of each kernel.</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>border_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape. Can be either ‘valid’ or ‘same’.</p>
</dd>
<dt><strong>groups: int</strong></dt><dd><p>Number of kernel groups. Input is divided into groups along the channel axis.
Each kernel group share the same weights.</p>
</dd>
<dt><strong>W: numpy.array or bytes() or None</strong></dt><dd><p>Weight of the convolution kernels.</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">is_deconv</span></code> is False, <code class="docutils literal notranslate"><span class="pre">W</span></code> should have
shape <code class="docutils literal notranslate"><span class="pre">(height,</span> <span class="pre">width,</span> <span class="pre">kernel_channels,</span> <span class="pre">output_channels)</span></code>, where:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">kernel_channel</span> <span class="pre">=</span> <span class="pre">input_channels</span> <span class="pre">/</span> <span class="pre">groups</span></code></p>
</div></blockquote>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">is_deconv</span></code> is True, <code class="docutils literal notranslate"><span class="pre">W</span></code> should have
shape <code class="docutils literal notranslate"><span class="pre">(height,</span> <span class="pre">width,</span> <span class="pre">kernel_channels,</span> <span class="pre">output_channels</span> <span class="pre">/</span> <span class="pre">groups)</span></code>, where:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">kernel_channel</span> <span class="pre">=</span> <span class="pre">input_channels</span></code></p>
</div></blockquote>
</li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code> (quantized), other quantization
related arguments must be provided as well (see below).</p>
<p>For Core ML specification version &gt;=4, <code class="docutils literal notranslate"><span class="pre">W</span></code> can be <code class="docutils literal notranslate"><span class="pre">None</span></code>. In this case,
the convolution layer takes 2 inputs, where the 1st input represents
the input feature map, and the 2nd input represents the weight blob.</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Biases of the convolution kernels. <code class="docutils literal notranslate"><span class="pre">b</span></code> should have shape <code class="docutils literal notranslate"><span class="pre">(outputChannels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether bias is ignored.</p>
<ul class="simple">
<li><p>If True, bias is not ignored.</p></li>
<li><p>If False, bias is ignored.</p></li>
</ul>
</dd>
<dt><strong>is_deconv: boolean</strong></dt><dd><p>Whether the convolution layer is performing a convolution or a
transposed convolution (deconvolution).</p>
<ul class="simple">
<li><p>If True, the convolution layer is performing transposed convolution.</p></li>
<li><p>If False, the convolution layer is performing regular convolution.</p></li>
</ul>
</dd>
<dt><strong>output_shape: tuple or None</strong></dt><dd><p>Either <code class="docutils literal notranslate"><span class="pre">None</span></code> or a 2-tuple, specifying the output
shape <code class="docutils literal notranslate"><span class="pre">(output_height,</span> <span class="pre">output_width)</span></code>.</p>
<ul class="simple">
<li><p>Used only when <code class="docutils literal notranslate"><span class="pre">is_deconv</span> <span class="pre">==</span> <span class="pre">True</span></code>.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">is_deconv</span> <span class="pre">==</span> <span class="pre">False</span></code>, this parameter is ignored.</p></li>
<li><p>If it is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the output shape is calculated automatically using the <code class="docutils literal notranslate"><span class="pre">border_mode</span></code>.</p></li>
</ul>
</dd>
<dt><strong>input_name: str or list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>dilation_factors: list of int</strong></dt><dd><p>Dilation factors across height and width directions. Must be a list of two positive integers.
Defaults to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1]</span></code>.</p>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>Values of height (top, bottom) and width (left, right) padding
to be used if <code class="docutils literal notranslate"><span class="pre">border_more</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;valid&quot;</span></code>.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str</strong></dt><dd><p>Type of asymmetric padding to be used when  <code class="docutils literal notranslate"><span class="pre">border_mode</span></code> is <code class="docutils literal notranslate"><span class="pre">'same'</span></code>.
Can be either <code class="docutils literal notranslate"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></code> or  <code class="docutils literal notranslate"><span class="pre">'TOP_LEFT_HEAVY'</span></code>.</p>
<blockquote>
<div><dl>
<dt>Quantization</dt><dd><p>Quantization arguments expected in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>, when <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>.</p>
<blockquote>
<div><dl class="simple">
<dt>quantization_type: str</dt><dd><p>When weights are quantized (that is, <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>),
this should be either <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lut&quot;</span></code>.</p>
</dd>
<dt>nbits: int</dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight
value. Only applicable when weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt><dd><p>scale vector to be used with linear quantization. Must be of
length either 1 or <code class="docutils literal notranslate"><span class="pre">output_channels</span></code>.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt><dd><p>bias vector to be used with linear quantization. Must be of
length either 1 or <code class="docutils literal notranslate"><span class="pre">output_channels</span></code>.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt><dd><p>the LUT (look up table) to be used with LUT quantization.
Must be of length 2^n bits.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><strong>Depthwise convolution</strong></dt><dd><p>Depthwise convolution is a special case of convolution, in which:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kernel_channels</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">(==</span> <span class="pre">input_channels</span> <span class="pre">/</span> <span class="pre">groups)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_channels</span> <span class="pre">=</span> <span class="pre">channel_multiplier</span> <span class="pre">*</span> <span class="pre">input_channels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groups</span> <span class="pre">=</span> <span class="pre">input_channels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W</span></code>: <code class="docutils literal notranslate"><span class="pre">[Kernel_height,</span> <span class="pre">Kernel_width,</span> <span class="pre">1,</span> <span class="pre">channel_multiplier</span> <span class="pre">*</span> <span class="pre">input_channels]</span></code></p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution3d</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batchnorm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d">
<span class="sig-name descname"><span class="pre">add_convolution3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_deconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_convolution3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution3d" title="Permalink to this definition"></a></dt>
<dd><p>Add a 3 dimensional convolution layer to the network.
Refer to the <code class="docutils literal notranslate"><span class="pre">Convolution3DLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_channels: int</strong></dt><dd><p>Number of input channels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of filter kernels. This is equal to the number of channels in the output blob.</p>
</dd>
<dt><strong>depth: int</strong></dt><dd><p>Depth of each kernel.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of each kernel.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of each kernel.</p>
</dd>
<dt><strong>W: numpy.array or bytes()</strong></dt><dd><p>Weight of the convolution kernels. <code class="docutils literal notranslate"><span class="pre">W</span></code> should have shape:</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">deconv</span></code> is False:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(output_channels,</span> <span class="pre">kernel_channels,</span> <span class="pre">depth,</span> <span class="pre">height,</span> <span class="pre">width)</span></code>, where:</p>
<p><code class="docutils literal notranslate"><span class="pre">kernel_channels</span> <span class="pre">=</span> <span class="pre">input_channels</span> <span class="pre">/</span> <span class="pre">groups</span></code></p>
</div></blockquote>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">deconv</span></code> is True:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(output_channels</span> <span class="pre">/</span> <span class="pre">groups,</span> <span class="pre">kernel_channels,</span> <span class="pre">depth,</span> <span class="pre">height,</span> <span class="pre">width)</span></code>, where:</p>
<p><code class="docutils literal notranslate"><span class="pre">kernel_channels</span> <span class="pre">=</span> <span class="pre">input_channels</span></code></p>
</div></blockquote>
</li>
</ul>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Biases of the convolution kernels. <code class="docutils literal notranslate"><span class="pre">b</span></code> should have shape <code class="docutils literal notranslate"><span class="pre">(outputChannels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether bias is ignored.
- If True, bias is not ignored.
- If False, bias is ignored.</p>
</dd>
<dt><strong>groups: int</strong></dt><dd><p>Number of kernel groups. Input is divided into groups along the channel axis. Each
kernel group share the same weights. Defaults to 1.</p>
</dd>
<dt><strong>stride_depth, stride_height, stride_width: int</strong></dt><dd><p>Stride along the depth, height, and width directions, respectively. Must all be positive
integers. Defaults to 1.</p>
</dd>
<dt><strong>dilation_depth, dilation_width, dilation_height: int</strong></dt><dd><p>Dilation factors across depth, height, and width directions. Must all be positive
integers. Defaults to 1 in each dimension.</p>
</dd>
<dt><strong>is_deconv: bool</strong></dt><dd><p>True if this is Convolution Transpose, otherwise False.</p>
</dd>
<dt><strong>output_shape: None or Tuple of int</strong></dt><dd><p>Applicable only for Deconvolution layer.
<code class="docutils literal notranslate"><span class="pre">None</span></code> if Convolution.
Tuple of length 3 if Convolution Transpose.</p>
</dd>
<dt><strong>padding_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape.
Can be <code class="docutils literal notranslate"><span class="pre">'custom'</span></code>, <code class="docutils literal notranslate"><span class="pre">'valid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'same'</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">'valid'</span></code>. Case-insensitive.</p>
</dd>
<dt><strong>padding_front, padding_back, padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>Values of depth (front, back), height (top, bottom), and width (left, right) padding to
be used. Must all be positive integers. All default to 0.</p>
</dd>
<dt><strong>input_name: str or list of str</strong></dt><dd><p>The input blob name(s) of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Depthwise convolution</strong></dt><dd><blockquote>
<div><p>Depthwise convolution is a special case of convolution, in which:</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kernel_channels</span> <span class="pre">=</span> <span class="pre">1</span></code> (<code class="docutils literal notranslate"><span class="pre">==</span> <span class="pre">input_channels</span> <span class="pre">/</span> <span class="pre">groups</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_channels</span> <span class="pre">=</span> <span class="pre">channel_multiplier</span> <span class="pre">*</span> <span class="pre">input_channels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groups</span> <span class="pre">=</span> <span class="pre">input_channels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W</span></code>: <code class="docutils literal notranslate"><span class="pre">[Kernel_depth,</span> <span class="pre">Kernel_height,</span> <span class="pre">Kernel_width,</span> <span class="pre">1,</span> <span class="pre">channel_multiplier</span> <span class="pre">*</span> <span class="pre">input_channels]</span></code></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batchnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batchnorm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy">
<span class="sig-name descname"><span class="pre">add_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_copy" title="Permalink to this definition"></a></dt>
<dd><p>Add a copy layer to the model that copies its input tensor to the output
tensor. Input tensor and output tensor must have distinct names.
Refer to the <code class="docutils literal notranslate"><span class="pre">CopyLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos">
<span class="sig-name descname"><span class="pre">add_cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="Permalink to this definition"></a></dt>
<dd><p>Add a cos layer to the model that computes element-wise cosine for the
input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">CosLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cosh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh">
<span class="sig-name descname"><span class="pre">add_cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_cosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cosh" title="Permalink to this definition"></a></dt>
<dd><p>Add a osh layer to the model that computes element-wise hyperbolic
cosine for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">CoshLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acos</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_acosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_acosh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop">
<span class="sig-name descname"><span class="pre">add_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="Permalink to this definition"></a></dt>
<dd><p>Add a cropping layer to the model.
The cropping layer have two functional modes:</p>
<blockquote>
<div><ul class="simple">
<li><p>When it has 1 input blob, it crops the input blob based
on the 4 parameters <code class="docutils literal notranslate"><span class="pre">[left,</span> <span class="pre">right,</span> <span class="pre">top,</span> <span class="pre">bottom]</span></code>.</p></li>
<li><p>When it has 2 input blobs, it crops the first input blob based
on the dimension of the second blob with an offset.</p></li>
</ul>
</div></blockquote>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">CropLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt><dd><p>Number of elements to be cropped on the left side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>right: int</strong></dt><dd><p>Number of elements to be cropped on the right side of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>top: int</strong></dt><dd><p>Number of elements to be cropped on the top of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>bottom: int</strong></dt><dd><p>Number of elements to be cropped on the bottom of the input blob.
When the crop layer takes 2 inputs, this parameter is ignored.</p>
</dd>
<dt><strong>offset: list of int</strong></dt><dd><p>Offset along the height and width directions when the crop layer takes 2 inputs. Must be a list of length 2.
When the crop layer takes 1 input, this parameter is ignored.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. Must be either a list of 1 string (1 input crop layer),
or a list of 2 strings (2-input crop layer).</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize">
<span class="sig-name descname"><span class="pre">add_crop_resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'STRICT_ALIGN_ENDPOINTS_MODE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_roi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_indices_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CORNERS_HEIGHT_FIRST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_crop_resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop_resize" title="Permalink to this definition"></a></dt>
<dd><p>Add a crop resize layer to the model. A layer that extracts cropped spatial patches or RoIs (regions of interest)
from the input and resizes them to a pre-specified size using bilinear interpolation.
Note that RoI Align layer can be implemented with this layer followed by a pooling layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">CropResizeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Must be a list of two names: image feature map and crop indices/RoI input.</dt><dd><ul>
<li><p>First input corresponds to a blob with shape <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">Batch,</span> <span class="pre">C,</span> <span class="pre">H_in,</span> <span class="pre">W_in]</span></code>.
This represents a batch of input image feature data with <code class="docutils literal notranslate"><span class="pre">C</span></code> channels.</p></li>
<li><p>The second input shape must be <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">1,</span> <span class="pre">1]</span></code> or <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>.
This represents the bounding box coordinates for <code class="docutils literal notranslate"><span class="pre">N</span></code> patches/RoIs.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code>: number of patches/RoIs to be extracted.</p></li>
<li><p>If RoI shape = <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>, the channel axis corresponds
to the four coordinates specifying the bounding box.
All the N~ RoIs are extracted from all the batches of the input.</p></li>
<li><p>If RoI shape = <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>, the first element of the
channel axis specifies the input batch id from which to extract the RoI and
must be in the interval <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">Batch</span> <span class="pre">-</span> <span class="pre">1]</span></code>. That is, <code class="docutils literal notranslate"><span class="pre">n</span></code> -th RoI is
extracted from the <code class="docutils literal notranslate"><span class="pre">RoI[n,0,0,0]</span></code> -th input batch id.
The last four elements of the channel axis specify the
bounding box coordinates.</p></li>
</ul>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt><dd><p>Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt><dd><p>Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><ul class="simple">
<li><p>The following values are supported:
<code class="docutils literal notranslate"><span class="pre">'STRICT_ALIGN_ENDPOINTS_MODE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ALIGN_ENDPOINTS_MODE'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'UPSAMPLE_MODE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ROI_ALIGN_MODE'</span></code>.</p></li>
<li><p>This parameter determines the sampling grid used for bilinear interpolation.</p></li>
</ul>
</dd>
<dt><strong>normalized_roi: bool</strong></dt><dd><ul class="simple">
<li><p>If true the bounding box coordinates must be in the interval <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.
They are scaled by <code class="docutils literal notranslate"><span class="pre">(input_height</span> <span class="pre">-</span> <span class="pre">1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(input_width</span> <span class="pre">-</span> <span class="pre">1)</span></code>;
that is, based on the input spatial dimensions.</p></li>
<li><p>If false the bounding box coordinates must be in the interval
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">input_height</span> <span class="pre">-</span> <span class="pre">1]</span></code> and <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">input_width</span> <span class="pre">-</span> <span class="pre">1]</span></code>,
respectively for height and width dimensions.</p></li>
</ul>
</dd>
<dt><strong>box_indices_mode: str</strong></dt><dd><ul class="simple">
<li><p>The following values are supported:
<code class="docutils literal notranslate"><span class="pre">'CORNERS_HEIGHT_FIRST'</span></code>, <code class="docutils literal notranslate"><span class="pre">'CORNERS_WIDTH_FIRST'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'CENTER_SIZE_HEIGHT_FIRST'</span></code>, <code class="docutils literal notranslate"><span class="pre">'CENTER_SIZE_WIDTH_FIRST'</span></code>.</p></li>
<li><dl class="simple">
<dt>Representation used to interpret the bounding box coordinates (RoI) input.</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'CORNERS_HEIGHT_FIRST'</span></code>: <code class="docutils literal notranslate"><span class="pre">[h_start,</span> <span class="pre">w_start,</span> <span class="pre">h_end,</span> <span class="pre">w_end]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CORNERS_WIDTH_FIRST'</span></code>: <code class="docutils literal notranslate"><span class="pre">[w_start,</span> <span class="pre">h_start,</span> <span class="pre">w_end,</span> <span class="pre">h_end]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CENTER_SIZE_HEIGHT_FIRST'</span></code>: <code class="docutils literal notranslate"><span class="pre">[h_center,</span> <span class="pre">w_center,</span> <span class="pre">box_height,</span> <span class="pre">box_width]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CENTER_SIZE_WIDTH_FIRST'</span></code>: <code class="docutils literal notranslate"><span class="pre">[w_center,</span> <span class="pre">h_center,</span> <span class="pre">box_width,</span> <span class="pre">box_height]</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt><strong>spatial_scale: float</strong></dt><dd><p>Additional spatial scale that multiplies the bounding box coordinates.
Generally used while implementing the RoI Align layer,
which uses unnormalized RoI coordinates along with a spatial scale less than or equal to 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_resize_bilinear</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cumsum">
<span class="sig-name descname"><span class="pre">add_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_cumsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_cumsum" title="Permalink to this definition"></a></dt>
<dd><p>Add a cum sum layer to the model computes the cumulative sum values of the input along a given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">CumSumLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>Axis to perform the operation, default: -1.</p>
</dd>
<dt><strong>reverse: bool, optional</strong></dt><dd><p>if true, cumsum is performed in the opposite direction, default: False.</p>
</dd>
<dt><strong>exclusive: bool, optional</strong></dt><dd><p>whether to perform exclusive or inclusive cumulative summation, default: False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom">
<span class="sig-name descname"><span class="pre">add_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_proto_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_custom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_custom" title="Permalink to this definition"></a></dt>
<dd><p>Add a custom layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">CustomLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names to this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names from this layer.</p>
</dd>
<dt><strong>custom_proto_spec: CustomLayerParams</strong></dt><dd><p>A protobuf CustomLayerParams message. This can also be left blank and filled in later.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable">
<span class="sig-name descname"><span class="pre">add_divide_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_divide_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a divide_broadcastable layer to the model that performs element-wise
division operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">DivideBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise">
<span class="sig-name descname"><span class="pre">add_elementwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_elementwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="Permalink to this definition"></a></dt>
<dd><p>Add an element-wise operation layer to the model.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>A list of input blob names of this layer. The input blobs should have the same shape.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>A string specifying the mode of the elementwise layer. It can be one of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'CONCAT'</span></code>: Concatenate input blobs along the channel axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'SEQUENCE_CONCAT'</span></code>: Concatenate input blobs along the sequence axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ADD'</span></code>: Perform an element-wise summation over the input blobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MULTIPLY'</span></code>: Perform an element-wise multiplication over the input blobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DOT'</span></code>: Compute the dot product of the two input blobs.
In this mode, the length of <code class="docutils literal notranslate"><span class="pre">input_names</span></code> should be 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'COS'</span></code>: Compute the cosine similarity of the two input blobs.
In this mode, the length of <code class="docutils literal notranslate"><span class="pre">input_names</span></code> should be 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MAX'</span></code>: Compute the element-wise maximum over the input blobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`'MIN'`</span></code>: Compute the element-wise minimum over the input blobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'AVE'</span></code>: Compute the element-wise average over the input blobs.</p></li>
</ul>
</dd>
<dt><strong>alpha: float</strong></dt><dd><ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">'ADD'</span></code> and there is only one <code class="docutils literal notranslate"><span class="pre">input_name</span></code>,
<code class="docutils literal notranslate"><span class="pre">alpha</span></code> is added to the input.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">'MULTIPLY'</span></code> and there is only one <code class="docutils literal notranslate"><span class="pre">input_name</span></code>,
<code class="docutils literal notranslate"><span class="pre">alpha</span></code> is multiplied to the input.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sequence_repeat</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding">
<span class="sig-name descname"><span class="pre">add_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Add an embedding layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">EmbeddingLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape <code class="docutils literal notranslate"><span class="pre">(output_channels,</span> <span class="pre">input_dim)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code> (quantized to 1-8 bits), other
quantization related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Bias vector of shape <code class="docutils literal notranslate"><span class="pre">(output_channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>input_dim: int</strong></dt><dd><p>Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the <code class="docutils literal notranslate"><span class="pre">spec</span></code>.</p>
<ul class="simple">
<li><p>If True, the bias vector of this layer is not ignored.</p></li>
<li><p>If False, the bias vector is ignored.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments expected, when ``W`` is of type ``bytes()``:</strong></dt><dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt><dd><p>Set it to true when <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>, representing quantized weights.</p>
</dd>
<dt><strong>quantization_type: str</strong></dt><dd><p>When weights are quantized (that is, <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>),
this should be either <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lut&quot;</span></code>.</p>
</dd>
<dt><strong>nbits: int</strong></dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>Scale vector to be used with linear quantization.
Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>Bias vector to be used with linear quantization.
Must be of length either 1 or output_channels.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>The LUT (look up table) to be used with LUT quantization.
Must be of length 2^n bits.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd">
<span class="sig-name descname"><span class="pre">add_embedding_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_embedding_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add an embedding layer to the model that performs a matrix lookup and
optionally adds a bias.
Refer to the <code class="docutils literal notranslate"><span class="pre">EmbeddingNDLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>vocab_size: int</strong></dt><dd><p>Size of the vocabulary (1 + maximum integer index of the words).</p>
</dd>
<dt><strong>embedding_size: int</strong></dt><dd><p>Size of the embedded vector.</p>
</dd>
<dt><strong>W: float32 numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape (embedding_size, vocab_size).
If W is of type bytes(), i.e. quantized to 1-8 bits, other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array , optional</strong></dt><dd><p>Bias vector of shape (embedding_size, ).</p>
</dd>
<dt><strong>Quantization arguments expected, when W is of type bytes():</strong></dt><dd></dd>
<dt><strong>is_quantized_weight: bool</strong></dt><dd><p>Set it to true when W is of type bytes(), representing quantized weights</p>
</dd>
<dt><strong>quantization_type: str</strong></dt><dd><p>When weights are quantized (i.e. W is of type bytes()), this should be either “linear” or “lut”.</p>
</dd>
<dt><strong>nbits: int</strong></dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight value.</p>
</dd>
<dt><strong>quant_scale: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>scale vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_bias: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>bias vector to be used with linear quantization. Must be of length either 1 or embedding_size.</p>
</dd>
<dt><strong>quant_lut: numpy.array(dtype=numpy.float32)</strong></dt><dd><p>the LUT (look up table) to be used with LUT quantization. Must be of length 2^nbits.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal">
<span class="sig-name descname"><span class="pre">add_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="Permalink to this definition"></a></dt>
<dd><p>Add an equal layer to the model that performs the element-wise equal
(=) operation. Broadcasting is supported.
Refer to the <code class="docutils literal notranslate"><span class="pre">EqualLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf">
<span class="sig-name descname"><span class="pre">add_erf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_erf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_erf" title="Permalink to this definition"></a></dt>
<dd><p>Add an erf function (gaussian error function) layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">ErfLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2">
<span class="sig-name descname"><span class="pre">add_exp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_exp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_exp2" title="Permalink to this definition"></a></dt>
<dd><p>Add an exp2 layer to the model that performs element-wise experiential operation.
Refer to the <code class="docutils literal notranslate"><span class="pre">Exp2LayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims">
<span class="sig-name descname"><span class="pre">add_expand_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_expand_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="Permalink to this definition"></a></dt>
<dd><p>Add an expand dims layer to the model that increases the rank of the
input tensor by adding unit dimensions.
Refer to the <code class="docutils literal notranslate"><span class="pre">ExpandDimsLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt><dd><p>Dimensions the operation perform on.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_squeeze</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic">
<span class="sig-name descname"><span class="pre">add_fill_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_fill_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a fill_dynamic layer to the model that outputs a tensor filled
with a scalar value.
Refer to the <code class="docutils literal notranslate"><span class="pre">FillDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like">
<span class="sig-name descname"><span class="pre">add_fill_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_fill_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a fill_like layer to the model outputs a tensor filled with a
scalar value.
Refer to the <code class="docutils literal notranslate"><span class="pre">FillLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static">
<span class="sig-name descname"><span class="pre">add_fill_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_fill_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a fill_static layer to the model that outputs a tensor filled
with a scalar value given shape as parameter.
Refer to the <code class="docutils literal notranslate"><span class="pre">FillStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>The target shape of the output tensor.</p>
</dd>
<dt><strong>value: float, optional</strong></dt><dd><p>A scalar value for the fill operation, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_fill_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fill_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten">
<span class="sig-name descname"><span class="pre">add_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="Permalink to this definition"></a></dt>
<dd><p>Add a flatten layer. Only flattens the channel, height and width axis.
Leaves the sequence axis as is.
Refer to the <code class="docutils literal notranslate"><span class="pre">FlattenLayerParams</span></code> message in the
specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>mode: int</strong></dt><dd><ul class="simple">
<li><p>If mode == 0, the flatten layer is in CHANNEL_FIRST mode.</p></li>
<li><p>If mode == 1, the flatten layer is in CHANNEL_LAST mode.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d">
<span class="sig-name descname"><span class="pre">add_flatten_to_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_flatten_to_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten_to_2d" title="Permalink to this definition"></a></dt>
<dd><p>Add a flatten_to_2d layer to the model that flattens the input tensor
into a 2-dimensional matrix.
Refer to the <code class="docutils literal notranslate"><span class="pre">FlattenTo2DLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>Axis to perform the operation, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor">
<span class="sig-name descname"><span class="pre">add_floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_floor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor" title="Permalink to this definition"></a></dt>
<dd><p>Add a floor layer to the model that performs element-wise floor operation
on the input tensor that rounds the value to the largest integer not
greater than x.
Refer to the <code class="docutils literal notranslate"><span class="pre">FloorLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ceil</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_clip</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable">
<span class="sig-name descname"><span class="pre">add_floor_div_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_floor_div_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_floor_div_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a floor_div_broadcastable layer to the model that performs floor
division operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">FloorDivBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_divide_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_divide_broadcastable</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather">
<span class="sig-name descname"><span class="pre">add_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="Permalink to this definition"></a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input.
Refer to the <code class="docutils literal notranslate"><span class="pre">GatherLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis">
<span class="sig-name descname"><span class="pre">add_gather_along_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_gather_along_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="Permalink to this definition"></a></dt>
<dd><p>Add a gather_along_axis layer to the model that gathers elements or slices
from data and store to a tensor whose shape is defined by indices from the
input along the given axis into the output tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">GatherAlongAxisLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd">
<span class="sig-name descname"><span class="pre">add_gather_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_gather_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a gather layer to the model that gathers elements or slices from
data and store to a tensor whose shape is defined by indices from the
input. This is the reverse operation of the scatter operation.
Refer to the <code class="docutils literal notranslate"><span class="pre">GatherNDLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu">
<span class="sig-name descname"><span class="pre">add_gelu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EXACT'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_gelu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gelu" title="Permalink to this definition"></a></dt>
<dd><p>Add a GELU (gaussian error linear unit) activation layer, which is:
<code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">erf(x</span> <span class="pre">/</span> <span class="pre">sqrt(2)))</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">GeluLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Gelu mode in [EXACT | TANH_APPROXIMATION | SIGMOID_APPROXIMATION], default EXACT.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape">
<span class="sig-name descname"><span class="pre">add_get_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_get_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_get_shape" title="Permalink to this definition"></a></dt>
<dd><p>Add a get_shape layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">GetShapeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d">
<span class="sig-name descname"><span class="pre">add_global_pooling3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_global_pooling3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d" title="Permalink to this definition"></a></dt>
<dd><p>Add a layer to pool three spatial dimensions down to one value.
This behaves like a special case of Pooling3DLayerParams in which
the Kernel is the size of the input and there is no padding.</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">GlobalPooling3DLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>pooling_type: str</strong></dt><dd><p>Type of pooling performed. Can either be <code class="docutils literal notranslate"><span class="pre">'MAX'</span></code> OR <code class="docutils literal notranslate"><span class="pre">'AVERAGE'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling3d</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than">
<span class="sig-name descname"><span class="pre">add_greater_than</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_greater_than_equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_greater_than"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="Permalink to this definition"></a></dt>
<dd><p>Add a greater_than layer to the model that performs the element-wise
greater-than (&gt;) operation or greater-than-or-equal-to (&gt;=) operation.
Broadcasting is supported.
Refer to the <code class="docutils literal notranslate"><span class="pre">GreaterThanLayerParams</span></code>, <code class="docutils literal notranslate"><span class="pre">GreaterEqualLayerParams</span></code> messages
in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>use_greater_than_equal: bool, optional</strong></dt><dd><p>Whether or not to allow greater than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru">
<span class="sig-name descname"><span class="pre">add_gru</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID_HARD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_gru"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="Permalink to this definition"></a></dt>
<dd><p>Add a Gated-Recurrent Unit (GRU) layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">GRULayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices. The ordering is <code class="docutils literal notranslate"><span class="pre">[R_z,</span> <span class="pre">R_r,</span> <span class="pre">R_o]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">R_z</span></code>, <code class="docutils literal notranslate"><span class="pre">R_r</span></code> and <code class="docutils literal notranslate"><span class="pre">R_o</span></code> are weight matrices at update gate,
reset gate and output gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">hidden_size)</span></code>.</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices. The ordering is <code class="docutils literal notranslate"><span class="pre">[W_z,</span> <span class="pre">W_r,</span> <span class="pre">W_o]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">W_z</span></code>, <code class="docutils literal notranslate"><span class="pre">W_r</span></code>, and <code class="docutils literal notranslate"><span class="pre">W_o</span></code> are weight matrices at update gate,
reset gate and output gate.
The shapes of these matrices are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">input_size)</span></code>.</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt><dd><p>List of biases of the GRU layer. The ordering is <code class="docutils literal notranslate"><span class="pre">[b_z,</span> <span class="pre">b_r,</span> <span class="pre">b_o]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">b_z</span></code>, <code class="docutils literal notranslate"><span class="pre">b_r</span></code>, and <code class="docutils literal notranslate"><span class="pre">b_o</span></code> are biases at update gate,
reset gate and output gate.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, biases are ignored. Otherwise the shapes of the biases are <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following options:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
Defaults to <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at update and reset gates.
Can be one of the following options:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
Defaults to <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>.
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">h_input]</span></code>.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of <code class="docutils literal notranslate"><span class="pre">[y,</span> <span class="pre">h_output]</span></code>.</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the recurrent layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product">
<span class="sig-name descname"><span class="pre">add_inner_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_8_dynamic_quantize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_quantized_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quant_lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_inner_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="Permalink to this definition"></a></dt>
<dd><p>Add an inner product layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">InnerProductLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: numpy.array or bytes()</strong></dt><dd><p>Weight matrix of shape <code class="docutils literal notranslate"><span class="pre">(output_channels,</span> <span class="pre">input_channels)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code> (quantized), other quantization
related arguments must be provided as well (see below).</p>
</dd>
<dt><strong>b: numpy.array</strong></dt><dd><p>Bias vector of shape: <code class="docutils literal notranslate"><span class="pre">(output_channels,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>input_channels: int</strong></dt><dd><p>Number of input channels.</p>
</dd>
<dt><strong>output_channels: int</strong></dt><dd><p>Number of output channels.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the spec.</p>
<ul class="simple">
<li><p>If True, the bias vector of this layer is not ignored.</p></li>
<li><p>If False, the bias vector is ignored.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>Quantization arguments, used when ``W`` is of type ``bytes()``:</strong></dt><dd><dl class="simple">
<dt>int_8_dynamic_quantize: boolean</dt><dd><p>Whether to quantize and dequantize before and after inner product, respectively.
Expects byte weights, representing int8 values, if True.
See NeuralNetwork.proto for other validation conditions.</p>
</dd>
<dt>is_quantized_weight: bool, optional</dt><dd><p>Set it to true when <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>, representing
quantized weights, default: false.</p>
</dd>
<dt>quantization_type: str</dt><dd><p>When weights are quantized (that is, <code class="docutils literal notranslate"><span class="pre">W</span></code> is of type <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>),
this should be either <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lut&quot;</span></code>.</p>
</dd>
<dt>nbits: int</dt><dd><p>Should be between 1 and 8 (inclusive). Number of bits per weight
value. Only applicable when weights are quantized.</p>
</dd>
<dt>quant_scale: numpy.array(dtype=numpy.float32)</dt><dd><p>scale vector to be used with linear quantization. Must be of
length either 1 or output_channels.</p>
</dd>
<dt>quant_bias: numpy.array(dtype=numpy.float32)</dt><dd><p>bias vector to be used with linear quantization. Must be of
length either 1 or output_channels.</p>
</dd>
<dt>quant_lut: numpy.array(dtype=numpy.float32)</dt><dd><p>the LUT (look up table) to be used with LUT quantization.
Must be of length 2^n bits.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_embedding</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_batched_mat_mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_batched_mat_mul</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize">
<span class="sig-name descname"><span class="pre">add_l2_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_l2_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="Permalink to this definition"></a></dt>
<dd><p>Add L2 normalize layer. Normalizes the input by the L2 norm, i.e. divides by the
the square root of the sum of squares of all elements of the input along C, H and W dimensions.
Refer to the <code class="docutils literal notranslate"><span class="pre">L2NormalizeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to avoid division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization">
<span class="sig-name descname"><span class="pre">add_layer_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_layer_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_layer_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Add a layer normalization layer to the model that applies layer
normalization over the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">LayerNormalizationLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>normalized_shape: list of int or tuple of int</strong></dt><dd><p>Input shape from an expected input of size.</p>
</dd>
<dt><strong>gamma: WeightParams</strong></dt><dd><p>Weight parameters.</p>
</dd>
<dt><strong>beta: WeightParams</strong></dt><dd><p>Bias parameters.</p>
</dd>
<dt><strong>eps: float, optional</strong></dt><dd><p>Constant value added to the denominator, default: 1e-5.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than">
<span class="sig-name descname"><span class="pre">add_less_than</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_less_than_equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_less_than"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="Permalink to this definition"></a></dt>
<dd><p>Add a less_than layer to the model that performs the element-wise
less-than (&lt;) operation or less-than-or-equal-to (&lt;=) operation.
Broadcasting is supported.
Refer to the <code class="docutils literal notranslate"><span class="pre">LessThanL_ayerParams</span></code>, <code class="docutils literal notranslate"><span class="pre">LessEqualLayerParams</span></code> messages in
specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>use_less_than_equal: bool, optional</strong></dt><dd><p>Whether or not to allow less than or equal to, default: false.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_not_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant">
<span class="sig-name descname"><span class="pre">add_load_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_load_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant" title="Permalink to this definition"></a></dt>
<dd><p>Add a load constant layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">LoadConstantLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array</strong></dt><dd><p>value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt><dd><p>List of ints representing the shape of the constant. Must be of length 3: [C,H,W]</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd">
<span class="sig-name descname"><span class="pre">add_load_constant_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_load_constant_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_load_constant_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a load_constant layer that loads data as a parameter and provides it
as an output.
Refer to the <code class="docutils literal notranslate"><span class="pre">LoadConstantNDLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>constant_value: numpy.array()</strong></dt><dd><p>value of the constant as a numpy array.</p>
</dd>
<dt><strong>shape: list of int or tuple of int</strong></dt><dd><p>List of ints representing the shape of the constant.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical">
<span class="sig-name descname"><span class="pre">add_logical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_logical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_logical" title="Permalink to this definition"></a></dt>
<dd><p>Add a logical layer to the model that performs element-wise logical
and/or/xor/not operation. Broadcasting is supported.
Refer to the <code class="docutils literal notranslate"><span class="pre">LogicalOrLayerParams</span></code>, <code class="docutils literal notranslate"><span class="pre">LogicalNotLayerParams</span></code>,
<code class="docutils literal notranslate"><span class="pre">LogicalNotLayerParams</span></code>, and <code class="docutils literal notranslate"><span class="pre">LogicalAndLayerParam</span></code> messages in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Logical operation mode in [AND | OR | XOR | NOT].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop">
<span class="sig-name descname"><span class="pre">add_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="Permalink to this definition"></a></dt>
<dd><p>Add a loop layer to the model that provides the functionality of a <code class="docutils literal notranslate"><span class="pre">for</span></code>
loop, or a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop.
Refer to the <code class="docutils literal notranslate"><span class="pre">LoopLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>body_network: NeuralNetwork</strong></dt><dd><p>Neural network to execute for the body of the loop.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>condition: str, optional</strong></dt><dd><p>Condition of the loop.</p>
</dd>
<dt><strong>condition_network: NeuralNetwork, optional</strong></dt><dd><p>Neural network to execute for the condition of the loop.</p>
</dd>
<dt><strong>max_iterations: int, optional</strong></dt><dd><p>Maximum number of iterations of the loop.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break">
<span class="sig-name descname"><span class="pre">add_loop_break</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_loop_break"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="Permalink to this definition"></a></dt>
<dd><p>Add a loop_break layer to the model that terminates the loop that
contains this layer. Must reside in the <code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">LoopBreakLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_continue</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue">
<span class="sig-name descname"><span class="pre">add_loop_continue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_loop_continue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_continue" title="Permalink to this definition"></a></dt>
<dd><p>Add a loop_continue layer to the model that stops the current loop
iteration and continue on the next iteration. Must reside in the
<code class="docutils literal notranslate"><span class="pre">bodyNetwork</span></code> of the loop layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">LoopContinueLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_loop_break"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loop_break</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_branch</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular">
<span class="sig-name descname"><span class="pre">add_lower_triangular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_lower_triangular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="Permalink to this definition"></a></dt>
<dd><p>Add a lower_triangular layer to the model that copies a tensor setting
everything outside lower triangular to zero.
Refer to the <code class="docutils literal notranslate"><span class="pre">LowerTriangularLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>Diagonal below which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upper_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn">
<span class="sig-name descname"><span class="pre">add_lrn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_lrn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="Permalink to this definition"></a></dt>
<dd><p>Add a LRN (local response normalization) layer. Supports “across” channels normalization.
Refer to the <code class="docutils literal notranslate"><span class="pre">LRNLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float</strong></dt><dd><p>multiplicative constant in the denominator.</p>
</dd>
<dt><strong>beta: float</strong></dt><dd><p>exponent of the normalizing term in the denominator.</p>
</dd>
<dt><strong>k: float</strong></dt><dd><p>bias term in the denominator. Must be positive.</p>
</dd>
<dt><strong>local_size: int</strong></dt><dd><p>size of the neighborhood along the channel axis.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_mvn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part">
<span class="sig-name descname"><span class="pre">add_matrix_band_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_matrix_band_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="Permalink to this definition"></a></dt>
<dd><p>Add a matrix_band_part layer to the model that copies a tensor setting
everything outside a central band in each inner-most matrix to zero.
Refer to the <code class="docutils literal notranslate"><span class="pre">MatrixBandPartLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>num_lower: int, optional</strong></dt><dd><p>Number of lower sub-diagonals to keep.
Default: -1 (keep entire lower triangle).</p>
</dd>
<dt><strong>num_upper: int, optional</strong></dt><dd><p>Number of upper sub-diagonals to keep.
Default: -1 (keep entire upper triangle).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable">
<span class="sig-name descname"><span class="pre">add_max_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_max_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_max_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a max_broadcastable layer to the model that performs element-wise
maximum operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">MaxBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable">
<span class="sig-name descname"><span class="pre">add_min_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_min_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_min_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a min_broadcastable layer to the model that performs element-wise
minimum operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">MinBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable">
<span class="sig-name descname"><span class="pre">add_mod_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_mod_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mod_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a mod_broadcastable layer to the model that performs element-wise
modular operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">ModBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable">
<span class="sig-name descname"><span class="pre">add_multiply_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_multiply_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_multiply_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a multiply_broadcastable layer to the model that performs element-wise
multiplication operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">MultiplyBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn">
<span class="sig-name descname"><span class="pre">add_mvn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_mvn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_mvn" title="Permalink to this definition"></a></dt>
<dd><p>Add an MVN (mean variance normalization) layer. Computes mean, variance and normalizes the input.
Refer to the <code class="docutils literal notranslate"><span class="pre">MeanVarianceNormalizeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>across_channels: boolean</strong></dt><dd><p>If False, each channel plane is normalized separately
If True, mean/variance is computed across all C, H and W dimensions</p>
</dd>
<dt><strong>normalize_variance: boolean</strong></dt><dd><p>If False, only mean subtraction is performed.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to avoid division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_l2_normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_l2_normalize</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lrn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lrn</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms">
<span class="sig-name descname"><span class="pre">add_nms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_class_suppression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_nms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_nms" title="Permalink to this definition"></a></dt>
<dd><p>Add a non maximum suppression layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">NonMaximumSuppressionLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. Must be at least 2, and maximum 5.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer. Must be of length 4 exactly.</p>
</dd>
<dt><strong>iou_threshold: float</strong></dt><dd><p>intersection over union threshold for suppression. Ignored if 3rd input is present.</p>
</dd>
<dt><strong>score_threshold: float</strong></dt><dd><p>threshold for selecting boxes to be used for NMS algorithm. Ignored if 4th input is present.</p>
</dd>
<dt><strong>max_boxes: int</strong></dt><dd><p>maximum number of boxes to output. Ignored if 5th input is present.</p>
</dd>
<dt><strong>per_class_suppression: bool</strong></dt><dd><p>If true, boxes are organized into classes and suppression is applied to each class group separately</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal">
<span class="sig-name descname"><span class="pre">add_not_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_not_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_not_equal" title="Permalink to this definition"></a></dt>
<dd><p>Add a not_equal layer to the model that performs the element-wise not
equal (!=) operation. Broadcasting is supported.
Refer to the <code class="docutils literal notranslate"><span class="pre">NotEqualLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>alpha: float, optional</strong></dt><dd><p>y = x1 != alpha, if only one input is provided, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_equal</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_greater_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_greater_than</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_less_than"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_less_than</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_one_hot">
<span class="sig-name descname"><span class="pre">add_one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_hot_vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">off_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_one_hot" title="Permalink to this definition"></a></dt>
<dd><p>Add a one hot layer to the model that computes the one hot representation of the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">OneHotLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>one_hot_vector_size:  int &gt; 0</strong></dt><dd><p>size of the one hot vector.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>refers to the axis in the output tensor, default: -1.</p>
</dd>
<dt><strong>on_value: float, optional</strong></dt><dd><p>Constant value on locations represented by first input, default: 1.0.</p>
</dd>
<dt><strong>off_value: float, optional</strong></dt><dd><p>Constant value at all other locations, default: 0.0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals">
<span class="sig-name descname"><span class="pre">add_optionals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optionals_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionals_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_optionals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_optionals" title="Permalink to this definition"></a></dt>
<dd><p>Add optional inputs and outputs to the model spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>optionals_in: list of str</strong></dt><dd><p>List of inputs that are optionals.</p>
</dd>
<dt><strong>optionals_out: list of str</strong></dt><dd><p>List of outputs that are optionals.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding">
<span class="sig-name descname"><span class="pre">add_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_padding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_padding" title="Permalink to this definition"></a></dt>
<dd><p>Add a padding layer to the model that performs padding along spatial dimensions.</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">PaddingLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>left: int</strong></dt><dd><p>Number of elements to be padded on the left side of the input blob.</p>
</dd>
<dt><strong>right: int</strong></dt><dd><p>Number of elements to be padded on the right side of the input blob.</p>
</dd>
<dt><strong>top: int</strong></dt><dd><p>Number of elements to be padded on the top of the input blob.</p>
</dd>
<dt><strong>bottom: int</strong></dt><dd><p>Number of elements to be padded on the bottom of the input blob.</p>
</dd>
<dt><strong>value: float</strong></dt><dd><p>Value of the elements padded. Used only when <code class="docutils literal notranslate"><span class="pre">padding_type</span> <span class="pre">=</span> <span class="pre">'constant'</span></code>.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>padding_type: str</strong></dt><dd><p>Type of the padding. Can be one of <code class="docutils literal notranslate"><span class="pre">'constant'</span></code>, <code class="docutils literal notranslate"><span class="pre">'reflection'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'replication'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crop</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_constant_pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant_pad</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute">
<span class="sig-name descname"><span class="pre">add_permute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_permute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="Permalink to this definition"></a></dt>
<dd><p>Add a permute layer. Assumes that the input has dimensions in the order [Seq, C, H, W]
Refer to the <code class="docutils literal notranslate"><span class="pre">PermuteLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>dim: tuple</strong></dt><dd><p>The order in which to permute the input dimensions = [seq,C,H,W].
Must have length 4 and a permutation of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>.</p>
<p>examples:</p>
<p>Lets say input has shape: [seq, C, H, W].</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>,
then the output has shape <code class="docutils literal notranslate"><span class="pre">[W,C,H]</span></code>
and has the same sequence length that of the input.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">0]</span></code>,
and the input is a sequence of data
with length <code class="docutils literal notranslate"><span class="pre">Seq</span></code> and shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>,
then the output is a unit sequence of data with shape <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">1,</span> <span class="pre">Seq]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">2,</span> <span class="pre">1]</span></code>,
the output is a reverse of the input: <code class="docutils literal notranslate"><span class="pre">[C,</span> <span class="pre">H,</span> <span class="pre">W]</span> <span class="pre">-&gt;</span> <span class="pre">[W,</span> <span class="pre">H,</span> <span class="pre">C]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim</span></code> is not set, or is set to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>,
the output is the same as the input.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling">
<span class="sig-name descname"><span class="pre">add_pooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_pad_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_global</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_padding_asymmetry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_pooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="Permalink to this definition"></a></dt>
<dd><p>Add a pooling layer to the model that performs spatial pooling.
Refer to the <code class="docutils literal notranslate"><span class="pre">PoolingLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>height: int</strong></dt><dd><p>Height of pooling region.</p>
</dd>
<dt><strong>width: int</strong></dt><dd><p>Width of pooling region.</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the width direction.</p>
</dd>
<dt><strong>layer_type: str</strong></dt><dd><p>Type of pooling performed. Can either be <code class="docutils literal notranslate"><span class="pre">'MAX'</span></code>, <code class="docutils literal notranslate"><span class="pre">'AVERAGE'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>.</p>
</dd>
<dt><strong>padding_type: str</strong></dt><dd><p>Option for the type of padding and output blob shape. Can be either
<code class="docutils literal notranslate"><span class="pre">'VALID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SAME'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'INCLUDE_LAST_PIXEL'</span></code>.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>exclude_pad_area: boolean</strong></dt><dd><p>Whether to exclude padded area in the <code class="docutils literal notranslate"><span class="pre">'AVERAGE'</span></code> pooling operation,
default: true. This flag is only used with average pooling.</p>
<ul class="simple">
<li><p>If True, the value of the padded area will be excluded.</p></li>
<li><p>If False, the padded area will be included.</p></li>
</ul>
</dd>
<dt><strong>is_global: boolean</strong></dt><dd><p>Whether the pooling operation is global. Defaults to False.</p>
<ul class="simple">
<li><p>If True, the pooling operation is global. The pooling region
is of the same size of the input blob.
Parameters <code class="docutils literal notranslate"><span class="pre">height</span></code>, <code class="docutils literal notranslate"><span class="pre">width</span></code>, <code class="docutils literal notranslate"><span class="pre">stride_height</span></code>, and <code class="docutils literal notranslate"><span class="pre">stride_width</span></code> will be ignored.</p></li>
<li><p>If False, the pooling operation is not global.</p></li>
</ul>
</dd>
<dt><strong>padding_top, padding_bottom, padding_left, padding_right: int</strong></dt><dd><p>Values of height (top, bottom) and width (left, right) padding
to be used if padding type is <code class="docutils literal notranslate"><span class="pre">&quot;VALID&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;INCLUDE_LAST_PIXEL&quot;</span></code>.</p>
</dd>
<dt><strong>same_padding_asymmetry_mode: str.</strong></dt><dd><p>Type of asymmetric padding to be used when <code class="docutils literal notranslate"><span class="pre">padding_type</span> <span class="pre">=</span> <span class="pre">'SAME'</span></code>.
Can be either <code class="docutils literal notranslate"><span class="pre">'BOTTOM_RIGHT_HEAVY'</span></code> or <code class="docutils literal notranslate"><span class="pre">'TOP_LEFT_HEAVY'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling3d</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d">
<span class="sig-name descname"><span class="pre">add_pooling3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_padding_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_pooling_count_excludes_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_pooling3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling3d" title="Permalink to this definition"></a></dt>
<dd><p>Add a pooling layer to the model that performs spatial pooling across three dimensions.
Refer to the <code class="docutils literal notranslate"><span class="pre">Pooling3DLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>pooling_type: str</strong></dt><dd><p>Type of pooling performed. Can either be <code class="docutils literal notranslate"><span class="pre">'MAX'</span></code> OR <code class="docutils literal notranslate"><span class="pre">'AVERAGE'</span></code>.</p>
</dd>
<dt><strong>kernel_depth: int</strong></dt><dd><p>Depth of the pooling region.</p>
</dd>
<dt><strong>kernel_height: int</strong></dt><dd><p>Height of pooling region.</p>
</dd>
<dt><strong>kernel_width: int</strong></dt><dd><p>Width of pooling region.</p>
</dd>
<dt><strong>stride_depth: int</strong></dt><dd><p>Stride along the depth direction</p>
</dd>
<dt><strong>stride_height: int</strong></dt><dd><p>Stride along the height direction.</p>
</dd>
<dt><strong>stride_width: int</strong></dt><dd><p>Stride along the width direction.</p>
</dd>
<dt><strong>padding_mode: str</strong></dt><dd><p>Option for the padding type and output blob shape.
Can be <code class="docutils literal notranslate"><span class="pre">'VALID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SAME'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'CUSTOM'</span></code>.</p>
</dd>
<dt><strong>custom_padding_front: int</strong></dt><dd><p>Padding before the input in the depth direction.</p>
</dd>
<dt><strong>custom_padding_back: int</strong></dt><dd><p>Padding after the input in the depth direction.</p>
</dd>
<dt><strong>custom_padding_top: int</strong></dt><dd><p>Padding before the input in the height direction.</p>
</dd>
<dt><strong>custom_padding_bottom: int</strong></dt><dd><p>Padding after the input in the height direction.</p>
</dd>
<dt><strong>custom_padding_left: int</strong></dt><dd><p>Padding before the input in the width direction.</p>
</dd>
<dt><strong>custom_padding_right: int</strong></dt><dd><p>Padding after the input in the width direction.</p>
</dd>
<dt><strong>average_pooling_count_excludes_padding: boolean</strong></dt><dd><p>If true, exclude zeros from padding in average pooling.
Can only be true for <code class="docutils literal notranslate"><span class="pre">AVERAGE</span></code> padding.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_pooling</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_global_pooling3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_global_pooling3d</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable">
<span class="sig-name descname"><span class="pre">add_pow_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_pow_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_pow_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a pow_broadcastable layer to the model that performs element-wise
power operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">PowBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic">
<span class="sig-name descname"><span class="pre">add_random_bernoulli_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_bernoulli_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_bernoulli_dynamic layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomBernoulliDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like">
<span class="sig-name descname"><span class="pre">add_random_bernoulli_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_bernoulli_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_bernoulli_like layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomBernoulliLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static">
<span class="sig-name descname"><span class="pre">add_random_bernoulli_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_bernoulli_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_bernoulli_static layer to the model that fills the output
tensor with random values from Bernoulli distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomBernoulliStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>prob: float, optional</strong></dt><dd><p>Probabilities for Bernoulli distribution, default: 0.5.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_bernoulli_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_bernoulli_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic">
<span class="sig-name descname"><span class="pre">add_random_normal_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_normal_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_normal_dynamic layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomNormalDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like">
<span class="sig-name descname"><span class="pre">add_random_normal_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_normal_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_normal_like layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomNormalLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution, default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static">
<span class="sig-name descname"><span class="pre">add_random_normal_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_normal_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_normal_static layer to the model that fills the output
tensor with random values from normal distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomNormaStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>mean: float, optional</strong></dt><dd><p>The mean of the normal distribution, default: 0.0.</p>
</dd>
<dt><strong>stddev: float, optional</strong></dt><dd><p>The standard deviation of the normal distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. Default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_normal_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_normal_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic">
<span class="sig-name descname"><span class="pre">add_random_uniform_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_uniform_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_uniform_dynamic layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomUniformDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like">
<span class="sig-name descname"><span class="pre">add_random_uniform_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_uniform_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_uniform_like layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomUniformLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static">
<span class="sig-name descname"><span class="pre">add_random_uniform_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_random_uniform_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a random_uniform_static layer to the model that fills the output
tensors with random values from uniform distribution.
Refer to the <code class="docutils literal notranslate"><span class="pre">RandomUniformStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
<dt><strong>minval: float, optional</strong></dt><dd><p>Lower bound / minimum value of the uniform distribution, default: 0.0.</p>
</dd>
<dt><strong>maxval: float, optional</strong></dt><dd><p>Upper bound / maximum value of the uniform distribution, default: 1.0.</p>
</dd>
<dt><strong>seed: int, optional</strong></dt><dd><p>Used to create a random seed for the distribution. default -1 (random).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_random_uniform_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_random_uniform_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic">
<span class="sig-name descname"><span class="pre">add_range_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_range_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a range_dynamic layer that returns a tensor that contains evenly spaced values.
This layer has up to three inputs or no input and three parameters.
Refer to the <code class="docutils literal notranslate"><span class="pre">RangeDynamicLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names.
If input size == 1: end is input, start and step are read from parameters
If input size == 2: end, start are inputs, step is read from parameters
If input size == 3: start, end, step are all inputs, none of the parameters are used.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>start: int, optional</strong></dt><dd><p>Range parameter: start. Ignored if start is provided as input, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>Range parameter: step. Ignored if step is provided as input, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static">
<span class="sig-name descname"><span class="pre">add_range_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_range_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a range_static layer that returns a tensor that contains evenly spaced values.
This layer has no input and three parameters.
Refer to the <code class="docutils literal notranslate"><span class="pre">RangeStaticLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>end: int, optional</strong></dt><dd><p>Range parameter: end, default: 1.</p>
</dd>
<dt><strong>start: int, optional</strong></dt><dd><p>Range parameter: start, default: 0.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>Range parameter: step size, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_range_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_range_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape">
<span class="sig-name descname"><span class="pre">add_rank_preserving_reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_rank_preserving_reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="Permalink to this definition"></a></dt>
<dd><p>Add a rank_preserving_reshape layer to the model that reshapes the input
tensor without altering the rank of the tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">RankPreservingReshapeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Determines the shape of the output blob.
0: copy the dimension of the input to output
-1: calculate dimensions from the rest of the shape</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce">
<span class="sig-name descname"><span class="pre">add_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce layer. Applies the function specified by the parameter mode,
along dimension(s) specified by the parameter axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt><dd><p>dimensions along which the reduction operation is applied.
Allowed values: ‘CHW’, ‘HW’, ‘C’, ‘H’, ‘W’</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Reduction operation to be applied.
Allowed values:
‘sum’, ‘avg’, ‘prod’, ‘logsum’, ‘sumsquare’, ‘L1’, ‘L2’, ‘max’, ‘min’, ‘argmax’.
‘argmax’ is only supported with axis values ‘C’, ‘H’ and ‘W’.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>number that is added to the input when ‘logsum’ function is applied.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1">
<span class="sig-name descname"><span class="pre">add_reduce_l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_l1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_l1 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l1_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceL1LayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2">
<span class="sig-name descname"><span class="pre">add_reduce_l2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_l2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_l2 layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">l2_normalization(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceL2LayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum">
<span class="sig-name descname"><span class="pre">add_reduce_logsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_logsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_logsum layer to the model that reduces the input tensor
using log(sum(elements across given dimensions)).
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceLogSumLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp">
<span class="sig-name descname"><span class="pre">add_reduce_logsumexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_logsumexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_logsumexp layer to the model that computes <code class="docutils literal notranslate"><span class="pre">log(sum(exp(tensor)))</span></code>
and reduces along the given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceLogSumExpLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max">
<span class="sig-name descname"><span class="pre">add_reduce_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_max layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">max(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceMaxLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean">
<span class="sig-name descname"><span class="pre">add_reduce_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_mean layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">mean(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceMeanLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min">
<span class="sig-name descname"><span class="pre">add_reduce_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_min layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">min(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceMinLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod">
<span class="sig-name descname"><span class="pre">add_reduce_prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_prod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_prod layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">prod(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceProdLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes. If axes list is empty, it will
be set to true, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum">
<span class="sig-name descname"><span class="pre">add_reduce_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_sum layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions)</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceSumLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range <code class="docutils literal notranslate"><span class="pre">[-rank(input),</span> <span class="pre">rank(input))</span></code>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">reduce_all</span></code>).</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sumsquare</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare">
<span class="sig-name descname"><span class="pre">add_reduce_sumsquare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reduce_sumsquare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sumsquare" title="Permalink to this definition"></a></dt>
<dd><p>Add a reduce_sumsquare layer to the model that reduces the input tensor
using <code class="docutils literal notranslate"><span class="pre">sum(square(elements</span> <span class="pre">across</span> <span class="pre">given</span> <span class="pre">dimensions))</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReduceSumSquareLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>List of dimensions for the reduce operations.
Each should be in range [-rank(input), rank(input)), default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (reduce_all)</p>
</dd>
<dt><strong>keepdims: bool, optional</strong></dt><dd><p>Whether or not to retain the reduced dimensions with length 1, default: true.</p>
</dd>
<dt><strong>reduce_all: bool, optional</strong></dt><dd><p>Whether or not to reduce on all axes, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l1</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_l2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_l2</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_sum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_min</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_prod</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_max</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_mean</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsum</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reduce_logsumexp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reduce_logsumexp</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data">
<span class="sig-name descname"><span class="pre">add_reorganize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPACE_TO_DEPTH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reorganize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reorganize_data" title="Permalink to this definition"></a></dt>
<dd><p>Add a data reorganization layer of type “SPACE_TO_DEPTH” or “DEPTH_TO_SPACE”.
Refer to the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><ul class="simple">
<li><p>If mode == ‘SPACE_TO_DEPTH’: data is moved from the spatial to the channel dimension.
Input is spatially divided into non-overlapping blocks of size block_size X block_size
and data from each block is moved to the channel dimension.
Output CHW dimensions are: [C * block_size * block_size, H/block_size, C/block_size].</p></li>
<li><p>If mode == ‘DEPTH_TO_SPACE’: data is moved from the channel to the spatial dimension.
Reverse of the operation ‘SPACE_TO_DEPTH’.
Output CHW dimensions are: [C/(block_size * block_size), H * block_size, C * block_size].</p></li>
<li><p>If mode == ‘PIXEL_SHUFFLE’:  data is moved from the channel to the spatial dimension.
Reverse of the operation ‘SPACE_TO_DEPTH’.
Output CHW dimensions are: [C/(block_size * block_size), H * block_size, C * block_size].</p></li>
</ul>
</dd>
<dt><strong>block_size: int</strong></dt><dd><p>Must be greater than 1. Must divide H and W, when mode is ‘SPACE_TO_DEPTH’. (block_size * block_size)
must divide C when mode is ‘DEPTH_TO_SPACE’ or ‘PIXEL_SHUFFLE’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape">
<span class="sig-name descname"><span class="pre">add_reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="Permalink to this definition"></a></dt>
<dd><p>Add a reshape layer.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReshapeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>target_shape: tuple</strong></dt><dd><p>Shape of the output blob. The product of target_shape must be equal
to the shape of the input blob.
Can be either length 3 (C,H,W) or length 4 (Seq,C,H,W).</p>
</dd>
<dt><strong>mode: int</strong></dt><dd><ul class="simple">
<li><p>If mode == 0, the reshape layer is in CHANNEL_FIRST mode.</p></li>
<li><p>If mode == 1, the reshape layer is in CHANNEL_LAST mode.</p></li>
</ul>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_flatten</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic">
<span class="sig-name descname"><span class="pre">add_reshape_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reshape_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a reshape_dynamic layer to the model that reshapes a tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReshapeDynamicLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like">
<span class="sig-name descname"><span class="pre">add_reshape_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reshape_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="Permalink to this definition"></a></dt>
<dd><p>Add a reshape_like layer to the model that reshapes a tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReshapeLikeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static">
<span class="sig-name descname"><span class="pre">add_reshape_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reshape_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a reshape_static layer to the model that reshapes a tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReshapeStaticLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>output_shape: list of int or tuple of int</strong></dt><dd><p>Target shape of the output tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_like</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape_dynamic</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_rank_preserving_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_rank_preserving_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear">
<span class="sig-name descname"><span class="pre">add_resize_bilinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ALIGN_ENDPOINTS_MODE'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_resize_bilinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="Permalink to this definition"></a></dt>
<dd><p>Add a resize bilinear layer to the model. A layer that resize the input to a given spatial size using bilinear interpolation.
Refer to the <code class="docutils literal notranslate"><span class="pre">ResizeBilinearLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>target_height: int</strong></dt><dd><p>Output height dimension.</p>
</dd>
<dt><strong>target_width: int</strong></dt><dd><p>Output width dimension.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Following values are supported: ‘STRICT_ALIGN_ENDPOINTS_MODE’, ‘ALIGN_ENDPOINTS_MODE’, ‘UPSAMPLE_MODE’, ‘ROI_ALIGN_MODE’.
This parameter determines the sampling grid used for bilinear interpolation.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse">
<span class="sig-name descname"><span class="pre">add_reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="Permalink to this definition"></a></dt>
<dd><p>Add a reverse layer to the model that reverses specific dimensions of
the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReverseLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>reverse_dim: list of int or tuple of int</strong></dt><dd><p>Reverse along the dimension, default [1].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse_sequence</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence">
<span class="sig-name descname"><span class="pre">add_reverse_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_reverse_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse_sequence" title="Permalink to this definition"></a></dt>
<dd><p>Add a reverse sequence layer to the model that reverses variable length slices.
Refer to the <code class="docutils literal notranslate"><span class="pre">ReverseSeqLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>batch_axis: int, optional</strong></dt><dd><p>Slices input along the dimension batch_axis, default 0.</p>
</dd>
<dt><strong>seq_axis: int, optional</strong></dt><dd><p>Reverse along the dimension seq_axis, default: -1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reverse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reverse</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round">
<span class="sig-name descname"><span class="pre">add_round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_round"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_round" title="Permalink to this definition"></a></dt>
<dd><p>Add a round layer to the model that performs element-wise round operation
on the input tensor that rounds the value to the nearest integer.
Refer to the <code class="docutils literal notranslate"><span class="pre">RoundLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale">
<span class="sig-name descname"><span class="pre">add_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scale" title="Permalink to this definition"></a></dt>
<dd><p>Add a scale layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">ScaleLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W: int or numpy.array</strong></dt><dd><p>Scale of the input.</p>
</dd>
<dt><strong>b: int or numpy.array</strong></dt><dd><p>Bias to add to the input.</p>
</dd>
<dt><strong>has_bias: boolean</strong></dt><dd><p>Whether the bias vector of this layer is ignored in the <code class="docutils literal notranslate"><span class="pre">spec</span></code>.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>shape_scale: list of int or tuple of int</strong></dt><dd><p>List of ints that specifies the shape of the scale parameter.
Can be <code class="docutils literal notranslate"><span class="pre">[1]</span></code>, <code class="docutils literal notranslate"><span class="pre">[C]</span></code>, <code class="docutils literal notranslate"><span class="pre">[1,H,W]</span></code>, or <code class="docutils literal notranslate"><span class="pre">[C,H,W]</span></code>.</p>
</dd>
<dt><strong>shape_bias: list of int</strong></dt><dd><p>List of ints that specifies the shape of the bias parameter
(if present). Can be <code class="docutils literal notranslate"><span class="pre">[1]</span></code>, <code class="docutils literal notranslate"><span class="pre">[C]</span></code>, <code class="docutils literal notranslate"><span class="pre">[1,H,W]</span></code>, or <code class="docutils literal notranslate"><span class="pre">[C,H,W]</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bias</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter">
<span class="sig-name descname"><span class="pre">add_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="Permalink to this definition"></a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from the input.
Refer to the <code class="docutils literal notranslate"><span class="pre">ScatterLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>The axis the operation perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis">
<span class="sig-name descname"><span class="pre">add_scatter_along_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_scatter_along_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="Permalink to this definition"></a></dt>
<dd><p>Add a scatter_along_axis layer to the model that scatters data into a new
tensor according to indices from the input along the given axis into the
output tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">ScatterAlongAxisLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>The axis to perform on, default: 0.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd">
<span class="sig-name descname"><span class="pre">add_scatter_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UPDATE'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_scatter_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a scatter layer to the model that scatters data into a new tensor
according to indices from input. This is the reverse operation of the
gather operation.
Refer to the <code class="docutils literal notranslate"><span class="pre">ScatterNDLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str, optional</strong></dt><dd><p>Scatter accumulation mode in [UPDATE | ADD | SUB | MUL | DIV | MAX | MIN], default: UPDATE</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_scatter_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_scatter_along_axis</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_nd</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gather_along_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gather_along_axis</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat">
<span class="sig-name descname"><span class="pre">add_sequence_repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_sequence_repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sequence_repeat" title="Permalink to this definition"></a></dt>
<dd><p>Add a sequence repeat layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">SequenceRepeatLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>nrep: int</strong></dt><dd><p>Number of repetitions of the input blob along the sequence axis.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_upsample</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign">
<span class="sig-name descname"><span class="pre">add_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sign" title="Permalink to this definition"></a></dt>
<dd><p>Add a sign layer to the model that performs element-wise sign operation
(+1 for positive values, -1 for negative values, 0 for zeroes).
Refer to the <code class="docutils literal notranslate"><span class="pre">SignLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn">
<span class="sig-name descname"><span class="pre">add_simple_rnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_simple_rnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="Permalink to this definition"></a></dt>
<dd><p>Add a simple recurrent layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">SimpleRecurrentLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: numpy.array</strong></dt><dd><p>Weights of the recurrent layer’s hidden state.
Must be of shape <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">hidden_size)</span></code>.</p>
</dd>
<dt><strong>W_x: numpy.array</strong></dt><dd><p>Weights of the recurrent layer’s input.
Must be of shape <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">input_size)</span></code>.</p>
</dd>
<dt><strong>b: numpy.array or None</strong></dt><dd><p>Bias of the recurrent layer’s output. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, bias is ignored.
Otherwise it must be of shape <code class="docutils literal notranslate"><span class="pre">(hidden_size,</span> <span class="pre">)</span></code>.</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>activation: str</strong></dt><dd><p>Activation function name. Can be one of the following option:
[<code class="docutils literal notranslate"><span class="pre">'RELU'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SCALED_TANH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SIGMOID_HARD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'LINEAR'</span></code>].
See add_activation for more detailed description.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">h_input]</span></code>.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of <code class="docutils literal notranslate"><span class="pre">[y,</span> <span class="pre">h_output]</span></code>.</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the recurrent layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the recurrent layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_unilstm</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin">
<span class="sig-name descname"><span class="pre">add_sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="Permalink to this definition"></a></dt>
<dd><p>Add a sin layer to the model that computes element-wise sine for the
input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">SinLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sinh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh">
<span class="sig-name descname"><span class="pre">add_sinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_sinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sinh" title="Permalink to this definition"></a></dt>
<dd><p>Add a sinh layer to the model that computes element-wise hyperbolic sine for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">SinhLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_sin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asin</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_asinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_asinh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice">
<span class="sig-name descname"><span class="pre">add_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="Permalink to this definition"></a></dt>
<dd><p>Add a slice layer. Equivalent to to numpy slice [start_index:end_index:stride],
start_index is included, while end_index is exclusive.
Refer to the <code class="docutils literal notranslate"><span class="pre">SliceLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: str</strong></dt><dd><p>axis along which input is sliced.
allowed values: ‘channel’, ‘height’, ‘width’</p>
</dd>
<dt><strong>start_index: int</strong></dt><dd><p>must be non-negative.</p>
</dd>
<dt><strong>end_index: int</strong></dt><dd><p>negative indexing is supported.</p>
</dd>
<dt><strong>stride: int</strong></dt><dd><p>must be positive.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_by_size">
<span class="sig-name descname"><span class="pre">add_slice_by_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_slice_by_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_by_size" title="Permalink to this definition"></a></dt>
<dd><p>Add a slice layer. Equivalent to to numpy slice [start_index: start_index+size],
Input is list of str which is [input_tensor, begin_id].</p>
<p>Assume input_tensor has shape (2, 3, 4), and axis=1, size=2.
This would produce input_tensor[:, begin_id:begin_id+2, :]</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">SliceBySizeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>axis along which input is sliced.</p>
</dd>
<dt><strong>size: int</strong></dt><dd><p>The size of which input will be taken</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic">
<span class="sig-name descname"><span class="pre">add_slice_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_slice_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="Permalink to this definition"></a></dt>
<dd><p>Add a slice_dynamic layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">SliceDynamicLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int, optional</strong></dt><dd><p>End offsets for slice layer, default: [1].</p>
</dd>
<dt><strong>strides: list of int or tuple of int, optional</strong></dt><dd><p>Strides for slice layer, default: [1].</p>
</dd>
<dt><strong>begin_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for begin offsets, default: [false].</p>
</dd>
<dt><strong>end_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for end offsets, default: [false].</p>
</dd>
<dt><strong>squeeze_masks: list of bool, optional</strong></dt><dd><p>Boolean masks for squeezing axis, default: [false].</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static">
<span class="sig-name descname"><span class="pre">add_slice_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_slice_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="Permalink to this definition"></a></dt>
<dd><p>Add a slice_static layer to the model that extracts a slice of size
<code class="docutils literal notranslate"><span class="pre">(end</span> <span class="pre">-</span> <span class="pre">begin)</span> <span class="pre">/</span> <span class="pre">stride</span></code> from the given input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">SliceStaticLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>begin_ids: list of int or tuple of int</strong></dt><dd><p>Begin offsets for slice layer.</p>
</dd>
<dt><strong>end_ids: list of int or tuple of int</strong></dt><dd><p>End offsets for slice layer.</p>
</dd>
<dt><strong>strides: list of int or tuple of int</strong></dt><dd><p>Strides for slice layer.</p>
</dd>
<dt><strong>begin_masks: list of bool</strong></dt><dd><p>Boolean masks for begin offsets.</p>
</dd>
<dt><strong>end_masks: list of bool</strong></dt><dd><p>Boolean masks for end offsets.</p>
</dd>
<dt><strong>squeeze_masks: list of bool</strong></dt><dd><p>Boolean masks for squeezing axis.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows">
<span class="sig-name descname"><span class="pre">add_sliding_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_sliding_windows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_sliding_windows" title="Permalink to this definition"></a></dt>
<dd><p>Add a sliding_windows layer to the model that returns a tensor containing
all windows of size <code class="docutils literal notranslate"><span class="pre">window_size</span></code> * separated by <code class="docutils literal notranslate"><span class="pre">step</span></code> along the dimension <code class="docutils literal notranslate"><span class="pre">axis</span></code>.
Refer to the <code class="docutils literal notranslate"><span class="pre">SlidingWindowsLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the operation.</p>
</dd>
<dt><strong>window_size: int</strong></dt><dd><p>Number of elements in the sliding window.</p>
</dd>
<dt><strong>step: int, optional</strong></dt><dd><p>The stride of the input elements in the sliding window, default: 1.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_static</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_slice_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_slice_dynamic</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax">
<span class="sig-name descname"><span class="pre">add_softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax" title="Permalink to this definition"></a></dt>
<dd><p>Add a softmax layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">SoftmaxLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_inner_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_inner_product</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_convolution</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd">
<span class="sig-name descname"><span class="pre">add_softmax_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_softmax_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_softmax_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a softmax_nd layer to the model that performs softmax operation along
the given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">SoftmaxNDLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform the softmax operation on.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split">
<span class="sig-name descname"><span class="pre">add_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split" title="Permalink to this definition"></a></dt>
<dd><p>Add a split layer that uniformly splits the input along the channel dimension
to produce multiple outputs.
Refer to the <code class="docutils literal notranslate"><span class="pre">SplitLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>List of output blob names of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_elementwise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_elementwise</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd">
<span class="sig-name descname"><span class="pre">add_split_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_split_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_split_nd" title="Permalink to this definition"></a></dt>
<dd><p>Add a split layer to the model that splits the input tensor into multiple
output tensors. Either uniformly split the input tensor into <code class="docutils literal notranslate"><span class="pre">num_splits</span></code>
tensors, or split into given size list <code class="docutils literal notranslate"><span class="pre">split_sizes</span></code> output tensors.
Refer to the <code class="docutils literal notranslate"><span class="pre">SplitNDLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer.</p>
</dd>
<dt><strong>axis: int</strong></dt><dd><p>Axis to perform split on.</p>
</dd>
<dt><strong>num_splits: int, optional</strong></dt><dd><p>Number of splits, default: 2.</p>
</dd>
<dt><strong>split_sizes: list of int or tuple of int, optional</strong></dt><dd><p>List of size to split, default <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze">
<span class="sig-name descname"><span class="pre">add_squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_squeeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_squeeze" title="Permalink to this definition"></a></dt>
<dd><p>Add a squeeze layer to the model that decrease the rank of the input
tensor by removing unit dimensions.
Refer to the <code class="docutils literal notranslate"><span class="pre">SqueezeLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int, optional</strong></dt><dd><p>Dimensions to perform the operation, default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (squeeze_all).</p>
</dd>
<dt><strong>squeeze_all: bool, optional</strong></dt><dd><p>If true, all dimensions that are 1 are squeezed, default: false.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_expand_dims</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack">
<span class="sig-name descname"><span class="pre">add_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="Permalink to this definition"></a></dt>
<dd><p>Add a stack layer to the model that performs stack operation on a list of
tensors into one rank+1 tensor on the given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">StackLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>The axis to perform stack operation, default: 0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable">
<span class="sig-name descname"><span class="pre">add_subtract_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_subtract_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_subtract_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a subtract_broadcastable layer to the model that performs element-wise
subtraction operation with broadcast support.
Refer to the <code class="docutils literal notranslate"><span class="pre">SubtractBroadcastableLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan">
<span class="sig-name descname"><span class="pre">add_tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="Permalink to this definition"></a></dt>
<dd><p>Add a tan layer to the model that computes element-wise tangent for the
input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">TanLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tanh</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh">
<span class="sig-name descname"><span class="pre">add_tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tanh" title="Permalink to this definition"></a></dt>
<dd><p>Add a tanh layer to the model that computes element-wise hyperbolic
tangent for the input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">TanhLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atan</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_atanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atanh</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile">
<span class="sig-name descname"><span class="pre">add_tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_tile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_tile" title="Permalink to this definition"></a></dt>
<dd><p>Add a tile layer to the model that construct a tensor by repeating the
input tensor multiple number of times.
Refer to the <code class="docutils literal notranslate"><span class="pre">TileLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str or list[str]</strong></dt><dd><p>The input blob name of this layer.
If second input is provided, reps parameter is ignored.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>reps: list of int or tuple of int</strong></dt><dd><p>Number of times to replicate.
If <cite>input_name</cite> provides two inputs, second input is used as
reps and this parameter is ignored.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_stack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_stack</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_concat_nd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_concat_nd</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk">
<span class="sig-name descname"><span class="pre">add_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_topk" title="Permalink to this definition"></a></dt>
<dd><p>Add a topk layer to the model that returns top or bottom k values and
the corresponding indices of the input tensor along a given axis.
Refer to the <code class="docutils literal notranslate"><span class="pre">TopKLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer. It must be of length 1 or 2.
The optional second input corresponds to value of K.</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names of this layer. First and second correspond to
values and indices, respectively.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>number of values/indices to be computed along the axis.
Need not be given of there are two inputs, default: 0.</p>
</dd>
<dt><strong>axis: int, optional</strong></dt><dd><p>axis along which the topk values/indices are computed.
negative indexing is supported, default: 0</p>
</dd>
<dt><strong>use_bottom_k: bool, optional</strong></dt><dd><p>if true, bottom k values are computed instead, default: false.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose">
<span class="sig-name descname"><span class="pre">add_transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_transpose" title="Permalink to this definition"></a></dt>
<dd><p>Add a N-D transpose layer with axes as a parameter.
Refer to the <code class="docutils literal notranslate"><span class="pre">TransposeLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>axes: list of int or tuple of int</strong></dt><dd><p>The list containing a permutation of “[0,1,2,…,N-1]” where N is the rank of input/output tensor.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_permute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_permute</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_reshape</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary">
<span class="sig-name descname"><span class="pre">add_unary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_unary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unary" title="Permalink to this definition"></a></dt>
<dd><p>Add a Unary layer. Applies the specified function (mode) to all the elements of the input.
Prior to the application of the function the input can be scaled and shifted by using the ‘scale’,
‘shift’ parameters.
Refer to the <code class="docutils literal notranslate"><span class="pre">UnaryFunctionLayerParams</span></code> message in the specification (NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Unary function.
Allowed values: ‘sqrt’, ‘rsqrt’, ‘inverse’, ‘power’, ‘exp’, ‘log’, ‘abs’, threshold’.</p>
</dd>
<dt><strong>alpha: float</strong></dt><dd><p>constant used in with modes ‘power’ and ‘threshold’.</p>
</dd>
<dt><strong>shift, scale: float</strong></dt><dd><p>input is modified by scale and shift prior to the application of the unary function.</p>
</dd>
<dt><strong>epsilon: float</strong></dt><dd><p>small bias to prevent division by zero.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm">
<span class="sig-name descname"><span class="pre">add_unilstm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_state_update_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TANH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupled_input_forget_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_unilstm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_unilstm" title="Permalink to this definition"></a></dt>
<dd><p>Add a Uni-directional LSTM layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">UniDirectionalLSTMLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>W_h: [numpy.array]</strong></dt><dd><p>List of recursion weight matrices. The ordering is [R_i, R_f, R_o, R_z],
where R_i, R_f, R_o, R_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, hidden_size).</p>
</dd>
<dt><strong>W_x: [numpy.array]</strong></dt><dd><p>List of input weight matrices. The ordering is [W_i, W_f, W_o, W_z],
where W_i, W_f, W_o, W_z are weight matrices at input gate, forget gate, output gate and cell gate.
The shapes of these matrices are (hidden_size, input_size).</p>
</dd>
<dt><strong>b: [numpy.array] or None</strong></dt><dd><p>List of biases. The ordering is [b_i, b_f, b_o, b_z],
where b_i, b_f, b_o, b_z are biases at input gate, forget gate, output gate and cell gate.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, biases are ignored. Otherwise the shapes of the biases are (hidden_size, ).</p>
</dd>
<dt><strong>hidden_size: int</strong></dt><dd><p>Number of hidden units. This is equal to the number of channels of output shape.</p>
</dd>
<dt><strong>input_size: int</strong></dt><dd><p>Number of the number of channels of input shape.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names list of this layer, in the order of [x, h_input, c_input].</p>
</dd>
<dt><strong>output_names: list of str</strong></dt><dd><p>The output blob names list of this layer, in the order of [y, h_output, c_output].</p>
</dd>
<dt><strong>inner_activation: str</strong></dt><dd><p>Inner activation function used at input and forget gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>cell_state_update_activation: str</strong></dt><dd><p>Cell state update activation function used at the cell state update gate.
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>output_activation: str</strong></dt><dd><p>Activation function used at the output gate. Can be one of the following option:
[‘RELU’, ‘TANH’, ‘SIGMOID’, ‘SCALED_TANH’, ‘SIGMOID_HARD’, ‘LINEAR’].</p>
</dd>
<dt><strong>peep: [numpy.array] or None</strong></dt><dd><p>List of peephole vectors. The ordering is [p_i, p_f, p_o],
where p_i, p_f, and p_o are peephole vectors at input gate, forget gate, output gate.
The shapes of the peephole vectors are (hidden_size,).</p>
</dd>
<dt><strong>output_all: boolean</strong></dt><dd><p>Whether the LSTM layer should output at every time step.</p>
<ul class="simple">
<li><p>If False, the output is the result after the final state update.</p></li>
<li><p>If True, the output is a sequence, containing outputs at all time steps.</p></li>
</ul>
</dd>
<dt><strong>forget_bias: boolean</strong></dt><dd><p>If True, a vector of 1s is added to forget gate bias.</p>
</dd>
<dt><strong>coupled_input_forget_gate: boolean</strong></dt><dd><p>If True, the input gate and forget gate is coupled. i.e. forget gate is not used.</p>
</dd>
<dt><strong>cell_clip_threshold: float</strong></dt><dd><p>The limit on the maximum and minimum values on the cell state.
If not provided, it is defaulted to 50.0.</p>
</dd>
<dt><strong>reverse_input: boolean</strong></dt><dd><p>Whether the LSTM layer should process the input sequence in the reverse order.</p>
<ul class="simple">
<li><p>If False, the input sequence order is not reversed.</p></li>
<li><p>If True, the input sequence order is reversed.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_activation</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_simple_rnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_simple_rnn</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_gru"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gru</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_bidirlstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bidirlstm</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular">
<span class="sig-name descname"><span class="pre">add_upper_triangular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_upper_triangular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upper_triangular" title="Permalink to this definition"></a></dt>
<dd><p>Add a upper_triangular layer to the model that copies a tensor setting
everything outside upper triangular to zero.
Refer to the <code class="docutils literal notranslate"><span class="pre">UpperTriangularLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The of input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>k: int, optional</strong></dt><dd><p>Diagonal above which to zero elements, default: 0 (main diagonal),
k &lt; 0 is lower it and k &gt; 0 is upper.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_lower_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lower_triangular</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_matrix_band_part"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_matrix_band_part</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample">
<span class="sig-name descname"><span class="pre">add_upsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEFAULT'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_upsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_upsample" title="Permalink to this definition"></a></dt>
<dd><p>Add an upsample layer to the model.
Refer to the <code class="docutils literal notranslate"><span class="pre">UpsampleLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>scaling_factor_h: int or float</strong></dt><dd><p>Scaling factor on the vertical direction. Float values only
supported with <code class="docutils literal notranslate"><span class="pre">BILINEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">ALIGN_CORNERS_*</span></code>.</p>
</dd>
<dt><strong>scaling_factor_w: int or float</strong></dt><dd><p>Scaling factor on the horizontal direction. Float values only
supported with <code class="docutils literal notranslate"><span class="pre">BILINEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">ALIGN_CORNERS_*</span></code>.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
<dt><strong>mode: str</strong></dt><dd><p>Overall interpolation mode. The following values are supported:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'NN'</span></code>: nearest neighbour</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'BILINEAR'</span></code>: bilinear interpolation</p></li>
</ul>
</dd>
<dt><strong>linear_upsample_mode: str</strong></dt><dd><p>Specifies the behavior for linear upsampling. Only valid when
Interpolation Mode is <code class="docutils literal notranslate"><span class="pre">BILINEAR</span></code>.</p>
<p>If input grid is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">Xin-1]</span></code> (corresponding to an input size of
<code class="docutils literal notranslate"><span class="pre">Xin</span></code>), and if the output size is <code class="docutils literal notranslate"><span class="pre">Xout</span></code>,
then the grid points are sampled in the following manner:</p>
<dl class="simple">
<dt>‘DEFAULT’:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">=</span> <span class="pre">(Xin-Xin/Xout)</span> <span class="pre">/</span> <span class="pre">(Xout-1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_point[i]</span> <span class="pre">=</span> <span class="pre">min(Xin-1,</span> <span class="pre">max(0,</span> <span class="pre">i</span> <span class="pre">*</span> <span class="pre">spacing)),</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,1,2,..,Xout-1</span></code></p></li>
</ul>
</dd>
<dt>‘ALIGN_CORNERS_TRUE’:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">=</span> <span class="pre">(Xin-1)</span> <span class="pre">/</span> <span class="pre">(Xout-1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_point[i]</span> <span class="pre">=</span> <span class="pre">min(Xin-1,</span> <span class="pre">max(0,</span> <span class="pre">i</span> <span class="pre">*</span> <span class="pre">spacing)),</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,1,2,..,Xout-1</span></code></p></li>
</ul>
</dd>
<dt>‘ALIGN_CORNERS_FALSE’:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">=</span> <span class="pre">Xin</span> <span class="pre">/</span> <span class="pre">Xout</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_point[i]</span> <span class="pre">=</span> <span class="pre">min(Xin-1,</span> <span class="pre">max(0,</span> <span class="pre">i</span> <span class="pre">*</span> <span class="pre">spacing</span> <span class="pre">+</span> <span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">spacing</span> <span class="pre">-</span> <span class="pre">0.5)),</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,1,2,..,Xout-1</span></code></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_resize_bilinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_resize_bilinear</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable">
<span class="sig-name descname"><span class="pre">add_where_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_where_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="Permalink to this definition"></a></dt>
<dd><p>Add a where_broadcastable layer to the model that returns the elements
either from tensor x or tensor y, depending on the value in the
condition tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">WhereBroadcastableLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_names: list of str</strong></dt><dd><p>The input blob names of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_nonzero</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero">
<span class="sig-name descname"><span class="pre">add_where_nonzero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.add_where_nonzero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_nonzero" title="Permalink to this definition"></a></dt>
<dd><p>Add a where_nonzero layer to the model that returns a tensor containing
the indices of all non-zero elements of input tensor.
Refer to the <code class="docutils literal notranslate"><span class="pre">WhereNonZeroLayerParams</span></code> message in the specification
(NeuralNetwork.proto) for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: str</strong></dt><dd><p>The name of this layer.</p>
</dd>
<dt><strong>input_name: str</strong></dt><dd><p>The input blob name of this layer.</p>
</dd>
<dt><strong>output_name: str</strong></dt><dd><p>The output blob name of this layer.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_where_broadcastable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_where_broadcastable</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels">
<span class="sig-name descname"><span class="pre">inspect_conv_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_conv_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_conv_channels" title="Permalink to this definition"></a></dt>
<dd><p>Prints the output and kernel channels of a convolution layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels">
<span class="sig-name descname"><span class="pre">inspect_innerproduct_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_innerproduct_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_innerproduct_channels" title="Permalink to this definition"></a></dt>
<dd><p>Prints the output and kernel channels of an innerProduct layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features">
<span class="sig-name descname"><span class="pre">inspect_input_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_input_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_input_features" title="Permalink to this definition"></a></dt>
<dd><p>Prints the name and type of input features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers">
<span class="sig-name descname"><span class="pre">inspect_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_layers" title="Permalink to this definition"></a></dt>
<dd><p>Prints the summary for last “last” number of layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>last: int</strong></dt><dd><p>The numbers of layers to inspect, starting from the last one.</p>
</dd>
<dt><strong>verbose: bool</strong></dt><dd><p>Whether to display layer-specific parameters or not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers">
<span class="sig-name descname"><span class="pre">inspect_loss_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_loss_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_loss_layers" title="Permalink to this definition"></a></dt>
<dd><p>Prints the summary for the loss layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer">
<span class="sig-name descname"><span class="pre">inspect_optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_optimizer" title="Permalink to this definition"></a></dt>
<dd><p>Prints the summary for the optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features">
<span class="sig-name descname"><span class="pre">inspect_output_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_output_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_output_features" title="Permalink to this definition"></a></dt>
<dd><p>Prints the name and type of output features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers">
<span class="sig-name descname"><span class="pre">inspect_updatable_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.inspect_updatable_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.inspect_updatable_layers" title="Permalink to this definition"></a></dt>
<dd><p>Prints all updatable layers with their inputs and outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable">
<span class="sig-name descname"><span class="pre">make_updatable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.make_updatable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.make_updatable" title="Permalink to this definition"></a></dt>
<dd><p>Make the builder’s NeuralNetwork spec updatable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trainables: list of str</strong></dt><dd><p>List of layer names to be set trainable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss">
<span class="sig-name descname"><span class="pre">set_categorical_cross_entropy_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_categorical_cross_entropy_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_categorical_cross_entropy_loss" title="Permalink to this definition"></a></dt>
<dd><p>Categorical Cross Entropy is used for single label categorization
(only one category is applicable for each data point).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name: The name of the loss layer</strong></dt><dd></dd>
<dt><strong>input: The name of the input</strong></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">input</span></code> should be a vector of length N representing the
distribution over N categories. This must be the output of a softmax.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="math notranslate nohighlight">
\[Loss_ {CCE}(input, target) = -\sum_{i = 1} ^ {N}(target == i) log(input[i]) = - log(input[target])\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels">
<span class="sig-name descname"><span class="pre">set_class_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classLabel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_blob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_class_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="Permalink to this definition"></a></dt>
<dd><p>Set class labels to the model spec to make it a neural network classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>class_labels: list of int or list of str</strong></dt><dd><p>A list of integers or strings that map the index of the output of a
neural network to labels in a classifier.</p>
</dd>
<dt><strong>predicted_feature_name: str</strong></dt><dd><p>Name of the output feature for the class labels exposed in the
Core ML neural network classifier, defaults: <code class="docutils literal notranslate"><span class="pre">'classLabel'</span></code>.</p>
</dd>
<dt><strong>prediction_blob: str</strong></dt><dd><p>If provided, then this is the name of the neural network blob which
generates the probabilities for each class label (typically the output
of a softmax layer). If not provided, then the last output layer is
assumed.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pre_processing_parameters</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input">
<span class="sig-name descname"><span class="pre">set_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="Permalink to this definition"></a></dt>
<dd><p>Set the inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_names: list of str</strong></dt><dd><p>The input names of the network.</p>
</dd>
<dt><strong>input_dims: [tuple]</strong></dt><dd><p>The input dimensions of the network. The ordering of <code class="docutils literal notranslate"><span class="pre">input_dims</span></code>
is the same as <code class="docutils literal notranslate"><span class="pre">input_names</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec inputs to be 3 dimensional vector data1 and</span>
<span class="c1"># 4 dimensional vector data2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">],</span> <span class="n">input_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss">
<span class="sig-name descname"><span class="pre">set_mean_squared_error_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_mean_squared_error_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_mean_squared_error_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>input_feature: [(str, datatypes.Array)] or None</dt><dd><p>The input feature of the loss layer. Each feature is a
<code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">array)</span></code> tuple, where <code class="docutils literal notranslate"><span class="pre">name</span></code> is the name of the model’s
tensor our loss will be attached to, and <code class="docutils literal notranslate"><span class="pre">array</span></code> is a
<code class="docutils literal notranslate"><span class="pre">datatypes.Array</span></code> object describing the shape of that tensor.
Both the name and the array’s shape must be provided in the tuple.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">feature</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;output_tensor&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">((</span><span class="mi">299</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_optional_input">
<span class="sig-name descname"><span class="pre">set_optional_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_optional_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_optional_input" title="Permalink to this definition"></a></dt>
<dd><p>Marks given input as optional input.
Optionally, sets default value for optional input if value is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_idx: int</strong></dt><dd><p>Index of input to be marked and fill with default value.</p>
</dd>
<dt><strong>value: int/double/float/None</strong></dt><dd><p>Value to be fill as default value.</p>
</dd>
<dt><strong>format: str</strong></dt><dd><p>Format of default value.
Must be one of <code class="docutils literal notranslate"><span class="pre">'float'</span></code>, <code class="docutils literal notranslate"><span class="pre">'double'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'int'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output">
<span class="sig-name descname"><span class="pre">set_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="Permalink to this definition"></a></dt>
<dd><p>Set the outputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output_names: list of str</strong></dt><dd><p>The output names of the network.</p>
</dd>
<dt><strong>output_dims: [tuple]</strong></dt><dd><p>The output dimensions of the network. The ordering of <code class="docutils literal notranslate"><span class="pre">output_dims</span></code> is the same
as <code class="docutils literal notranslate"><span class="pre">output_names</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec outputs to be 3 dimensional vector feature1 and</span>
<span class="c1"># 4 dimensional vector feature2.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span> <span class="s1">&#39;feature2&#39;</span><span class="p">],</span> <span class="n">output_dims</span><span class="o">=</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters">
<span class="sig-name descname"><span class="pre">set_pre_processing_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_bgr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">green_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NCHW'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_pre_processing_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_pre_processing_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Add a pre-processing parameters layer to the neural network object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image_input_names: list of str</strong></dt><dd><p>Name of input blobs that are images</p>
</dd>
<dt><strong>is_bgr: boolean or dict()</strong></dt><dd><p>Channel order for input blobs that are images. BGR if True else RGB.
To specify a different value for each image input,
provide a dictionary with input names as keys.</p>
</dd>
<dt><strong>red_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (red channel)</p>
</dd>
<dt><strong>blue_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (blue channel)</p>
</dd>
<dt><strong>green_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (green channel)</p>
</dd>
<dt><strong>gray_bias: float or dict()</strong></dt><dd><p>Image re-centering parameter (for grayscale images)</p>
</dd>
<dt><strong>image_scale: float or dict()</strong></dt><dd><p>Value by which to scale the images.</p>
</dd>
<dt><strong>image_format: str</strong></dt><dd><p>Image format, either ‘NCHW’ / ‘NHWC’</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_input</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>, <a class="reference internal" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels" title="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_class_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_class_labels</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input">
<span class="sig-name descname"><span class="pre">set_training_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/builder.html#NeuralNetworkBuilder.set_training_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.builder.NeuralNetworkBuilder.set_training_input" title="Permalink to this definition"></a></dt>
<dd><p>Set the training inputs of the network spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>training_input: [tuple]</strong></dt><dd><p>The training input names and type of the network.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the neural network spec training inputs to be 3 dimensional vector for &#39;input&#39; and</span>
<span class="c1"># Double for &#39;target&#39;.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">builder</span><span class="o">.</span><span class="n">set_training_input</span><span class="p">([(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">datatypes</span><span class="o">.</span><span class="n">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coremltools.models.neural_network.flexible_shape_utils">
<span id="neural-network-flexible-shape-utils"></span><h1>neural_network.flexible_shape_utils<a class="headerlink" href="#module-coremltools.models.neural_network.flexible_shape_utils" title="Permalink to this heading"></a></h1>
<p>Utilities to annotate Neural Network Features with flexible shape information.
Only available in coremltools 2.0b1 and onwards</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkImageSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#NeuralNetworkImageSize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSize" title="Permalink to this definition"></a></dt>
<dd><p>An object representing a size for an image feature inside a
neural network. Valid sizess for height and width are &gt; 0.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSizeRange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkImageSizeRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#NeuralNetworkImageSizeRange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkImageSizeRange" title="Permalink to this definition"></a></dt>
<dd><p>An object representing a range of sizes for an image feature inside a
neural network. Valid ranges for height and width are &gt; 0. A “-1”
upper bound value for either width or height represents an unbounded size
for that dimension.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShape">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkMultiArrayShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#NeuralNetworkMultiArrayShape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShape" title="Permalink to this definition"></a></dt>
<dd><p>An object representing a shape for a multiArray feature in a
neural network. Valid shapes must have have only the Channel [C]
shape or the Channel, Height and Width [C, H, W] shapes populated</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkMultiArrayShapeRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#NeuralNetworkMultiArrayShapeRange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange" title="Permalink to this definition"></a></dt>
<dd><p>An object representing a range of shapes for a multiArray feature in a
neural network. Valid shape ranges must have have only the Channel [C]
range or the Channel, Height and Width [C, H, W] ranges populated. A “-1”
value in an upper bound represents an unbounded range.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange.isFlexible">
<span class="sig-name descname"><span class="pre">isFlexible</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#NeuralNetworkMultiArrayShapeRange.isFlexible"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.NeuralNetworkMultiArrayShapeRange.isFlexible" title="Permalink to this definition"></a></dt>
<dd><p>Returns true if any one of the channel, height, or width ranges of this shape allow more than one input value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.add_enumerated_image_sizes">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">add_enumerated_image_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#add_enumerated_image_sizes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_image_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output image feature in a Neural Network spec to
to accommodate a list of enumerated image sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the image feature for which to add size information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>sizes</strong> – [] | NeuralNetworkImageSize
A single or a list of NeuralNetworkImageSize objects which encode valid
size information for a image feature</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSize</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSize</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_enumerated_image_sizes</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">image_sizes</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.add_enumerated_multiarray_shapes">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">add_enumerated_multiarray_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#add_enumerated_multiarray_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_enumerated_multiarray_shapes" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output multiArray feature in a Neural Network spec to
to accommodate a list of enumerated array shapes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the image feature for which to add shape information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>shapes</strong> – [] | NeuralNetworkMultiArrayShape
A single or a list of NeuralNetworkImageSize objects which encode valid
size information for a image feature</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShape</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShape</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_channel_shape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_height_shape</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">second_shape</span><span class="o">.</span><span class="n">set_width_shape</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_enumerated_multiarray_shapes</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">shapes</span><span class="o">=</span><span class="n">array_shapes</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.add_multiarray_ndshape_enumeration">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">add_multiarray_ndshape_enumeration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enumerated_shapes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#add_multiarray_ndshape_enumeration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.add_multiarray_ndshape_enumeration" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes.
Add provided enumerated shapes to the list of shapes already present.
This method is different from “add_enumerated_multiarray_shapes”, which is applicable
for rank 5 mapping, SBCHW, arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>enumerated_shapes</strong> – List[Tuple(int)]
list of shapes, where each shape is specified as a tuple of integers.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># say, the default shape of &quot;my_multiarray_featurename&quot; is (2,3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">add_multiarray_ndshape_enumeration</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">enumerated_shapes</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.set_multiarray_ndshape_range">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">set_multiarray_ndshape_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#set_multiarray_ndshape_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.set_multiarray_ndshape_range" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes.
This is different from “update_multiarray_shape_range”, which works with rank 5
SBCHW mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>lower_bounds</strong> – List[int]
list of integers specifying the lower bounds of each dimension.
Length must be same as the rank (length of shape) of the feature_name.</p></li>
<li><p><strong>upper_bounds</strong> – List[int]
list of integers specifying the upper bounds of each dimension.
-1 corresponds to unbounded range.
Length must be same as the rank (length of shape) of the feature_name.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># say, the default shape of &quot;my_multiarray_featurename&quot; is (2,3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">set_multiarray_ndshape_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">lower_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.update_image_size_range">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">update_image_size_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_range</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#update_image_size_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.update_image_size_range" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output Image feature in a Neural Network spec to
to accommodate a range of image sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the Image feature for which to add shape information.
If the feature is not found in the input or output descriptions then
an exception is thrown</p></li>
<li><p><strong>size_range</strong> – NeuralNetworkImageSizeRange
A NeuralNetworkImageSizeRange object with the populated image size
range information.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkImageSizeRange</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span><span class="o">.</span><span class="n">add_height_range</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size_ranges</span><span class="o">.</span><span class="n">add_width_range</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">update_image_size_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">size_range</span><span class="o">=</span><span class="n">img_size_ranges</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec object is updated</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.flexible_shape_utils.update_multiarray_shape_range">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.flexible_shape_utils.</span></span><span class="sig-name descname"><span class="pre">update_multiarray_shape_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_range</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/flexible_shape_utils.html#update_multiarray_shape_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.flexible_shape_utils.update_multiarray_shape_range" title="Permalink to this definition"></a></dt>
<dd><p>Annotate an input or output MLMultiArray feature in a Neural Network spec
to accommodate a range of shapes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – MLModel
The MLModel spec containing the feature</p></li>
<li><p><strong>feature_name</strong> – str
The name of the feature for which to add shape range
information. If the feature is not found in the input or output
descriptions then an exception is thrown</p></li>
<li><p><strong>shape_range</strong> – NeuralNetworkMultiArrayShapeRange
A NeuralNetworkMultiArrayShapeRange object with the populated shape
range information. The shape_range object must either contain only
shape information for channel or channel, height and width. If
the object is invalid then an exception is thrown</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">flexible_shape_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">load_spec</span><span class="p">(</span><span class="s1">&#39;mymodel.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span> <span class="o">=</span> <span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">NeuralNetworkMultiArrayShapeRange</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_channel_range</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_width_range</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_range</span><span class="o">.</span><span class="n">add_height_range</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flexible_shape_utils</span><span class="o">.</span><span class="n">update_multiarray_shape_range</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s1">&#39;my_multiarray_featurename&#39;</span><span class="p">,</span> <span class="n">shape_range</span><span class="o">=</span><span class="n">shape_range</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. The spec is updated</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coremltools.models.neural_network.quantization_utils">
<span id="neural-network-quantization-utils"></span><h1>neural_network.quantization_utils<a class="headerlink" href="#module-coremltools.models.neural_network.quantization_utils" title="Permalink to this heading"></a></h1>
<p>Utilities to compress Neural Network Models.
Only available in coremltools 2.0b1 and onwards</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">AdvancedQuantizedLayerSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_layer_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_conv_kernel_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_conv_weight_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#AdvancedQuantizedLayerSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector" title="Permalink to this definition"></a></dt>
<dd><p>Quantized layer selector allowing the user to specify some types of
layers to skip during quantization process and the minimum size parameters
in quantized convolution layers.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network.quantization_utils</span> <span class="kn">import</span> <span class="n">AdvancedQuantizedLayerSelector</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">AdvancedQuantizedLayerSelector</span><span class="p">(</span>
        <span class="n">skip_layer_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;batchnorm&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;depthwiseConv&#39;</span><span class="p">],</span>
        <span class="n">minimum_conv_kernel_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">minimum_conv_weight_count</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
<span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantize_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector.do_quantize">
<span class="sig-name descname"><span class="pre">do_quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#AdvancedQuantizedLayerSelector.do_quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.AdvancedQuantizedLayerSelector.do_quantize" title="Permalink to this definition"></a></dt>
<dd><p>weight_param - should be name of the WeightParam field</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">MatrixMultiplyLayerSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimum_weight_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_output_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_output_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_layers_with_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#MatrixMultiplyLayerSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector" title="Permalink to this definition"></a></dt>
<dd><p>Layer selector object that allows users to select matrix multiplication layers
with one of the matrices being constant, based on some criterions like total
numbers of parameters/weights, number of input or output channels and/or layer
names. If any of the criterion is not valid, the corresponding layer is not
selected.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector.do_quantize">
<span class="sig-name descname"><span class="pre">do_quantize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#MatrixMultiplyLayerSelector.do_quantize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.MatrixMultiplyLayerSelector.do_quantize" title="Permalink to this definition"></a></dt>
<dd><p>weight_param - should be name of the WeightParam field</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.ModelMetrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">ModelMetrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#ModelMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.ModelMetrics" title="Permalink to this definition"></a></dt>
<dd><p>A utility class to hold evaluation metrics</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.OutputMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">OutputMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#OutputMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.OutputMetric" title="Permalink to this definition"></a></dt>
<dd><p>Utility class to calculate and hold metrics between
two model outputs</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.QuantizedLayerSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">QuantizedLayerSelector</span></span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#QuantizedLayerSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.QuantizedLayerSelector" title="Permalink to this definition"></a></dt>
<dd><p>This is the base class to implement custom selectors to skip certain
layers during quantization. To implement a custom selector, create a class
that inherits this class and override <cite>do_quantize()</cite> method.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLayerSelector</span><span class="p">(</span><span class="n">QuantizedLayerSelector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">do_quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">do_quantize</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span> <span class="ow">or</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dense_2&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">MyLayerSelector</span><span class="p">()</span>
<span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantize_weights</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">quantization_mode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.activate_int8_int8_matrix_multiplications">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">activate_int8_int8_matrix_multiplications</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#activate_int8_int8_matrix_multiplications"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.activate_int8_int8_matrix_multiplications" title="Permalink to this definition"></a></dt>
<dd><p>Utility function that takes in either a full precision (float) spec or
an nbit quantized spec to selectively enable int8 activation + weight quantization
of matrix multiplication operations where the second matrix represents a constant weight.</p>
<dl class="simple">
<dt>spec: MLModel.get_spec()</dt><dd><p>Currently conversion for only neural network models is supported.
If a pipeline model is passed in then all embedded neural network models embedded within
will be modified.</p>
</dd>
<dt>selector: (optional) MatrixMultiplyLayerSelector</dt><dd><p>A MatrixMultiplyLayerSelector object that enables int8 activation + weight quantization
only on those layers for which the user-specified criterion on the minimum/maximum number
of size/channels in constant weight parameters is met.
It can also be derived to provide custom selection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.compare_models">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">compare_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_precision_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantized_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#compare_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.compare_models" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to compare the performance of a full precision vs quantized model</p>
<dl class="simple">
<dt>full_precision_model: MLModel</dt><dd><p>The full precision model with float32 weights</p>
</dd>
<dt>quantized_model: MLModel</dt><dd><p>Quantized version of the model with quantized weights</p>
</dd>
<dt>sample_data: str | [dict]</dt><dd><p>Data used to characterize performance of the quantized model in
comparison to the full precision model. Either a list of sample input
dictionaries or an absolute path to a directory containing images.
Path to a directory containing images is only valid for models with
one image input. For all other models a list of sample inputs must be
provided.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None. Performance metrics are printed out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coremltools.models.neural_network.quantization_utils.quantize_weights">
<span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.quantization_utils.</span></span><span class="sig-name descname"><span class="pre">quantize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_precision_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantization_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/quantization_utils.html#quantize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.quantization_utils.quantize_weights" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to convert a full precision (float) MLModel to a
nbit quantized MLModel (float16).</p>
<dl>
<dt>full_precision_model: MLModel</dt><dd><p>Model which will be converted to half precision. Currently conversion
for only neural network models is supported. If a pipeline model is
passed in then all embedded neural network models embedded within
will be converted.</p>
</dd>
<dt>nbits: int</dt><dd><dl class="simple">
<dt>Number of bits per quantized weight. Only 16-bit float point and</dt><dd><p>1-8 bit is supported</p>
</dd>
</dl>
</dd>
<dt>quantization_mode: str</dt><dd><p>One of the following:</p>
<dl class="simple">
<dt>“linear”:</dt><dd><p>Linear quantization with scale and bias assuming the range of weight
values is [A, B], where A = min(weight), B = max(weight)</p>
</dd>
<dt>“linear_lut”:</dt><dd><p>Simple linear quantization represented as a lookup table</p>
</dd>
<dt>“kmeans_lut”:</dt><dd><p>LUT based quantization, where LUT is generated by K-Means clustering</p>
</dd>
<dt>“custom_lut”:</dt><dd><p>LUT quantization where LUT and quantized weight params are
calculated using a custom function. If this mode is selected then
a custom function must be passed in kwargs with key lut_function.
The function must have input params (nbits, wp) where nbits is the
number of quantization bits and wp is the list of weights for a
given layer. The function should return two parameters (lut, qw)
where lut is an array of length (2^n bits)containing LUT values and
qw is the list of quantized weight parameters. See
<code class="docutils literal notranslate"><span class="pre">_get_linear_lookup_table_and_weight</span></code> for a sample implementation.</p>
</dd>
<dt>“linear_symmetric”:</dt><dd><p>Linear quantization with scale and bias assuming the range of weight
values is [-A, A], where A = max(abs(weight)).</p>
</dd>
</dl>
</dd>
<dt>sample_data: str | [dict]</dt><dd><p>Data used to characterize performance of the quantized model in
comparison to the full precision model. Either a list of sample input
dictionaries or an absolute path to a directory containing images.
Path to a directory containing images is only valid for models with
one image input. For all other models a list of sample inputs must be
provided.</p>
</dd>
<dt>kwargs: keyword arguments</dt><dd><dl>
<dt><em>lut_function</em><span class="classifier">(<code class="docutils literal notranslate"><span class="pre">callable</span> <span class="pre">function</span></code>)</span></dt><dd><p>A callable function provided when quantization mode is set to
<code class="docutils literal notranslate"><span class="pre">_QUANTIZATION_MODE_CUSTOM_LOOKUP_TABLE</span></code>. See <code class="docutils literal notranslate"><span class="pre">quantization_mode</span></code>
for more details.</p>
</dd>
<dt><em>selector</em>: QuantizedLayerSelector</dt><dd><p>A QuanatizedLayerSelector object that can be derived to provide
custom quantization selection.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>model: MLModel</dt><dd><p>The quantized MLModel instance if running on macOS 10.14 or later,
otherwise the quantized model specification is returned</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">coremltools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coremltools.models.neural_network</span> <span class="kn">import</span> <span class="n">quantization_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MLModel</span><span class="p">(</span><span class="s1">&#39;my_model.mlmodel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantized_model</span> <span class="o">=</span> <span class="n">quantization_utils</span><span class="o">.</span><span class="n">quantize_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;linear&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coremltools.models.neural_network.update_optimizer_utils">
<span id="neural-network-update-optimizer-utils"></span><h1>neural_network.update_optimizer_utils<a class="headerlink" href="#module-coremltools.models.neural_network.update_optimizer_utils" title="Permalink to this heading"></a></h1>
<p>Neural Network optimizer utilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.update_optimizer_utils.AdamParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></span><span class="sig-name descname"><span class="pre">AdamParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/update_optimizer_utils.html#AdamParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.AdamParams" title="Permalink to this definition"></a></dt>
<dd><p>Adam - A Method for Stochastic Optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lr: float</strong></dt><dd><p>The learning rate that controls learning step size. Adjustable in progress, default: 0.01.</p>
</dd>
<dt><strong>batch: int</strong></dt><dd><p>The mini-batch size, number of examples used to compute single gradient step, default: 10.</p>
</dd>
<dt><strong>beta1: float</strong></dt><dd><p>Controls the exponential decay rate for the first moment estimates, default: 0.9.</p>
</dd>
<dt><strong>beta2: float</strong></dt><dd><p>Controls the exponential decay rate for the second moment estimates, default: 0.999.</p>
</dd>
<dt><strong>eps: float</strong></dt><dd><p>The epsilon, a very small number to prevent any division by zero in the implementation, default: 1e-8.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>set_lr(value, min, max)</strong></p></td>
<td><p>Set value for learning rate.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_batch(value, allow_set)</strong></p></td>
<td><p>Set value for batch size.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_beta1(value, min, max)</strong></p></td>
<td><p>Set value for beta1.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_beta2(value, min, max)</strong></p></td>
<td><p>Set value for beta2.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_eps(value, min, max)</strong></p></td>
<td><p>Set value for epsilon.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.update_optimizer_utils.Batch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></span><span class="sig-name descname"><span class="pre">Batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/update_optimizer_utils.html#Batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.Batch" title="Permalink to this definition"></a></dt>
<dd><p>Batch optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value: float</strong></dt><dd></dd>
<dt><strong>allowed_set: float</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.update_optimizer_utils.RangeParam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></span><span class="sig-name descname"><span class="pre">RangeParam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/update_optimizer_utils.html#RangeParam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.RangeParam" title="Permalink to this definition"></a></dt>
<dd><p>Range Parameter optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value: float</strong></dt><dd></dd>
<dt><strong>min: float</strong></dt><dd></dd>
<dt><strong>max: float</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coremltools.models.neural_network.update_optimizer_utils.SgdParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coremltools.models.neural_network.update_optimizer_utils.</span></span><span class="sig-name descname"><span class="pre">SgdParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/coremltools/models/neural_network/update_optimizer_utils.html#SgdParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coremltools.models.neural_network.update_optimizer_utils.SgdParams" title="Permalink to this definition"></a></dt>
<dd><p>SGD - Stochastic Gradient Descent optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lr: float</strong></dt><dd><p>The learning rate that controls learning step size. Adjustable in progress, default: 0.01.</p>
</dd>
<dt><strong>batch: int</strong></dt><dd><p>The mini-batch size, number of examples used to compute single gradient step, default: 10.</p>
</dd>
<dt><strong>momentum: float</strong></dt><dd><p>The momentum factor that helps accelerate gradients vectors in the right direction, default 0.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 46%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>set_lr(value, min, max)</strong></p></td>
<td><p>Set value for learning rate.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_batch(value, allow_set)</strong></p></td>
<td><p>Set value for batch size.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_momentum(value, min, max)</strong></p></td>
<td><p>Set value for momentum.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coremltools.models.ml_program.html" class="btn btn-neutral float-left" title="affine_quantize_weights" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coremltools.converters.mil.html" class="btn btn-neutral float-right" title="MIL Builder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Apple Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>